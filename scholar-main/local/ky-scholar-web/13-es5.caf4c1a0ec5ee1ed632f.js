function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"YDg+":function(e,t,n){"use strict";n.r(t),n.d(t,"ResourceManageModule",(function(){return _n}));var i=n("PCNd"),o=n("tyNb"),a=n("mrSG"),r=n("fXoL"),c=n("+O+V"),s=n("Vhue"),l=n("cp0P"),d=n("PqYM"),u=n("qjn6"),h=n("WTGI"),g=n("wsOq"),f=n("AytR"),p=n("Fmhi"),b=n("pz6Z"),m=n("dEAy"),v=n("PScX"),y=n("uMH2"),C=n("19W7"),z=n("ofXK"),P=n("Nqz0"),k=n("Q8cG"),w=n("B+r4"),O=n("1zMu"),_=n("C2AL"),M=n("FwiY"),x=n("PTRe"),S=n("3Pt+"),E=n("zAKX"),T=n("OzZK"),I=n("RwU8"),Z=n("rMZv"),L=n("wyWf"),R=n("aeXB"),D=n("nJia"),N=n("xKc1"),j=n.n(N),A=function(){function e(e){this.elementRef=e,this.background="white",this.backgroundAlpha=1,this.foreground="black",this.foregroundAlpha=1,this.level="L",this.mime="image/png",this.padding=null,this.size=100,this.value="",this.canvas=!1}return e.prototype.ngOnChanges=function(e){("background"in e||"backgroundAlpha"in e||"foreground"in e||"foregroundAlpha"in e||"level"in e||"mime"in e||"padding"in e||"size"in e||"value"in e||"canvas"in e)&&this.generate()},e.prototype.generate=function(){try{var e=this.elementRef.nativeElement;e.innerHTML="";var t=new j.a({background:this.background,backgroundAlpha:this.backgroundAlpha,foreground:this.foreground,foregroundAlpha:this.foregroundAlpha,level:this.level,mime:this.mime,padding:this.padding,size:this.size,value:this.value});e.appendChild(this.canvas?t.canvas:t.image)}catch(n){console.error("Could not generate QR Code: "+n.message)}},e.\u0275fac=function(t){return new(t||e)(r.Ub(r.l))},e.\u0275cmp=r.Ob({type:e,selectors:[["qr-code"]],inputs:{background:"background",backgroundAlpha:"backgroundAlpha",foreground:"foreground",foregroundAlpha:"foregroundAlpha",level:"level",mime:"mime",padding:"padding",size:"size",value:"value",canvas:"canvas"},features:[r.Cb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),F=function(){function e(){}return e.\u0275mod=r.Sb({type:e}),e.\u0275inj=r.Rb({factory:function(t){return new(t||e)}}),e}(),U=n("u2sS"),V=["treeContainer"];function q(e,t){if(1&e){var n=r.bc();r.ac(0,"qkc-change-profession",51),r.ic("professionChange",(function(e){return r.Ec(n),r.lc().professionChange(e)})),r.Zb()}if(2&e){var i=r.lc();r.tc("select",i.selected)("hidden","scp"===i.from)}}function B(e,t){if(1&e){var n=r.bc();r.ac(0,"button",52),r.ic("click",(function(){return r.Ec(n),r.lc().goback()})),r.Pc(1,"\u5b8c\u6210\u8c03\u7528"),r.Zb()}}function G(e,t){if(1&e&&(r.ac(0,"button",53),r.Pc(1,"\u65b0\u589e\u9605\u8bfb "),r.Zb()),2&e){r.lc();var n=r.Cc(9);r.tc("nzDropdownMenu",n)}}function X(e,t){if(1&e){var n=r.bc();r.Yb(0),r.ac(1,"li",54),r.ic("click",(function(){r.Ec(n);var e=t.$implicit;return r.lc().selectMenu(e)})),r.Pc(2),r.Zb(),r.Xb()}if(2&e){var i=t.$implicit;r.Eb(2),r.Qc(null==i?null:i.name)}}function W(e,t){if(1&e){var n=r.bc();r.ac(0,"qkc-tree-knowledgegraph",55),r.ic("nodeChange",(function(e){return r.Ec(n),r.lc().nodeChange(e)})),r.Zb()}if(2&e){var i=r.lc();r.tc("professionId",null==i.selectedProfesson?null:i.selectedProfesson.id)("allNodes",!0)}}function $(e,t){if(1&e){var n=r.bc();r.ac(0,"button",56),r.ic("click",(function(){return r.Ec(n),r.lc().resetData()})),r.Pc(1," \u91cd\u7f6e "),r.Zb()}}function H(e,t){if(1&e){var n=r.bc();r.ac(0,"a",64),r.ic("click",(function(){r.Ec(n);var e=r.lc(2).$implicit;return r.lc().del(e)})),r.Pc(1,"\u5220\u9664"),r.Zb()}}function K(e,t){if(1&e){var n=r.bc();r.ac(0,"td",61),r.ac(1,"a",62),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().preview(e)})),r.Pc(2,"\u9884\u89c8 "),r.Zb(),r.ac(3,"a",62),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().edit(e)})),r.Pc(4,"\u7f16\u8f91 "),r.Zb(),r.ac(5,"a",62),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().qcode(e)})),r.Pc(6,"\u4e8c\u7ef4\u7801 "),r.Zb(),r.Nc(7,H,2,0,"a",63),r.Zb()}if(2&e){var i=r.lc().$implicit,o=r.lc();r.Eb(7),r.tc("ngIf",o.delIF(i))}}function Q(e,t){if(1&e){var n=r.bc();r.ac(0,"a",62),r.ic("click",(function(){r.Ec(n);var e=r.lc(2),t=e.$implicit,i=e.index;return r.lc().callResource(t,i)})),r.Pc(1,"\u8c03\u7528"),r.Zb()}}function J(e,t){if(1&e){var n=r.bc();r.ac(0,"a",64),r.ic("click",(function(){r.Ec(n);var e=r.lc(2),t=e.$implicit,i=e.index;return r.lc().cancelCallResource(t,i)})),r.Pc(1," \u53d6\u6d88\u8c03\u7528 "),r.Zb()}}function Y(e,t){if(1&e){var n=r.bc();r.ac(0,"a",64),r.ic("click",(function(){r.Ec(n);var e=r.lc(2),t=e.$implicit,i=e.index;return r.lc().cancelCallResource(t,i)})),r.Pc(1," \u53d6\u6d88\u8c03\u7528 "),r.Zb()}}function ee(e,t){1&e&&(r.ac(0,"a",67),r.Pc(1," \u5df2\u8c03\u7528 "),r.Zb())}function te(e,t){if(1&e){var n=r.bc();r.ac(0,"td",61),r.ac(1,"a",62),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().preview(e)})),r.Pc(2,"\u9884\u89c8 "),r.Zb(),r.Nc(3,Q,2,0,"a",65),r.Nc(4,J,2,0,"a",63),r.Nc(5,Y,2,0,"a",63),r.Nc(6,ee,2,0,"a",66),r.Zb()}if(2&e){var i=r.lc().$implicit,o=r.lc();r.Eb(3),r.tc("ngIf",!i.isCall&&i.supportType&&o.permitedCall),r.Eb(1),r.tc("ngIf",i.isCall&&!o.callResourceData.isStandard),r.Eb(1),r.tc("ngIf",i.isCall&&o.callResourceData.isStandard&&"4"===i.taskType),r.Eb(1),r.tc("ngIf",i.isCall&&o.callResourceData.isStandard&&"4"!==i.taskType)}}function ne(e,t){if(1&e&&(r.ac(0,"tr"),r.ac(1,"td"),r.ac(2,"span",57),r.Pc(3),r.Zb(),r.Zb(),r.ac(4,"td"),r.Pc(5),r.Zb(),r.ac(6,"td",58),r.ac(7,"span",59),r.Pc(8),r.Zb(),r.Zb(),r.ac(9,"td"),r.Pc(10),r.Zb(),r.ac(11,"td"),r.Pc(12),r.Zb(),r.ac(13,"td"),r.Pc(14),r.Zb(),r.ac(15,"td"),r.Pc(16),r.Zb(),r.ac(17,"td"),r.Pc(18),r.Zb(),r.Nc(19,K,8,1,"td",60),r.Nc(20,te,7,4,"td",60),r.Zb()),2&e){var n=t.$implicit,i=r.lc();r.Eb(3),r.Qc(null==n?null:n.title),r.Eb(2),r.Qc(i.getName(null==n?null:n.type,"MATERIAL_TYPE")),r.Eb(2),r.tc("nzTooltipTitle",null==n?null:n.pointName),r.Eb(1),r.Qc(null==n?null:n.pointName),r.Eb(2),r.Qc(i.getName(null==n?null:n.learningGoalCode,"LEARNING_TARGET")),r.Eb(2),r.Qc(null==n?null:n.createrName),r.Eb(2),r.Qc(null==n?null:n.authorName),r.Eb(2),r.Qc(i.getDate(null==n?null:n.lastModifiedTime)),r.Eb(2),r.Qc(null==n?null:n.useTime),r.Eb(1),r.tc("ngIf",""==i.from),r.Eb(1),r.tc("ngIf","scp"==i.from)}}function ie(e,t){1&e&&r.Pc(0),2&e&&r.Rc("\u5171 ",t.$implicit," \u6761\u8bb0\u5f55")}function oe(e,t){if(1&e&&r.Vb(0,"qr-code",68),2&e){var n=r.lc();r.tc("value",n.qrcode)("size",n.size)}}function ae(e,t){if(1&e){var n=r.bc();r.ac(0,"app-resource-preview-modal",69),r.ic("closePreview",(function(){return r.Ec(n),r.lc().closePreview()})),r.Zb()}if(2&e){var i=r.lc();r.tc("isPreviewpolyway",i.isPreviewpolyway)("previewTitle",i.previewTitle)("resourceUrl",i.resourceUrl)}}var re,ce=function(e){return{x:"1300px",y:e}},se=function(){return[15,20,30,40,50]},le=((re=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,a,r,s,l,d){var u;return _classCallCheck(this,n),(u=t.call(this)).materialLibService=e,u.menuService=i,u.modalService=o,u.message=a,u.courseMgService=r,u.route=s,u.statisticsLogService=l,u.locale=d,u._PAGE_ID_="MaterialReadLibraryComponent",u.id=-1,u.materialMenus=c.g.filter((function(e){return"104"!==e.id})),u.knowledgePointId="",u.from="",u.callResourceData={},u.callResourceId="MaterialCallResource",u.permitedCall=!0,u.type="0",u.fileType="0",u.selected="",u.getTwoWords=h.a.getTwoWords,u.getName=c.k,u.conditionObj={category:100,knowledgeSubjectId:"",knowledgeModuleId:"",knowledgeUnitId:"",knowledgePointId:"",condition:"",coursewareType:[],learningGoalCode:[]},u.condition="",u.coursewareType=[],u.learningGoalCode=[],u.init=!1,u.knowledgegraphTree=!0,u.changeProfession=!0,u.previewTitle="",u.isPreviewpolyway=!1,u.previewStart=!1,u.order=null,u.qrcode="",u.qrName="",u.size=200,u}return _createClass(n,[{key:"initData",value:function(){this.selected=s.a.getReadtree()||s.a.getPacketInfoItem("code");var e=this.route.snapshot.queryParams,t=e.from,n=e.task,i=e.reward;this.task=n,this.reward=i,"scp"===t&&(this.from=t,"101"===this.task||"102"===this.task?(this.conditionObj.coursewareType=[this.task],this.coursewareType=[this.task]):(this.conditionObj.coursewareType=["101","102","103"],this.coursewareType=["101","102","103"]),this.storingData(),this.callResourceData=s.a.getScpResourceMaterial())}},{key:"collectParam",value:function(){var e=s.a.getSearch(this._PAGE_ID_),t=e.condition,n=e.learningGoalCode,i=e.coursewareType;this.condition=t||"",this.learningGoalCode=n||[],this.coursewareType=i||[]}},{key:"sybcParam",value:function(){this.conditionObj.condition=this.condition,this.conditionObj.coursewareType=this.coursewareType,this.conditionObj.learningGoalCode=this.learningGoalCode}},{key:"storingData",value:function(){var e=this.condition,t=this.coursewareType,n=this.learningGoalCode;this.passData({condition:e,learningGoalCode:n,coursewareType:t})}},{key:"resetInit",value:function(){this.condition="",this.coursewareType=[],this.learningGoalCode=[],this.conditionObj.coursewareType=[],this.conditionObj.learningGoalCode=[],this.conditionObj.condition=""}},{key:"getDataList",value:function(){var e=this;this.conditionObj.condition=this.conditionObj.condition.trim();var t=Object.assign(Object.assign({},this.conditionObj),{page:this.pageIndex,limit:this.pageSize});this.order&&(t.sort="ascend"===this.order?"useTime|asc":"useTime|desc"),this.conditionObj.coursewareType.length||(t.coursewareType=["101","102","103"]),this.isLoading=!0;var n=[this.materialLibService.resConditionQuery(t)];Object(l.a)(n).subscribe((function(t){var n;e.isLoading=!1,n=t[0],e.isLoading=!1,200===n.status?n.data&&n.data.records&&n.data.records.length?(e.data=n.data.records,e.total=n.data.total,"scp"===e.from&&e.callResourceData.nodes&&(e.data=e.data.map((function(t){var n=e.callResourceData.nodes.find((function(e){return e.id===t.id}));return n?(t.isCall=!0,t.taskId=n.taskId,t.taskType=n.taskType):t.taskType="-1",t.supportType=e.supportType(t.fileType),t})),e.setPermitedCall())):(e.data=[],e.total=0):(e.data=[],e.total=0,e.message.create("error",n.message))}),(function(t){e.isLoading=!1,function(t){e.isLoading=!1,e.message.create("error",JSON.stringify(t))}(t)}))}},{key:"ngOnAttach",value:function(){var e=this;this.selected=s.a.getReadtree()||s.a.getPacketInfoItem("code"),this.collectParam(),this.sybcParam(),this.init=!1,this.knowledgegraphTree=!1,this.changeProfession=!1,Object(d.a)(0).subscribe((function(){e.knowledgegraphTree=!0,e.changeProfession=!0}))}},{key:"onResize",value:function(e){var t=this,n=e.width,i=this.treeContainer&&this.treeContainer.nativeElement&&this.treeContainer.nativeElement.offsetWidth;i&&this.treeContainer.nativeElement.offsetWidth+50<n||i&&this.treeContainer.nativeElement.offsetWidth+10>n||(cancelAnimationFrame(this.id),this.id=requestAnimationFrame((function(){t.width=n})))}},{key:"professionChange",value:function(e){s.a.putReadtree(e.code),this.selectedProfesson=e,this.conditionObj.knowledgeSubjectId=e.id,this.init?(this.pageIndex=1,this.searchData()):(this.init=!0,this.searchData("collect"))}},{key:"nodeChange",value:function(e){"1"===e.kType?(this.conditionObj.knowledgeSubjectId=e.id,this.conditionObj.knowledgeModuleId="",this.conditionObj.knowledgeUnitId="",this.conditionObj.knowledgePointId=""):"2"===e.kType?(this.conditionObj.knowledgeSubjectId="",this.conditionObj.knowledgeModuleId=e.id,this.conditionObj.knowledgeUnitId="",this.conditionObj.knowledgePointId=""):"3"===e.kType?(this.conditionObj.knowledgeSubjectId="",this.conditionObj.knowledgeModuleId="",this.conditionObj.knowledgeUnitId=e.id,this.conditionObj.knowledgePointId=""):"4"===e.kType&&(this.conditionObj.knowledgeSubjectId="",this.conditionObj.knowledgeModuleId="",this.conditionObj.knowledgeUnitId="",this.conditionObj.knowledgePointId=e.id,this.knowledgePointId=e.id),this.pageIndex=1,this.searchData()}},{key:"selectMenu",value:function(e){if(!this.selectedProfesson)return this.message.error("\u8fd8\u6ca1\u6709\u5efa\u7acb\u5b66\u79d1\u54e6~");this.menuService.gotoUrl({url:"/m/rm/material-details",paramUrl:"/0/".concat(e.id,"/").concat(this.selectedProfesson?this.selectedProfesson.id:0,"?knowledgeId=").concat(this.conditionObj.knowledgePointId||"","&t=").concat((new Date).getTime()),title:"\u65b0\u589e"+e.name})}},{key:"edit",value:function(e){this.menuService.gotoUrl({url:"/m/rm/material-details",paramUrl:"/".concat(e.id,"/").concat(e.type,"/").concat(this.selectedProfesson.id)})}},{key:"qcode",value:function(e){var t=this;this.materialLibService.getResourceDetail(e.id,e.type).subscribe((function(n){200===n.status&&(t.qrName=n.data.title,t.qrcode="2"===e.sourceType?f.a.ow365.substr(0,f.a.ow365.length-5)+"polywayId="+n.data.resourceUrl+"&share=0&native=0&ow365=1":f.a.ow365+f.a.OSS_URL+("0"===n.data.resourceUrl.indexOf("/")?n.data.resourceUrl:"/"+n.data.resourceUrl)+"&share=0&native=0&ow365=1",t.qrcodeVisible=!0,console.log(t.qrcode))}))}},{key:"goback",value:function(){this.menuService.goBack(!1),this.menuService.gotoUrl({title:"\u8bfe\u5305\u5efa\u8bbe",url:"/m/course-manage/prepare-course",paramUrl:""})}},{key:"preview",value:function(e){var t=this;e.title.indexOf(".")<0&&"2"===e.sourceType&&"103"===e.type?(this.isPreviewpolyway=!1,this.previewStart=!1,Object(d.a)(0).subscribe((function(){t.resourceUrl=e.fileType,t.previewTitle="",t.isPreviewpolyway=!0,t.previewStart=!0}))):this.materialLibService.getResourceDetail(e.id,e.type).subscribe((function(n){200===n.status&&(n.data.attachmentName.indexOf(".")<0&&"2"===n.data.sourceType&&"103"===e.type?(t.previewStart=!1,t.isPreviewpolyway=!1,Object(d.a)(0).subscribe((function(){t.resourceUrl=e.fileType,t.previewTitle="",t.isPreviewpolyway=!0,t.previewStart=!0}))):(t.previewStart=!1,t.isPreviewpolyway=!1,Object(d.a)(0).subscribe((function(){t.isPreviewpolyway=!1,t.resourceUrl=n.data.resourceUrl,t.previewTitle=n.data.title,t.previewStart=!0}))))}))}},{key:"closePreview",value:function(){this.isPreviewpolyway=!1,this.resourceUrl="",this.previewTitle="",this.previewStart=!1}},{key:"del",value:function(e,t){var n=this;return new Promise((function(t){n.materialLibService.delResource(e.id).subscribe((function(e){200===e.status?(t(!0),n.searchData()):(t(!1),500===e.status&&n.message.error("\u670d\u52a1\u7aef\u4e1a\u52a1\u5f02\u5e38"))}),(function(e){t(!1),n.message.error(JSON.stringify(e))}))}))}},{key:"setPermitedCall",value:function(){this.callResourceData.hasOwnProperty("limit")&&(this.permitedCall=0===Number(this.callResourceData.limit)||!(this.callResourceData.nodes.length>=this.callResourceData.limit||-1===Number(this.callResourceData.limit)))}},{key:"supportType",value:function(e){return!e||!this.callResourceData.supportFileType||-1!==this.callResourceData.supportFileType.indexOf(e.toLowerCase())}},{key:"callResource",value:function(e,t){var n=this,i=function(){if("scp-section-handout"===n.callResourceData.type)return Object.assign(Object.assign({},n.callResourceData.sectionInfo),{resourceId:e.id})}();"1"===this.task?(i.sourceType=e.sourceType,i.name=e.title,i.taskType="0",i.downloadType="0"):("2"===this.task||(i.sourceType=e.sourceType,i.downloadType="101"===this.task?"0":"2",i.resourceId=e.id,i.type=this.task,i.category=e.category),i.title=e.title),i.seq=s.a.getScpResourceMaterial().seq;var o=function(e){if("scp-section-handout"===n.callResourceData.type)return"1"===n.task?n.courseMgService.invoke_courseSectionFileTask(e):"2"===n.task?n.courseMgService.levelInformationAddAndModify(e):n.courseMgService.invoke_courseSectionFile(e)}(i);this.isLoading=!0,o.subscribe((function(e){if(n.isLoading=!1,201===e.status){var o,a=n.task;o="1"===a?"learnSet-task-action":"101"===a?"learnSet-lecture-action":"104"===a?"learnSet-material-action":"learnSet-record-action",n.statisticsLogService.statisticsPacketInfoLog("1"===n.reward?{name:"\u5173\u5361\u5956\u52b1\u8bbe\u7f6e\u9605\u8bfb\u5e93\u8c03\u7528",actionCode:c.j.packetInfo["otherSet-levelthrough-action"].modify,content:JSON.stringify(i)}:{name:"\u9605\u8bfb\u5e93\u8c03\u7528",actionCode:c.j.packetInfo[o].addCode,content:JSON.stringify(i)}),e.data&&e.data.id&&(n.data[t].isCall=!0,n.data[t].taskId=e.data.id,n.data[t].taskType=e.data.taskType,n.callResourceData.nodes.push({id:n.data[t].id,taskId:e.data.id,taskType:e.data.taskType}),n.callResourceData.seq+=1,s.a.putScpResourceMaterial(n.callResourceData),n.setPermitedCall())}else n.message.error(500===e.status?"\u670d\u52a1\u5668\u4e1a\u52a1\u5f02\u5e38\u5bfc\u81f4\u8c03\u7528\u5931\u8d25\uff0c\u53ef\u80fd\u6807\u9898\u592a\u957f\uff0c\u8bf7\u4fdd\u630135\u5b57\u7b26\u4ee5\u5185":e.message)}),(function(e){n.isLoading=!1,n.message.warning(JSON.stringify(e))}))}},{key:"cancelCallResource",value:function(e,t){var n=this;this.modalService.warning({nzTitle:"\u8b66\u544a",nzContent:"2"===this.task?"\u786e\u5b9a\u53d6\u6d88\u8c03\u7528\u5417\uff1f":"\u5220\u9664\u8be5\u8d44\u6e90\u5c06\u4f1a\u5bfc\u81f4\u73b0\u6709\u7684\u8bb0\u5f55\u4e22\u5931\uff0c\u786e\u5b9a\u5220\u9664\u5417\uff1f",nzCancelText:"\u53d6\u6d88",nzOkText:"\u786e\u5b9a",nzOnOk:function(){return new Promise((function(i){n.isLoading=!0,function(){if("scp-section-handout"===n.callResourceData.type)return"1"===n.task?n.courseMgService.del_courseSectionFileTask(e.taskId):"2"===n.task?n.courseMgService.levelDataDeletion(e.taskId):n.courseMgService.del_courseSectionFile(e.taskId)}().subscribe((function(o){if(n.isLoading=!1,204===o.status){if("1"===n.reward)n.statisticsLogService.statisticsPacketInfoLog({name:"\u5173\u5361\u5956\u52b1\u8bbe\u7f6e\u9605\u8bfb\u5e93\u53d6\u6d88\u8c03\u7528",actionCode:c.j.packetInfo["otherSet-levelthrough-action"].modify,content:e.taskId});else{var a,r=n.task;a="1"===r?"learnSet-task-action":"101"===r?"learnSet-lecture-action":"104"===r?"learnSet-material-action":"learnSet-record-action",n.statisticsLogService.statisticsPacketInfoLog({name:"\u9605\u8bfb\u5e93\u53d6\u6d88\u8c03\u7528",actionCode:c.j.packetInfo[a].delCode,content:e.taskId})}n.data[t].isCall=!1,n.callResourceData.nodes=n.callResourceData.nodes.filter((function(e){return e.id!==n.data[t].id})),n.callResourceData.seq-=1,s.a.putScpResourceMaterial(n.callResourceData),n.setPermitedCall(),i(!0)}else n.message.warning(o.message||"\u5220\u9664\u5931\u8d25"),i(!1)}),(function(e){n.isLoading=!1,n.message.warning(JSON.stringify(e)),i(!1)}))}))}})}},{key:"nzSortOtrderChange",value:function(e){this.order=e,this.getDataList()}},{key:"delIF",value:function(e){return"0"===String(e.useTime)}},{key:"downloadQrcode",value:function(){var e=document.createElement("a");e.setAttribute("href",document.querySelector("#qr-code > img").src),e.setAttribute("download",(this.qrName.indexOf(".")>-1?this.qrName.split(".")[0]:this.qrName)+".png"),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}]),n}(u.l)).\u0275fac=function(e){return new(e||re)(r.Ub(p.a),r.Ub(b.a),r.Ub(m.e),r.Ub(v.e),r.Ub(y.a),r.Ub(o.a),r.Ub(C.a),r.Ub(r.u))},re.\u0275cmp=r.Ob({type:re,selectors:[["app-read-lib"]],viewQuery:function(e,t){var n;1&e&&r.Vc(V,!0),2&e&&r.Bc(n=r.jc())&&(t.treeContainer=n.first)},features:[r.Bb],decls:80,vars:36,consts:[[1,"container"],[1,"header"],[1,"title"],[3,"select","hidden","professionChange",4,"ngIf"],["nz-button","","nzType","primary","class","margin-btn",3,"click",4,"ngIf"],["nz-dropdown","","nzTrigger","click","nz-button","","nzType","primary","class","margin-btn",3,"nzDropdownMenu",4,"ngIf"],["menu","nzDropdownMenu"],["nz-menu",""],[4,"ngFor","ngForOf"],["nz-row","",1,"resource-container"],["nz-resizable","",1,"left-tree",3,"nzResize"],[2,"display","inline-block","overflow","hidden","margin-right","30px"],["treeContainer",""],["model","click",3,"professionId","allNodes","nodeChange",4,"ngIf"],["nzDirection","right"],[1,"right-wrap"],["nz-icon","","nzType","more","nzTheme","outline",1,"right"],[1,"right-resource"],[1,"search-container"],[1,"list"],[1,"list-title"],["nz-input","","placeholder","\u652f\u6301\u6807\u9898",2,"width","200px",3,"ngModel","ngModelChange","keyup.enter"],[1,"list-title",2,"margin-left","40px"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","\u8bf7\u9009\u62e9\u8d44\u6e90\u7c7b\u578b","nzMode","multiple",2,"width","200px",3,"ngModel","ngModelChange"],["nzValue","101","nzLabel","\u8bb2\u4e49"],["nzValue","102","nzLabel","\u8d44\u6599"],["nzValue","103","nzLabel","\u89c6\u9891"],["nzMode","multiple","nzShowSearch","",1,"list-input",2,"width","200px",3,"ngModel","ngModelChange"],["nzValue","1","nzLabel","\u4e86\u89e3"],["nzValue","2","nzLabel","\u7406\u89e3"],["nzValue","3","nzLabel","\u638c\u63e1"],["nzValue","4","nzLabel","\u5e94\u7528"],["nzValue","5","nzLabel","\u5206\u6790"],["nzValue","6","nzLabel","\u521b\u65b0"],["nz-button","","nzType","primary",2,"margin-left","40px",3,"click"],["nz-button","","nzType","primary","style","margin-left: 20px;",3,"click",4,"ngIf"],["id","tableScroll",1,"table-container"],[3,"nzData","nzFrontPagination","nzScroll","nzShowSizeChanger","nzShowTotal","nzLoading","nzTotal","nzPageIndex","nzPageSizeOptions","nzPageSize","nzPageIndexChange","nzPageSizeChange"],["ajaxTable",""],[1,"source-header"],["nzWidth","220px"],["nzWidth","120px"],["nzWidth","100px",3,"nzShowSort","nzSortOrder","nzSortOrderChange"],["nzWidth","160px","nzRight",""],["totalTemplate",""],["nzTitle","\u751f\u6210\u4e8c\u7ef4\u7801",3,"nzVisible","nzFooter","nzVisibleChange","nzOnCancel"],[2,"display","flex","justify-content","center","margin-bottom","10px","font-size","18px"],[2,"display","flex","justify-content","center"],["id","qr-code",3,"value","size",4,"ngIf"],["nz-button","",2,"margin","20px 0",3,"nzType","click"],[3,"isPreviewpolyway","previewTitle","resourceUrl","closePreview",4,"ngIf"],[3,"select","hidden","professionChange"],["nz-button","","nzType","primary",1,"margin-btn",3,"click"],["nz-dropdown","","nzTrigger","click","nz-button","","nzType","primary",1,"margin-btn",3,"nzDropdownMenu"],["nz-menu-item","",3,"click"],["model","click",3,"professionId","allNodes","nodeChange"],["nz-button","","nzType","primary",2,"margin-left","20px",3,"click"],[1,"synopsis-text"],[2,"cursor","pointer"],["nz-tooltip","",1,"synopsis-text",3,"nzTooltipTitle"],["nzRight","",4,"ngIf"],["nzRight",""],[3,"click"],["class","light-color",3,"click",4,"ngIf"],[1,"light-color",3,"click"],[3,"click",4,"ngIf"],["style","color: #999;",4,"ngIf"],[2,"color","#999"],["id","qr-code",3,"value","size"],[3,"isPreviewpolyway","previewTitle","resourceUrl","closePreview"]],template:function(e,t){if(1&e&&(r.ac(0,"div",0),r.ac(1,"section",1),r.ac(2,"div",2),r.Pc(3),r.Nc(4,q,1,2,"qkc-change-profession",3),r.Zb(),r.ac(5,"div"),r.Nc(6,B,2,0,"button",4),r.Nc(7,G,2,1,"button",5),r.ac(8,"nz-dropdown-menu",null,6),r.ac(10,"ul",7),r.Nc(11,X,3,1,"ng-container",8),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.ac(12,"section",9),r.ac(13,"section",10),r.ic("nzResize",(function(e){return t.onResize(e)})),r.ac(14,"div",11,12),r.Nc(16,W,1,2,"qkc-tree-knowledgegraph",13),r.Zb(),r.ac(17,"nz-resize-handle",14),r.ac(18,"div",15),r.Vb(19,"i",16),r.Zb(),r.Zb(),r.Zb(),r.ac(20,"section",17),r.ac(21,"section",18),r.ac(22,"div",19),r.ac(23,"div",20),r.Pc(24,"\u5173\u952e\u8bcd\u641c\u7d22\uff1a"),r.Zb(),r.ac(25,"input",21),r.ic("ngModelChange",(function(e){return t.condition=e}))("keyup.enter",(function(){return t.searchData("button")}))("ngModelChange",(function(){return t.storingData()})),r.Zb(),r.ac(26,"div",22),r.Pc(27,"\u8d44\u6e90\u7c7b\u578b\uff1a"),r.Zb(),r.ac(28,"nz-select",23),r.ic("ngModelChange",(function(e){return t.coursewareType=e}))("ngModelChange",(function(){return t.storingData()})),r.Vb(29,"nz-option",24),r.Vb(30,"nz-option",25),r.Vb(31,"nz-option",26),r.Zb(),r.ac(32,"div",22),r.Pc(33,"\u5b66\u4e60\u76ee\u6807\uff1a"),r.Zb(),r.ac(34,"nz-select",27),r.ic("ngModelChange",(function(e){return t.learningGoalCode=e}))("ngModelChange",(function(){return t.storingData()})),r.Vb(35,"nz-option",28),r.Vb(36,"nz-option",29),r.Vb(37,"nz-option",30),r.Vb(38,"nz-option",31),r.Vb(39,"nz-option",32),r.Vb(40,"nz-option",33),r.Zb(),r.ac(41,"button",34),r.ic("click",(function(){return t.searchData("button")})),r.Pc(42,"\u67e5\u8be2"),r.Zb(),r.Nc(43,$,2,0,"button",35),r.Zb(),r.Zb(),r.ac(44,"section",36),r.ac(45,"nz-table",37,38),r.ic("nzPageIndexChange",(function(e){return t.pageIndex=e}))("nzPageSizeChange",(function(e){return t.pageSize=e}))("nzPageIndexChange",(function(){return t.searchData()}))("nzPageSizeChange",(function(){return t.searchData()})),r.ac(47,"thead",39),r.ac(48,"tr"),r.ac(49,"th",40),r.Pc(50,"\u6807\u9898"),r.Zb(),r.ac(51,"th",41),r.Pc(52,"\u8d44\u6e90\u7c7b\u578b"),r.Zb(),r.ac(53,"th",40),r.Pc(54,"\u77e5\u8bc6\u70b9"),r.Zb(),r.ac(55,"th",41),r.Pc(56,"\u5b66\u4e60\u76ee\u6807"),r.Zb(),r.ac(57,"th",41),r.Pc(58,"\u521b\u5efa\u8005"),r.Zb(),r.ac(59,"th",41),r.Pc(60,"\u4f5c\u8005"),r.Zb(),r.ac(61,"th",41),r.Pc(62,"\u66f4\u65b0\u65f6\u95f4"),r.Zb(),r.ac(63,"th",42),r.ic("nzSortOrderChange",(function(e){return t.nzSortOtrderChange(e)})),r.Pc(64,"\u4f7f\u7528\u6b21\u6570 "),r.Zb(),r.ac(65,"th",43),r.Pc(66,"\u64cd\u4f5c"),r.Zb(),r.Zb(),r.Zb(),r.ac(67,"tbody"),r.Nc(68,ne,21,11,"tr",8),r.Zb(),r.Zb(),r.Zb(),r.Nc(69,ie,1,1,"ng-template",null,44,r.Oc),r.Zb(),r.Zb(),r.Zb(),r.ac(71,"nz-modal",45),r.ic("nzVisibleChange",(function(e){return t.qrcodeVisible=e}))("nzOnCancel",(function(){return t.qrcodeVisible=!1})),r.ac(72,"div",46),r.Pc(73),r.Zb(),r.ac(74,"div",47),r.Nc(75,oe,1,2,"qr-code",48),r.Zb(),r.ac(76,"div",47),r.ac(77,"button",49),r.ic("click",(function(){return t.downloadQrcode()})),r.Pc(78,"\u4e0b\u8f7d\u4e8c\u7ef4\u7801\u56fe\u7247"),r.Zb(),r.Zb(),r.Zb(),r.Nc(79,ae,1,3,"app-resource-preview-modal",50)),2&e){var n=r.Cc(46),i=r.Cc(70);r.Eb(3),r.Rc(" ",null==t.selectedProfesson?null:t.selectedProfesson.name," "),r.Eb(1),r.tc("ngIf",t.changeProfession),r.Eb(2),r.tc("ngIf","scp"===t.from),r.Eb(1),r.tc("ngIf",""===t.from),r.Eb(4),r.tc("ngForOf",t.materialMenus),r.Eb(2),r.Mc("width",t.width,"px"),r.Eb(3),r.tc("ngIf",t.knowledgegraphTree),r.Eb(9),r.tc("ngModel",t.condition),r.Eb(3),r.tc("ngModel",t.coursewareType),r.Eb(6),r.tc("ngModel",t.learningGoalCode),r.Eb(9),r.tc("ngIf","scp"!==t.from),r.Eb(1),r.Kb("no-scoll",!t.data.length),r.Eb(1),r.tc("nzData",t.data)("nzFrontPagination",!1)("nzScroll",r.xc(33,ce,t.height+"px"))("nzShowSizeChanger",!0)("nzShowTotal",i)("nzLoading",t.isLoading)("nzTotal",t.total)("nzPageIndex",t.pageIndex)("nzPageSizeOptions",r.wc(35,se))("nzPageSize",t.pageSize),r.Eb(18),r.tc("nzShowSort",!0)("nzSortOrder",t.order),r.Eb(5),r.tc("ngForOf",n.data),r.Eb(3),r.tc("nzVisible",t.qrcodeVisible)("nzFooter",null),r.Eb(2),r.Rc(" ",t.qrName," "),r.Eb(2),r.tc("ngIf",t.qrcode),r.Eb(2),r.tc("nzType","primary"),r.Eb(2),r.tc("ngIf",t.previewStart)}},directives:[z.n,P.e,k.c,z.m,w.c,O.a,O.c,_.a,M.a,x.b,S.c,S.o,S.q,E.d,E.a,T.a,I.a,Z.c,Z.j,Z.k,Z.b,Z.h,Z.g,Z.a,Z.e,m.a,L.a,P.b,P.d,k.d,R.a,D.d,A,U.a],styles:[".margin-btn[_ngcontent-%COMP%]{margin-left:15px}.light-color[_ngcontent-%COMP%]{color:red}.gray-color[_ngcontent-%COMP%]{color:#999}.container[_ngcontent-%COMP%]{background-color:#fff;padding:10px;height:100%}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px;padding-left:5px}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:500}.resource-container[_ngcontent-%COMP%]{height:calc(100% - 42px);overflow:hidden;display:flex}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]{height:100%;overflow-x:hidden;overflow-y:auto;min-width:200px}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right-wrap[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;text-align:center;font-size:12px;height:20px;line-height:20px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]{padding-left:30px;flex:1;height:100%;overflow:hidden;border-left:1px solid #ddd}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{margin-bottom:10px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;min-height:50px;align-items:center;border-bottom:1px solid #eee}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-title[_ngcontent-%COMP%]{min-width:85px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;padding:5px 15px;margin-right:12px;cursor:pointer}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{background-color:#1890ff;border-radius:5px;color:#fff}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-content[_ngcontent-%COMP%]{flex-grow:2}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{height:calc(100% - 260px);overflow:auto}.source-header[_ngcontent-%COMP%]{font-weight:bolder}tr.light-tr[_ngcontent-%COMP%]{background:#e6f7ff}[_nghost-%COMP%]     .ant-table-tbody>tr>td, [_nghost-%COMP%]     .ant-table-thead>tr>th, [_nghost-%COMP%]     .ant-table tfoot>tr>td, [_nghost-%COMP%]     .ant-table tfoot>tr>th{padding:10px 5px}.ant-table-tbody[_ngcontent-%COMP%] > tr.ant-table-row[_ngcontent-%COMP%]:hover > td[_ngcontent-%COMP%]{background:#dde0df}[_nghost-%COMP%]     .ant-table-pagination.ant-pagination{position:fixed;bottom:20px;right:20px;background:#fff}[_nghost-%COMP%]     .ant-spin-container{position:static}[_nghost-%COMP%]     .ant-tree{position:static!important}nz-content[_ngcontent-%COMP%]{flex:1!important}.synopsis-text[_ngcontent-%COMP%]{width:100%;display:-webkit-box!important;word-break:break-all;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}  .no-scoll .ant-table-body{overflow:hidden!important}[_nghost-%COMP%]     .table-container{height:calc(100% - 110px)!important}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-title[_ngcontent-%COMP%]{width:100px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:200px}[_nghost-%COMP%]     .ant-tree-title{max-width:200px;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"]}),Object(a.b)([Object(g.b)({title:function(e){return'\u786e\u5b9a\u5220\u9664"'.concat(e[0].title,'"\u7684\u9605\u8bfb\u8d44\u6e90\uff1f')},content:"",type:"warning"})],re.prototype,"del",null),re),de=["treeContainer"];function ue(e,t){if(1&e){var n=r.bc();r.ac(0,"qkc-change-profession",39),r.ic("professionChange",(function(e){return r.Ec(n),r.lc().professionChange(e)})),r.Zb()}if(2&e){var i=r.lc();r.tc("select",i.selected)("hidden","scp"===i.from)}}function he(e,t){if(1&e){var n=r.bc();r.ac(0,"button",27),r.ic("click",(function(){return r.Ec(n),r.lc().goback()})),r.Pc(1,"\u5b8c\u6210\u8c03\u7528"),r.Zb()}}function ge(e,t){if(1&e){var n=r.bc();r.ac(0,"button",27),r.ic("click",(function(){return r.Ec(n),r.lc().goAddCase()})),r.Pc(1,"\u65b0\u589e\u6848\u4f8b"),r.Zb()}}function fe(e,t){if(1&e){var n=r.bc();r.ac(0,"qkc-tree-knowledgegraph",40),r.ic("nodeChange",(function(e){return r.Ec(n),r.lc().nodeChange(e)})),r.Zb()}if(2&e){var i=r.lc();r.tc("professionId",null==i.selectedProfesson?null:i.selectedProfesson.id)("allNodes",!0)}}function pe(e,t){if(1&e){var n=r.bc();r.ac(0,"a",47),r.ic("click",(function(){r.Ec(n);var e=r.lc(2).$implicit;return r.lc().del(e)})),r.Pc(1,"\u5220\u9664"),r.Zb()}}function be(e,t){if(1&e){var n=r.bc();r.ac(0,"td",44),r.ac(1,"a",45),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().copy(e)})),r.Pc(2,"\u590d\u5236 "),r.Zb(),r.ac(3,"a",45),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().preview(e)})),r.Pc(4,"\u9884\u89c8 "),r.Zb(),r.ac(5,"a",45),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().edit(e)})),r.Pc(6,"\u7f16\u8f91 "),r.Zb(),r.Nc(7,pe,2,0,"a",46),r.Zb()}if(2&e){var i=r.lc().$implicit,o=r.lc();r.Eb(7),r.tc("ngIf",o.delIF(i))}}function me(e,t){if(1&e){var n=r.bc();r.ac(0,"a",45),r.ic("click",(function(){r.Ec(n);var e=r.lc(2),t=e.$implicit,i=e.index;return r.lc().callResource(t,i)})),r.Pc(1,"\u8c03\u7528"),r.Zb()}}function ve(e,t){if(1&e){var n=r.bc();r.ac(0,"a",47),r.ic("click",(function(){r.Ec(n);var e=r.lc(2),t=e.$implicit,i=e.index;return r.lc().cancelCallResource(t,i)})),r.Pc(1,"\u53d6\u6d88\u8c03\u7528"),r.Zb()}}function ye(e,t){1&e&&(r.ac(0,"a",50),r.Pc(1,"\u5df2\u8c03\u7528"),r.Zb())}function Ce(e,t){if(1&e){var n=r.bc();r.ac(0,"td",44),r.ac(1,"a",45),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().preview(e)})),r.Pc(2,"\u9884\u89c8 "),r.Zb(),r.Nc(3,me,2,0,"a",48),r.Nc(4,ve,2,0,"a",46),r.Nc(5,ye,2,0,"a",49),r.Zb()}if(2&e){var i=r.lc().$implicit,o=r.lc();r.Eb(3),r.tc("ngIf",!i.isCall&&o.permitedCall),r.Eb(1),r.tc("ngIf",i.isCall&&!o.callResourceData.isStandard),r.Eb(1),r.tc("ngIf",i.isCall&&o.callResourceData.isStandard)}}function ze(e,t){if(1&e&&(r.ac(0,"tr"),r.ac(1,"td"),r.ac(2,"span",41),r.Pc(3),r.Zb(),r.Zb(),r.ac(4,"td"),r.Pc(5),r.Zb(),r.ac(6,"td",42),r.ac(7,"span",41),r.Pc(8),r.Zb(),r.Zb(),r.ac(9,"td"),r.Pc(10),r.Zb(),r.ac(11,"td"),r.Pc(12),r.Zb(),r.ac(13,"td"),r.Pc(14),r.Zb(),r.ac(15,"td"),r.Pc(16),r.Zb(),r.Nc(17,be,8,1,"td",43),r.Nc(18,Ce,6,3,"td",43),r.Zb()),2&e){var n=t.$implicit,i=r.lc();r.Eb(3),r.Qc(null==n?null:n.title),r.Eb(2),r.Qc(i.getName(null==n?null:n.learningGoalCode,"LEARNING_TARGET")),r.Eb(1),r.tc("nzTooltipTitle",null==n?null:n.pointName),r.Eb(2),r.Qc(null==n?null:n.pointName),r.Eb(2),r.Qc(null==n?null:n.createrName),r.Eb(2),r.Qc(null==n?null:n.authorName),r.Eb(2),r.Qc(i.getDate(null==n?null:n.lastModifiedTime)),r.Eb(2),r.Qc(null==n?null:n.useTime),r.Eb(1),r.tc("ngIf",""==i.from),r.Eb(1),r.tc("ngIf","scp"==i.from)}}function Pe(e,t){1&e&&r.Pc(0),2&e&&r.Rc("\u5171 ",t.$implicit," \u6761\u8bb0\u5f55")}var ke,we=function(){return[15,20,30,40,50]},Oe=function(e){return{x:"1260px",y:e}},_e=((ke=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,a,r,s,l,d){var u;return _classCallCheck(this,n),(u=t.call(this)).menuService=e,u.modalService=i,u.message=o,u.route=a,u.materialLibService=r,u.courseMgService=s,u.statisticsLogService=l,u.locale=d,u._PAGE_ID_="MaterialCaseLibraryComponent",u.id=-1,u.knowledgePointId="",u.conditionObj={category:100,knowledgeSubjectId:"",knowledgeModuleId:"",knowledgeUnitId:"",knowledgePointId:"",condition:"",coursewareType:["104"],learningGoalCode:[""]},u.from="",u.callResourceData={},u.callResourceId="MaterialCallResource",u.selected="",u.knowledgegraphTree=!0,u.changeProfession=!0,u.init=!1,u.permitedCall=!0,u.getName=c.k,u.order=null,u}return _createClass(n,[{key:"initData",value:function(){this.selected=s.a.getCasetree()||s.a.getPacketInfoItem("code");var e=this.route.snapshot.queryParams,t=e.from,n=e.task;this.task=n,"scp"===t&&(this.from=t,this.callResourceData=s.a.getScpResourceMaterial())}},{key:"ngOnAttach",value:function(){var e=this;this.selected=s.a.getCasetree()||s.a.getPacketInfoItem("code"),this.collectParam(),this.sybcParam(),this.init=!1,this.knowledgegraphTree=!1,this.changeProfession=!1,Object(d.a)(0).subscribe((function(){e.knowledgegraphTree=!0,e.changeProfession=!0}))}},{key:"collectParam",value:function(){var e=s.a.getSearch(this._PAGE_ID_),t=e.condition,n=e.learningGoalCode;this.condition=t||"",this.learningGoalCode=n||[]}},{key:"sybcParam",value:function(){this.conditionObj.condition=this.condition,this.conditionObj.learningGoalCode=this.learningGoalCode}},{key:"storingData",value:function(){var e=this.condition,t=this.learningGoalCode;this.passData({condition:e,learningGoalCode:t})}},{key:"resetInit",value:function(){this.condition="",this.learningGoalCode=[],this.conditionObj.learningGoalCode=[],this.conditionObj.condition=""}},{key:"searchData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(this.pageIndex=1,this.learningGoalCode=[],this.condition="",this.conditionObj.learningGoalCode=[],this.conditionObj.condition="",this.removeData()),this.getDataList()}},{key:"collectSearch",value:function(){this.collectParam(),this.sybcParam(),this.getDataList()}},{key:"resetSearch",value:function(){this.pageIndex=1,this.conditionObj.condition=this.condition,this.conditionObj.learningGoalCode=this.learningGoalCode,this.getDataList()}},{key:"getDataList",value:function(){var e=this;this.conditionObj.condition=this.conditionObj.condition.trim();var t=Object.assign(Object.assign({},this.conditionObj),{page:this.pageIndex,limit:this.pageSize});this.order&&(t.sort="ascend"===this.order?"useTime|asc":"useTime|desc"),this.isLoading=!0;var n=[this.materialLibService.resConditionQuery(t)];Object(l.a)(n).subscribe((function(t){var n;e.isLoading=!1,n=t[0],e.isLoading=!1,200===n.status?n.data&&n.data.records&&n.data.records.length?(e.data=n.data.records,e.total=n.data.total,"scp"===e.from&&e.callResourceData.nodes&&e.callResourceData.nodes.length>0&&(e.data=e.data.map((function(t){var n=e.callResourceData.nodes.find((function(e){return e.id===t.id}));return n&&(t.isCall=!0,t.taskId=n.taskId),t})),e.setPermitedCall())):(e.data=[],e.total=0):(e.data=[],e.total=0,e.message.create("error",n.message))}),(function(t){e.isLoading=!1,function(t){e.isLoading=!1,e.message.create("error",JSON.stringify(t))}(t)}))}},{key:"onResize",value:function(e){var t=this,n=e.width,i=this.treeContainer&&this.treeContainer.nativeElement&&this.treeContainer.nativeElement.offsetWidth;i&&this.treeContainer.nativeElement.offsetWidth+80<n||i&&this.treeContainer.nativeElement.offsetWidth+10>n||(cancelAnimationFrame(this.id),this.id=requestAnimationFrame((function(){t.width=n})))}},{key:"setPermitedCall",value:function(){this.callResourceData.hasOwnProperty("limit")&&(this.permitedCall=0===Number(this.callResourceData.limit)||!(this.callResourceData.nodes.length>=this.callResourceData.limit||-1===Number(this.callResourceData.limit)))}},{key:"professionChange",value:function(e){s.a.putCasetree(e.code),this.selectedProfesson=e,this.conditionObj.knowledgeSubjectId=e.id,this.init?(this.pageIndex=1,this.searchData()):(this.init=!0,this.collectSearch())}},{key:"nodeChange",value:function(e){"1"===e.kType?(this.conditionObj.knowledgeSubjectId=e.id,this.conditionObj.knowledgeModuleId="",this.conditionObj.knowledgeUnitId="",this.conditionObj.knowledgePointId=""):"2"===e.kType?(this.conditionObj.knowledgeSubjectId="",this.conditionObj.knowledgeModuleId=e.id,this.conditionObj.knowledgeUnitId="",this.conditionObj.knowledgePointId=""):"3"===e.kType?(this.conditionObj.knowledgeSubjectId="",this.conditionObj.knowledgeModuleId="",this.conditionObj.knowledgeUnitId=e.id,this.conditionObj.knowledgePointId=""):"4"===e.kType&&(this.conditionObj.knowledgeSubjectId="",this.conditionObj.knowledgeModuleId="",this.conditionObj.knowledgeUnitId="",this.conditionObj.knowledgePointId=e.id,this.knowledgePointId=e.id),this.pageIndex=1,this.searchData()}},{key:"goAddCase",value:function(){if(!this.selectedProfesson)return this.message.error("\u8fd8\u6ca1\u6709\u5efa\u7acb\u5b66\u79d1\u54e6~");this.menuService.gotoUrl({url:"/m/rm/material-details",paramUrl:"/0/104/".concat(this.selectedProfesson?this.selectedProfesson.id:0,"?t=").concat((new Date).getTime()),title:"\u65b0\u589e\u6848\u4f8b"})}},{key:"edit",value:function(e){this.menuService.gotoUrl({url:"/m/rm/material-details",paramUrl:"/".concat(e.id,"/").concat(e.type,"/").concat(this.selectedProfesson.id),title:"\u7f16\u8f91\u6848\u4f8b"})}},{key:"preview",value:function(e){this.menuService.gotoUrl({url:"/m/rm/material-pre-case",paramUrl:"/".concat(e.id,"/").concat(e.type,"/").concat(this.selectedProfesson.id),title:"\u9884\u89c8\u6848\u4f8b"})}},{key:"copy",value:function(e){var t=this;return new Promise((function(n){t.materialLibService.copyResource(e.id).subscribe((function(e){201===e.status?(t.searchData(),n(!0)):(500===e.status&&t.message.error("\u670d\u52a1\u5668\u4e1a\u52a1\u5f02\u5e38"),n(!1))}),(function(e){t.message.error(JSON.stringify(e)),n(!1)}))}))}},{key:"goback",value:function(){this.menuService.goBack(!1),this.menuService.gotoUrl({title:"\u8bfe\u5305\u5efa\u8bbe",url:"/m/course-manage/prepare-course",paramUrl:""})}},{key:"del",value:function(e){var t=this;return new Promise((function(n){t.materialLibService.delResource(e.id).subscribe((function(e){200===e.status?(t.searchData(),n(!0)):(500===e.status&&t.message.error("\u670d\u52a1\u5668\u4e1a\u52a1\u5f02\u5e38"),n(!1))}),(function(e){t.message.error(JSON.stringify(e)),n(!1)}))}))}},{key:"delIF",value:function(e){return"0"===String(e.useTime)}},{key:"callResource",value:function(e,t){var n=this,i=function(e){n.isLoading=!1,n.message.warning(JSON.stringify(e))},o=Object.assign(Object.assign({},this.callResourceData.sectionInfo),{resourceId:e.id,sourceType:1,isGrade:"1"}),a=function(e){if(n.isLoading=!1,201===e.status){var i,a=n.task;i="1"===a?"learnSet-task-action":"101"===a?"learnSet-lecture-action":"104"===a?"learnSet-material-action":"learnSet-record-action",n.statisticsLogService.statisticsPacketInfoLog({name:"\u6848\u4f8b\u5e93\u8c03\u7528",actionCode:c.j.packetInfo[i].addCode,content:JSON.stringify(o)}),n.data[t].isCall=!0,n.data[t].taskId=e.data.id,n.callResourceData.nodes.push({id:n.data[t].id,taskId:e.data.id}),n.callResourceData.seq+=1,s.a.putScpResourceMaterial(n.callResourceData),n.setPermitedCall()}else n.message.error(500===e.status?"\u670d\u52a1\u5668\u4e1a\u52a1\u5f02\u5e38\u5bfc\u81f4\u8c03\u7528\u5931\u8d25\uff0c\u53ef\u80fd\u6807\u9898\u592a\u957f\uff0c\u8bf7\u4fdd\u630135\u5b57\u7b26\u4ee5\u5185":e.message)};this.isLoading=!0,"1"===this.task?(o.name=e.title,o.taskType="1",o.seq=s.a.getScpResourceMaterial().seq,this.courseMgService.quickCreate_courseSectionResourceTask(o).subscribe(a,i)):(o.title=e.title,o.category=e.category,o.type=this.task,o.seq=s.a.getScpResourceMaterial().seq,this.courseMgService.quickCreate_courseSectionResource(o).subscribe(a,i))}},{key:"cancelCallResource",value:function(e,t){var n=this,i=function(e){n.isLoading=!1,n.message.warning(JSON.stringify(e))},o=function(i){if(n.isLoading=!1,204===i.status){var o,a=n.task;o="1"===a?"learnSet-task-action":"101"===a?"learnSet-lecture-action":"104"===a?"learnSet-material-action":"learnSet-record-action",n.statisticsLogService.statisticsPacketInfoLog({name:"\u6848\u4f8b\u5e93\u53d6\u6d88\u8c03\u7528",actionCode:c.j.packetInfo[o].delCode,content:e.taskId}),n.data[t].isCall=!1,n.callResourceData.nodes=n.callResourceData.nodes.filter((function(e){return e.id!==n.data[t].id})),n.callResourceData.seq-=1,s.a.putScpResourceMaterial(n.callResourceData),n.setPermitedCall()}else n.message.warning(JSON.stringify(i))};this.isLoading=!0,"1"===this.task?this.courseMgService.delInvoke_courseTask(e.taskId).subscribe(o,i):this.courseMgService.delInvoke_course(e.taskId).subscribe(o,i)}},{key:"nzSortOtrderChange",value:function(e){this.order=e,this.getDataList()}}]),n}(u.l)).\u0275fac=function(e){return new(e||ke)(r.Ub(b.a),r.Ub(m.e),r.Ub(v.e),r.Ub(o.a),r.Ub(p.a),r.Ub(y.a),r.Ub(C.a),r.Ub(r.u))},ke.\u0275cmp=r.Ob({type:ke,selectors:[["app-case-lib"]],viewQuery:function(e,t){var n;1&e&&r.Vc(de,!0),2&e&&r.Bc(n=r.jc())&&(t.treeContainer=n.first)},features:[r.Bb],decls:64,vars:27,consts:[[1,"container"],[1,"header"],[1,"title"],[3,"select","hidden","professionChange",4,"ngIf"],["nz-button","","nzType","primary","class","margin-btn",3,"click",4,"ngIf"],["nz-row","",1,"resource-container"],["nz-resizable","",1,"left-tree",3,"nzResize"],[2,"display","inline-block","overflow","hidden","margin-right","30px"],["treeContainer",""],["model","click",3,"professionId","allNodes","nodeChange",4,"ngIf"],["nzDirection","right"],[1,"right-wrap"],["nz-icon","","nzType","more","nzTheme","outline",1,"right"],[1,"right-resource"],[1,"search-container"],[1,"list"],[1,"list-title"],[1,"list-input"],["nz-input","","placeholder","\u652f\u6301\u6807\u9898",3,"ngModel","ngModelChange","keyup.enter"],[1,"list-title",2,"margin-left","20px"],["nzMode","multiple",1,"list-input",2,"width","100%","max-width","300px",3,"ngModel","ngModelChange"],["nzValue","1","nzLabel","\u4e86\u89e3"],["nzValue","2","nzLabel","\u7406\u89e3"],["nzValue","3","nzLabel","\u638c\u63e1"],["nzValue","4","nzLabel","\u5e94\u7528"],["nzValue","5","nzLabel","\u5206\u6790"],["nzValue","6","nzLabel","\u521b\u65b0"],["nz-button","","nzType","primary",1,"margin-btn",3,"click"],["nz-button","","nzType","primary",2,"margin-left","20px",3,"click"],["id","tableScroll",1,"table-container"],[3,"nzData","nzFrontPagination","nzShowSizeChanger","nzPageSizeOptions","nzScroll","nzShowTotal","nzLoading","nzTotal","nzPageIndex","nzPageSize","nzPageIndexChange","nzPageSizeChange"],["ajaxTable",""],[1,"source-header"],["nzWidth","220px"],["nzWidth","120px"],["nzWidth","100px",3,"nzShowSort","nzSortOrder","nzSortOrderChange"],["nzWidth","120px","nzRight",""],[4,"ngFor","ngForOf"],["totalTemplate",""],[3,"select","hidden","professionChange"],["model","click",3,"professionId","allNodes","nodeChange"],[1,"synopsis-text"],["nzTooltipTrigger","click","nz-tooltip","",2,"cursor","pointer",3,"nzTooltipTitle"],["nzRight","",4,"ngIf"],["nzRight",""],[3,"click"],["class","light-color",3,"click",4,"ngIf"],[1,"light-color",3,"click"],[3,"click",4,"ngIf"],["style","color: #999;",4,"ngIf"],[2,"color","#999"]],template:function(e,t){if(1&e&&(r.ac(0,"div",0),r.ac(1,"section",1),r.ac(2,"div",2),r.Pc(3),r.Nc(4,ue,1,2,"qkc-change-profession",3),r.Zb(),r.ac(5,"div"),r.Nc(6,he,2,0,"button",4),r.Nc(7,ge,2,0,"button",4),r.Zb(),r.Zb(),r.ac(8,"section",5),r.ac(9,"section",6),r.ic("nzResize",(function(e){return t.onResize(e)})),r.ac(10,"div",7,8),r.Nc(12,fe,1,2,"qkc-tree-knowledgegraph",9),r.Zb(),r.ac(13,"nz-resize-handle",10),r.ac(14,"div",11),r.Vb(15,"i",12),r.Zb(),r.Zb(),r.Zb(),r.ac(16,"section",13),r.ac(17,"section",14),r.ac(18,"div",15),r.ac(19,"div",16),r.Pc(20,"\u5173\u952e\u8bcd\u641c\u7d22\uff1a"),r.Zb(),r.ac(21,"div",17),r.ac(22,"input",18),r.ic("ngModelChange",(function(e){return t.condition=e}))("ngModelChange",(function(){return t.storingData()}))("keyup.enter",(function(){return t.resetSearch()})),r.Zb(),r.Zb(),r.Zb(),r.ac(23,"div",15),r.ac(24,"div",19),r.Pc(25,"\u5b66\u4e60\u76ee\u6807\uff1a"),r.Zb(),r.ac(26,"div",17),r.ac(27,"nz-select",20),r.ic("ngModelChange",(function(e){return t.learningGoalCode=e}))("ngModelChange",(function(){return t.storingData()})),r.Pc(28,' nzShowSearch [nzMaxTagPlaceholder]="tagPlaceHolder" '),r.Vb(29,"nz-option",21),r.Vb(30,"nz-option",22),r.Vb(31,"nz-option",23),r.Vb(32,"nz-option",24),r.Vb(33,"nz-option",25),r.Vb(34,"nz-option",26),r.Zb(),r.Zb(),r.Zb(),r.ac(35,"button",27),r.ic("click",(function(){return t.resetSearch()})),r.Pc(36,"\u67e5\u8be2 "),r.Zb(),r.ac(37,"button",28),r.ic("click",(function(){return t.resetData()})),r.Pc(38,"\u91cd\u7f6e"),r.Zb(),r.Zb(),r.ac(39,"section",29),r.ac(40,"nz-table",30,31),r.ic("nzPageIndexChange",(function(e){return t.pageIndex=e}))("nzPageSizeChange",(function(e){return t.pageSize=e}))("nzPageIndexChange",(function(){return t.searchData()}))("nzPageSizeChange",(function(){return t.searchData()})),r.ac(42,"thead",32),r.ac(43,"tr"),r.ac(44,"th",33),r.Pc(45,"\u6807\u9898"),r.Zb(),r.ac(46,"th",34),r.Pc(47,"\u5b66\u4e60\u76ee\u6807"),r.Zb(),r.ac(48,"th",33),r.Pc(49,"\u77e5\u8bc6\u70b9"),r.Zb(),r.ac(50,"th",34),r.Pc(51,"\u521b\u5efa\u8005"),r.Zb(),r.ac(52,"th",34),r.Pc(53,"\u4f5c\u8005"),r.Zb(),r.ac(54,"th",34),r.Pc(55,"\u66f4\u65b0\u65f6\u95f4"),r.Zb(),r.ac(56,"th",35),r.ic("nzSortOrderChange",(function(e){return t.nzSortOtrderChange(e)})),r.Pc(57,"\u4f7f\u7528\u6b21\u6570 "),r.Zb(),r.ac(58,"th",36),r.Pc(59,"\u64cd\u4f5c"),r.Zb(),r.Zb(),r.Zb(),r.ac(60,"tbody"),r.Nc(61,ze,19,10,"tr",37),r.Zb(),r.Zb(),r.Zb(),r.Nc(62,Pe,1,1,"ng-template",null,38,r.Oc),r.Zb(),r.Zb(),r.Zb()),2&e){var n=r.Cc(41),i=r.Cc(63);r.Eb(3),r.Rc(" ",null==t.selectedProfesson?null:t.selectedProfesson.name," "),r.Eb(1),r.tc("ngIf",t.changeProfession),r.Eb(2),r.tc("ngIf","scp"===t.from),r.Eb(1),r.tc("ngIf",""===t.from),r.Eb(2),r.Mc("width",t.width,"px"),r.Eb(3),r.tc("ngIf",t.knowledgegraphTree),r.Eb(10),r.tc("ngModel",t.condition),r.Eb(5),r.tc("ngModel",t.learningGoalCode),r.Eb(12),r.Kb("no-scoll",!t.data.length),r.Eb(1),r.tc("nzData",t.data)("nzFrontPagination",!1)("nzShowSizeChanger",!0)("nzPageSizeOptions",r.wc(24,we))("nzScroll",r.xc(25,Oe,t.height+"px"))("nzShowTotal",i)("nzLoading",t.isLoading)("nzTotal",t.total)("nzPageIndex",t.pageIndex)("nzPageSize",t.pageSize),r.Eb(16),r.tc("nzShowSort",!0)("nzSortOrder",t.order),r.Eb(5),r.tc("ngForOf",n.data)}},directives:[z.n,w.c,O.a,O.c,_.a,M.a,x.b,S.c,S.o,S.q,E.d,E.a,T.a,I.a,Z.c,Z.j,Z.k,Z.b,Z.h,Z.g,Z.a,Z.e,z.m,L.a,R.a,D.d],styles:[".margin-btn[_ngcontent-%COMP%]{margin-left:15px}.light-color[_ngcontent-%COMP%]{color:red}.gray-color[_ngcontent-%COMP%]{color:#999}.container[_ngcontent-%COMP%]{background-color:#fff;padding:10px;height:100%}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px;padding-left:5px}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:500}.resource-container[_ngcontent-%COMP%]{height:calc(100% - 42px);overflow:hidden;display:flex}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]{height:100%;overflow-x:hidden;overflow-y:auto;min-width:200px}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right-wrap[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;text-align:center;font-size:12px;height:20px;line-height:20px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]{padding-left:30px;flex:1;height:100%;overflow:hidden;border-left:1px solid #ddd}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{margin-bottom:10px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{min-height:50px;align-items:center;border-bottom:1px solid #eee}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;padding:5px 15px;margin-right:12px;cursor:pointer}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{background-color:#1890ff;border-radius:5px;color:#fff}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-content[_ngcontent-%COMP%]{flex-grow:2}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{height:calc(100% - 260px);overflow:auto}.source-header[_ngcontent-%COMP%]{font-weight:bolder}tr.light-tr[_ngcontent-%COMP%]{background:#e6f7ff}[_nghost-%COMP%]     .ant-table-tbody>tr>td, [_nghost-%COMP%]     .ant-table-thead>tr>th, [_nghost-%COMP%]     .ant-table tfoot>tr>td, [_nghost-%COMP%]     .ant-table tfoot>tr>th{padding:10px 5px}.ant-table-tbody[_ngcontent-%COMP%] > tr.ant-table-row[_ngcontent-%COMP%]:hover > td[_ngcontent-%COMP%]{background:#dde0df}[_nghost-%COMP%]     .ant-table-pagination.ant-pagination{position:fixed;bottom:20px;right:20px;background:#fff}[_nghost-%COMP%]     .ant-spin-container{position:static}[_nghost-%COMP%]     .ant-tree{position:static!important}nz-content[_ngcontent-%COMP%]{flex:1!important}.synopsis-text[_ngcontent-%COMP%]{width:100%;display:-webkit-box!important;word-break:break-all;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}  .no-scoll .ant-table-body{overflow:hidden!important}[_nghost-%COMP%]     .table-container{height:calc(100% - 116px)!important}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{display:flex;align-items:baseline}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{flex:1;display:flex}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-title[_ngcontent-%COMP%]{min-width:85px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-input[_ngcontent-%COMP%]{flex:1}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:300px}[_nghost-%COMP%]     .ant-tree-title{max-width:200px;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"]}),Object(a.b)([Object(g.b)({title:"\u6848\u4f8b\u590d\u5236",content:function(e){return"\u60a8\u786e\u5b9a\u590d\u5236"+e[0].title+"\u6848\u4f8b\u5417\uff1f"},type:"confirm"})],ke.prototype,"copy",null),Object(a.b)([Object(g.b)({title:function(e){return'\u786e\u5b9a\u5220\u9664"'.concat(e[0].title,'"\u7684\u6848\u4f8b\u8d44\u6e90\uff1f')},content:"",type:"warning"})],ke.prototype,"del",null),ke),Me=n("3JH+"),xe=n("ifs9"),Se=n("4tR+"),Ee=n("9VW+"),Te=n.n(Ee),Ie=n("mhyn"),Ze=n("Wc2E"),Le=n("ocnv"),Re=n("qAZ0"),De=n("zioG"),Ne=n("f3RM"),je=["treeContainer"],Ae=["treeknowledge"],Fe=["background"],Ue=["analysis"],Ve=["guide"];function qe(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u8d44\u6e90\u6807\u9898\u4e0d\u80fd\u8d85\u8fc730\u4e2a\u5b57"),r.Xb())}function Be(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u8d44\u6e90\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a"),r.Xb())}function Ge(e,t){if(1&e&&(r.Nc(0,qe,2,0,"ng-container",53),r.Nc(1,Be,2,0,"ng-container",53)),2&e){var n=t.$implicit;r.tc("ngIf",n.hasError("maxlength")),r.Eb(1),r.tc("ngIf",n.hasError("required"))}}function Xe(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u4f5c\u8005\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc730\u4e2a\u5b57"),r.Xb())}function We(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u4f5c\u8005\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"),r.Xb())}function $e(e,t){if(1&e&&(r.Nc(0,Xe,2,0,"ng-container",53),r.Nc(1,We,2,0,"ng-container",53)),2&e){var n=t.$implicit;r.tc("ngIf",n.hasError("maxlength")),r.Eb(1),r.tc("ngIf",n.hasError("required"))}}function He(e,t){if(1&e&&r.Vb(0,"nz-option",54),2&e){var n=t.$implicit;r.tc("nzValue",n.id)("nzLabel",n.name)}}var Ke,Qe=function(e){return{visibility:e}},Je=((Ke=function(){function e(t,n,i,o,a,r,s,l,d,u){_classCallCheck(this,e),this.message=t,this.materialLibService=n,this.fb=i,this.route=o,this.menuService=a,this.modalService=r,this.uploadOssService=s,this.renderer2=l,this.win=d,this.doc=u,this.wid=-1,this.professionId="",this.knowledgePointIds=[],this.title="",this.id="",this.coursewareType="",this.isEdit=!1,this.learnTargetArr=c.f,this.ktype=1,this.minType=5,this.defaultTreeKey=[],this.dailDown0=!1,this.dailDown1=!1,this.dailDown2=!1,this.dailDownMove={0:{isDown:!1,leftCha:0,topCha:0,init:!1},1:{isDown:!1,leftCha:0,topCha:0,init:!1},2:{isDown:!1,leftCha:0,topCha:0,init:!1}},this.Editor=Te.a,this.isBackgroundLoading=!1,this.isGuideLoading=!1,this.isAnalysisLoading=!1,this.backgroundConfig=Object.assign({},c.d,this.getImgVideoReosolver("isBackgroundLoading")),this.analysisConfig=Object.assign({},c.d,this.getImgVideoReosolver("isAnalysisLoading")),this.guideConfig=Object.assign({},c.d,this.getImgVideoReosolver("isGuideLoading")),this.current=0,this.dom={},this.domEdit={},this.domContainer={},this.domIcon={},this.domIconOut={},this.domMoveHandler={},this.percent=100,this.saveLoading=!1,this.orgCode=h.a.getOrgCode(),this.win.that=this}return _createClass(e,[{key:"ngOnInit",value:function(){this.initParam(),this.initializeData()}},{key:"ngAfterViewInit",value:function(){var e=this;Object(d.a)(1e3).subscribe((function(){e.win.addEventListener("mousemove",e.nailMove)}))}},{key:"ngOnDestroy",value:function(){var e=this;this.win.removeEventListener("mousemove",this.nailMove),Object.keys(this.domMoveHandler).forEach((function(t){e.domMoveHandler[t].removeEventListener("mousemove",e.startMove),e.domMoveHandler[t].removeEventListener("mouseup",e.endMove)}))}},{key:"initParam",value:function(){var e=this.route.snapshot.paramMap;this.id=e.get("id"),this.coursewareType=e.get("type"),this.professionId=e.get("professionId")}},{key:"percentReport",value:function(e){this.percent=e}},{key:"initializeData",value:function(){var e=this;this.initializeForm({}),"0"===this.id?(this.isEdit=!1,this.title="\u65b0\u589e"+Object(c.k)(this.coursewareType,"MATERIAL_TYPE")):(this.isEdit=!0,this.title="\u7f16\u8f91"+Object(c.k)(this.coursewareType,"MATERIAL_TYPE"),this.materialLibService.getResourceDetail(this.id,this.coursewareType).subscribe((function(t){200===t.status&&e.initializeForm(t.data)}),(function(t){e.message.warning(JSON.stringify(t))})))}},{key:"getContentLength",value:function(e){return e.replace(/<[^>]+>/g,"").replace(/&nbsp;/g,"a").replace(/\s/g,"a").replace(/[\u0391-\uFFE5]/g,"a").length}},{key:"mouseDownLabel",value:function(){this.dailDownMove[this.current].init||(this.dailDownMove[this.current].init=!0,this.domMoveHandler[this.current].addEventListener("mousedown",this.startMove),this.domMoveHandler[this.current].addEventListener("mouseup",this.endMove))}},{key:"endMove",value:function(e){var t=this.that;t.dailDownMove[t.current].isDown=!1}},{key:"startMove",value:function(e){var t=this.that,n=t.domEdit[t.current];if(t["dailDown"+t.current]){var i=e||t.win.event;t.dailDownMove[t.current].leftCha=i.clientX-n.offsetLeft,t.dailDownMove[t.current].topCha=i.clientY-n.offsetTop,t.dailDownMove[t.current].isDown=!0}}},{key:"nailDown",value:function(e){this.current=e,this.dom[e]||(this.dom[e]=this.doc.getElementById("editor"+e),this.domEdit[e]=this.dom[e].querySelectorAll(" .ck-editor__top.ck-reset_all")[0],this.domContainer[e]=this.dom[e].querySelectorAll(".ck.ck-editor__main")[0],this.domIcon[e]=this.doc.getElementById("editor-icon"+e),this.domIconOut[e]=this.doc.getElementById("editor-icon-out"+e),this.domMoveHandler[e]=this.doc.getElementById("moveHandler"+e),this.domEdit[e].that=this,this.domMoveHandler[e].that=this),this.mouseDownLabel(),this["dailDown"+e]=!this["dailDown"+e],this["dailDown"+e]?this.fixStyles(e):this.resetStyle(e)}},{key:"fixStyles",value:function(e){this.renderer2.setStyle(this.domContainer[e],"margin-top",this.domEdit[e].offsetHeight+"px"),this.renderer2.setStyle(this.domEdit[e],"border-bottom","1px solid #ccc"),this.fixStyle(this.domIcon[e]),this.fixStyle(this.domIconOut[e]),this.fixStyle(this.domEdit[e]),this.fixStyle(this.domMoveHandler[e])}},{key:"resetStyle",value:function(e){var t=this.renderer2;t.removeAttribute(this.domContainer[e],"style"),t.removeAttribute(this.domIconOut[e],"style"),t.removeAttribute(this.domIcon[e],"style"),t.removeAttribute(this.domEdit[e],"style"),t.removeAttribute(this.domMoveHandler[e],"style")}},{key:"nailMove",value:function(e){var t=window.that,n=e||t.win.event;Object.keys(t.dailDownMove).every((function(e,i){if(!t.dailDownMove[e].isDown)return!0;var o=t.doc.getElementById("editor"+i).querySelectorAll(" .ck-editor__top.ck-reset_all")[0],a=t.doc.getElementById("editor-icon"+i),r=t.doc.getElementById("editor-icon-out"+i),c=t.doc.getElementById("moveHandler"+i);[a,r,o,c].forEach((function(i,a){2===a?(i.style.left=n.clientX-t.dailDownMove[e].leftCha+"px",i.style.top=n.clientY-t.dailDownMove[e].topCha+"px"):3===a?(i.style.left=n.clientX-t.dailDownMove[e].leftCha+o.offsetWidth/2-t.domMoveHandler[e].offsetWidth/2+"px",i.style.top=n.clientY-t.dailDownMove[e].topCha-17+"px"):(i.style.left=n.clientX-t.dailDownMove[e].leftCha+o.offsetWidth+"px",i.style.top=n.clientY-t.dailDownMove[e].topCha+"px")}))}))}},{key:"fixStyle",value:function(e){var t=e.offsetWidth+"px",n=e.getBoundingClientRect().top+"px",i=e.getBoundingClientRect().left+"px",o=this.renderer2;o.setStyle(e,"position","fixed"),o.setStyle(e,"background","white"),o.setStyle(e,"z-index","999"),o.setStyle(e,"width",t),o.setStyle(e,"top",n),o.setStyle(e,"left",i),o.setStyle(e,"transform","inherit")}},{key:"getImgVideoReosolver",value:function(e){return{videoUpload:this.getResolver(e),imageUpload:this.getResolver(e)}}},{key:"getResolver",value:function(e){var t=this;return function(n){return t[e]=!0,new Promise((function(i,o){t.uploadOssService.uploadOss(n,Se.a.editor).subscribe((function(n){t[e]=!1,n?i({url:f.a.OSS_URL+n}):t.message.warning("\u4e0a\u4f20\u5931\u8d25")}),(function(n){t[e]=!1,t.message.warning("\u4e0a\u4f20\u5931\u8d25"),o(n)}))}))}}},{key:"onResize",value:function(e){var t=this,n=e.width,i=this.treeContainer&&this.treeContainer.nativeElement&&this.treeContainer.nativeElement.offsetWidth;i&&this.treeContainer.nativeElement.offsetWidth+80<n||i&&this.treeContainer.nativeElement.offsetWidth+10>n||(cancelAnimationFrame(this.wid),this.wid=requestAnimationFrame((function(){t.width=n})))}},{key:"initializeForm",value:function(e){var t=this.coursewareType,n=this.isEdit,i=e.id,o=e.title,a=e.learningGoalCode,r=e.background,c=e.guide,s=e.analysis,l=e.attachment,d=e.authorName;this.validateForm=this.fb.group({id:[n?i:""],points:[[]],type:[t],coursewareType:[t],title:[n?o:"",[S.w.required,Object(Me.b)(),S.w.maxLength(30)]],learningGoalCode:[n?a:"",[S.w.required]],background:[n?r:"",[S.w.required]],guide:[n?c:""],analysis:[n?s:""],caseAttanmentArr:[n?l.map((function(e){return{name:e.attachmentName,path:e.attachmentPath,title:e.attachmentName}})):[]],authorName:[n?d:"zksd"===this.orgCode?"\u8003\u62c9\u65e5\u8bb0":"\u6052\u4f01\u6559\u80b2",[S.w.required,Object(Me.b)(),S.w.maxLength(30)]]}),n&&e.resourcePoints[0].knowledgePointId&&(this.knowledgePointIds=this.defaultTreeKey=e.resourcePoints.map((function(e){return e.knowledgePointId})))}},{key:"submitForm",value:function(){var e=this,t=this.validateForm.value,n=t.background,i=t.analysis,o=t.guide;for(var a in this.validateForm.controls)this.validateForm.controls[a].markAsDirty(),this.validateForm.controls[a].updateValueAndValidity();if(this.validateForm.invalid)this.message.warning("\u8bf7\u6309\u89c4\u5219\u586b\u5199\u6240\u6709\u5fc5\u586b\u9879");else if(this.getContentLength(n)>5e3)this.message.warning("\u6848\u4f8b\u80cc\u666f\u5df2\u8d85\u51fa\u9650\u5236");else if(this.getContentLength(i)>5e3)this.message.warning("\u6848\u4f8b\u89e3\u6790\u5df2\u8d85\u51fa\u9650\u5236");else if(this.getContentLength(o)>5e3)this.message.warning("\u6559\u5b66\u6307\u5bfc\u5185\u5bb9\u5df2\u8d85\u51fa\u9650\u5236");else{var r=JSON.parse(JSON.stringify(this.validateForm.value));this.knowledgePointIds.length?(r.pointType=1,r.points=this.knowledgePointIds.map((function(e){return e}))):(r.pointType=2,r.points=[this.treeknowledge.nodes[0].id]);var c=r.caseAttanmentArr.map((function(e){return{attachmentName:e.name,attachmentPath:e.path,aattachmentExt:h.a.getExt(e.path),attachmentType:12}}));r.attachments=_toConsumableArray(c),delete r.caseAttanmentArr,5===this.minType&&0===this.knowledgePointIds.length?this.modalService.warning({nzTitle:"\u672a\u9009\u62e9\u77e5\u8bc6\u70b9\u8d44\u6599\u5c06\u6302\u5230\u8bfe\u7a0b\uff0c\u786e\u5b9a\u5417\uff1f",nzCancelText:"\u53d6\u6d88",nzOkText:"\u786e\u5b9a",nzOnOk:function(){return e.savaRecourse(r)}}):2===r.pointType?this.modalService.warning({nzTitle:"\u9009\u62e9\u7684\u8282\u70b9\u672a\u5305\u542b\u77e5\u8bc6\u70b9\uff0c\u8d44\u6599\u5c06\u6302\u5230\u8bfe\u7a0b\uff0c\u786e\u5b9a\u5417\uff1f",nzCancelText:"\u53d6\u6d88",nzOkText:"\u786e\u5b9a",nzOnOk:function(){return e.savaRecourse(r)}}):this.savaRecourse(r)}}},{key:"savaRecourse",value:function(e){var t=this;return new Promise((function(n){t.saveLoading=!0,t.materialLibService.saveCase(e).subscribe((function(e){t.saveLoading=!1,201===e.status?(n(!0),t.goBack()):(500===e.status&&t.message.error("\u670d\u52a1\u5668\u4e1a\u52a1\u5f02\u5e38"),n(!1))}),(function(e){n(!1),t.saveLoading=!1,t.message.error(JSON.stringify(e))}))}))}},{key:"nodeChange",value:function(e){this.knowledgePointIds=this.getCheckedLeafKey(e);var t={minType:5};this.getMinLavel(e,t),this.minType=t.minType}},{key:"getMinLavel",value:function(e,t){var n=this;e.length&&e.forEach((function(e){e.origin&&e.origin.children&&e.origin.children.length&&n.getMinLavel(e.children,t),t.minType>e.origin.kType&&(t.minType=e.origin.kType)}))}},{key:"getCheckedLeafKey",value:function(e){var t=[];return function e(n){for(var i=0;i<n.length;i++){var o=n[i]instanceof xe.d?n[i].origin:n[i];o.children&&o.children.length>0?e(o.children):o.isLeaf&&o.checked&&"4"===o.kType&&t.push(o.id)}}(e),t}},{key:"goBack",value:function(){this.menuService.goBack(!1),this.menuService.gotoUrl({url:"/m/rm/case",paramUrl:"",title:"\u6848\u4f8b\u5e93"})}},{key:"stopPropagation",value:function(e){if(13===e.keyCode)return e.stopPropagation(),!1}}]),e}()).\u0275fac=function(e){return new(e||Ke)(r.Ub(v.e),r.Ub(p.a),r.Ub(S.d),r.Ub(o.a),r.Ub(b.a),r.Ub(m.e),r.Ub(Ze.a),r.Ub(r.E),r.Ub(Ie.b),r.Ub(z.d))},Ke.\u0275cmp=r.Ob({type:Ke,selectors:[["app-material-case"]],viewQuery:function(e,t){var n;1&e&&(r.Vc(je,!0),r.Vc(Ae,!0),r.Kc(Fe,!0),r.Kc(Ue,!0),r.Kc(Ve,!0)),2&e&&(r.Bc(n=r.jc())&&(t.treeContainer=n.first),r.Bc(n=r.jc())&&(t.treeknowledge=n.first),r.Bc(n=r.jc())&&(t.background=n.first),r.Bc(n=r.jc())&&(t.analysis=n.first),r.Bc(n=r.jc())&&(t.guide=n.first))},decls:91,vars:92,consts:[[1,"container"],[1,"resource-container"],["nz-resizable","",1,"left-tree",3,"nzResize"],[2,"margin-bottom","15px","font-size","15px"],[2,"display","inline-block","overflow","hidden","margin-right","30px"],["treeContainer",""],["model","check",3,"professionId","defaultCheckedKeys","fullNode","allNodes","nodeChange"],["treeknowledge",""],["nzDirection","right"],[1,"right-wrap"],["nz-icon","","nzType","more","nzTheme","outline",1,"right"],[1,"right-resource"],[1,"right-title"],["nz-form","",1,"case-form",3,"formGroup"],["nzRequired","","nzFor","title",2,"text-align","left","max-width","100px",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzErrorTip"],["nz-input","","formControlName","title","id","title","placeholder","\u8bf7\u8f93\u5165\u6807\u9898...",2,"width","calc(100% - 80px)",3,"keyup.enter","keydown"],[2,"margin-left","10px"],["titleTpl",""],["nz-row",""],["nz-col","","nzSpan","15"],["nzHasFeedback","",3,"nzSm","nzXs","nzErrorTip"],["nz-input","","formControlName","authorName","placeholder","\u8bf7\u8f93\u5165\u4f5c\u8005\u540d\u79f0...",2,"width","calc(100% - 80px)",3,"keyup.enter"],["nz-col","","nzSpan","12"],["nzRequired","",2,"text-align","left","max-width","100px",3,"nzSm","nzXs"],["nzErrorTip","\u8bf7\u9009\u62e9\u5b66\u4e60\u76ee\u6807",3,"nzSm","nzXs"],["formControlName","learningGoalCode","nzAllowClear","","nzPlaceHolder","\u8bf7\u9009\u62e9\u5b66\u4e60\u76ee\u6807"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzErrorTip","\u6848\u4f8b\u80cc\u666f\u4e0d\u80fd\u4e3a\u7a7a",2,"max-width","calc(100% - 150px)","position","relative",3,"nzSm","nzXs"],["nzTip","\u6587\u4ef6\u4e0a\u4f20\u4e2d...",3,"nzSpinning","nzDelay"],["placeholder","\u8bf7\u8f93\u5165\u6848\u4f8b\u80cc\u666f\u5185\u5bb9","formControlName","background","id","editor0",3,"editor","config"],[2,"float","right"],["nz-icon","","nzType","drag","nzTheme","outline","id","moveHandler0",1,"move-handler",3,"ngStyle"],["nz-icon","","nzType","login","id","editor-icon0","nzTheme","outline","nz-tooltip","","nzTooltipTitle","\u9489\u4f4f\u62d6\u52a8",1,"editor-icon",2,"vertical-align","top",3,"ngStyle","click"],["nz-icon","","nzType","logout","id","editor-icon-out0","nzTheme","outline","nz-tooltip","","nzTooltipTitle","\u56de\u5230\u521d\u59cb\u4f4d\u7f6e",1,"editor-icon",2,"vertical-align","top",3,"ngStyle","click"],[2,"text-align","left","max-width","100px",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid E-mail!","nzExtra","\u4ec5\u96504\u4e2a\uff0c\u652f\u6301\u6269\u5c55\u540d\uff1apdf \u3001doc \u3001docx \u3001xls \u3001xlsx \u3001ppt \u3001pptx \u3001png \u3001jpg \u3001jpeg \u3001mp4 \u3001zip \u3001rar",3,"nzSm","nzXs"],["listType","text","acceptType","pdf ,doc ,docx ,xls ,xlsx ,ppt ,pptx ,png ,jpg ,jpeg ,mp4 ,zip ,rar","limit","4","formControlName","caseAttanmentArr",3,"multiple","percentReport"],["nz-button",""],["nz-icon","","nzType","upload"],[2,"max-width","calc(100% - 150px)","position","relative",3,"nzSm","nzXs"],["placeholder","\u8bf7\u8f93\u5165\u6848\u4f8b\u89e3\u6790","id","editor1","formControlName","analysis",3,"editor","config"],["nz-icon","","nzType","drag","nzTheme","outline","id","moveHandler1",1,"move-handler",3,"ngStyle"],["nz-icon","","nzType","login","id","editor-icon1","nzTheme","outline","nz-tooltip","","nzTooltipTitle","\u9489\u4f4f\u62d6\u52a8",1,"editor-icon",2,"vertical-align","top",3,"ngStyle","click"],["nz-icon","","nzType","logout","id","editor-icon-out1","nzTheme","outline","nz-tooltip","","nzTooltipTitle","\u56de\u5230\u521d\u59cb\u4f4d\u7f6e",1,"editor-icon",2,"vertical-align","top",3,"ngStyle","click"],[2,"margin-top","40px"],["placeholder","\u8bf7\u8f93\u5165\u6559\u5b66\u6307\u5bfc","id","editor2","formControlName","guide",3,"editor","config"],["nz-icon","","nzType","drag","nzTheme","outline","id","moveHandler2",1,"move-handler",3,"ngStyle"],["nz-icon","","nzType","login","id","editor-icon2","nzTheme","outline","nz-tooltip","","nzTooltipTitle","\u9489\u4f4f\u62d6\u52a8",1,"editor-icon",2,"vertical-align","top",3,"ngStyle","click"],["nz-icon","","nzType","logout","id","editor-icon-out2","nzTheme","outline","nz-tooltip","","nzTooltipTitle","\u56de\u5230\u521d\u59cb\u4f4d\u7f6e",1,"editor-icon",2,"vertical-align","top",3,"ngStyle","click"],[1,"submit-footer"],["nz-button","","nzType","default",2,"margin-right","20px",3,"click"],["nz-button","","nzType","primary",3,"disabled","nzLoading","click"],[4,"ngIf"],[3,"nzValue","nzLabel"]],template:function(e,t){if(1&e&&(r.ac(0,"div",0),r.ac(1,"section",1),r.ac(2,"section",2),r.ic("nzResize",(function(e){return t.onResize(e)})),r.ac(3,"p",3),r.Pc(4," \u9009\u62e9\u77e5\u8bc6\u70b9(\u4e0d\u652f\u6301\u8de8\u5b66\u79d1\u77e5\u8bc6\u70b9)"),r.Zb(),r.ac(5,"div",4,5),r.ac(7,"qkc-tree-knowledgegraph",6,7),r.ic("nodeChange",(function(e){return t.nodeChange(e)})),r.Zb(),r.Zb(),r.ac(9,"nz-resize-handle",8),r.ac(10,"div",9),r.Vb(11,"i",10),r.Zb(),r.Zb(),r.Zb(),r.ac(12,"section",11),r.ac(13,"p",12),r.Pc(14),r.Zb(),r.ac(15,"form",13),r.ac(16,"nz-form-item"),r.ac(17,"nz-form-label",14),r.Pc(18,"\u8d44\u6e90\u6807\u9898 "),r.Zb(),r.ac(19,"nz-form-control",15),r.ac(20,"input",16),r.ic("keyup.enter",(function(){return t.submitForm()}))("keydown",(function(e){return t.stopPropagation(e)})),r.Zb(),r.ac(21,"span",17),r.Pc(22),r.Zb(),r.Nc(23,Ge,2,2,"ng-template",null,18,r.Oc),r.Zb(),r.Zb(),r.ac(25,"div",19),r.ac(26,"div",20),r.ac(27,"nz-form-item"),r.ac(28,"nz-form-label",14),r.Pc(29,"\u4f5c\u8005\u540d\u79f0 "),r.Zb(),r.ac(30,"nz-form-control",21),r.ac(31,"input",22),r.ic("keyup.enter",(function(){return t.submitForm()})),r.Zb(),r.ac(32,"span",17),r.Pc(33),r.Zb(),r.Nc(34,$e,2,2,"ng-template",null,18,r.Oc),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.ac(36,"div",19),r.ac(37,"div",23),r.ac(38,"nz-form-item"),r.ac(39,"nz-form-label",24),r.Pc(40,"\u5b66\u4e60\u76ee\u6807 "),r.Zb(),r.ac(41,"nz-form-control",25),r.ac(42,"nz-select",26),r.Nc(43,He,1,2,"nz-option",27),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.ac(44,"nz-form-item"),r.ac(45,"nz-form-label",24),r.Pc(46,"\u6848\u4f8b\u80cc\u666f "),r.Zb(),r.ac(47,"nz-form-control",28),r.ac(48,"nz-spin",29),r.Vb(49,"ckeditor",30),r.ac(50,"span",31),r.Pc(51),r.Zb(),r.Zb(),r.Vb(52,"i",32),r.Zb(),r.ac(53,"i",33),r.ic("click",(function(){return t.nailDown(0)})),r.Zb(),r.ac(54,"i",34),r.ic("click",(function(){return t.nailDown(0)})),r.Zb(),r.Zb(),r.ac(55,"nz-form-item"),r.ac(56,"nz-form-label",35),r.Pc(57,"\u6848\u4f8b\u9644\u4ef6"),r.Zb(),r.ac(58,"nz-form-control",36),r.ac(59,"qkc-upload",37),r.ic("percentReport",(function(e){return t.percentReport(e)})),r.ac(60,"button",38),r.Vb(61,"i",39),r.ac(62,"span"),r.Pc(63,"\u4e0a\u4f20\u6587\u4ef6"),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.ac(64,"nz-form-item"),r.ac(65,"nz-form-label",35),r.Pc(66,"\u6848\u4f8b\u89e3\u6790 "),r.Zb(),r.ac(67,"nz-form-control",40),r.ac(68,"nz-spin",29),r.Vb(69,"ckeditor",41),r.ac(70,"span",31),r.Pc(71),r.Zb(),r.Zb(),r.Vb(72,"i",42),r.Zb(),r.ac(73,"i",43),r.ic("click",(function(){return t.nailDown(1)})),r.Zb(),r.ac(74,"i",44),r.ic("click",(function(){return t.nailDown(1)})),r.Zb(),r.Zb(),r.ac(75,"nz-form-item",45),r.ac(76,"nz-form-label",35),r.Pc(77,"\u6559\u5b66\u6307\u5bfc "),r.Zb(),r.ac(78,"nz-form-control",40),r.ac(79,"nz-spin",29),r.Vb(80,"ckeditor",46),r.ac(81,"span",31),r.Pc(82),r.Zb(),r.Zb(),r.Vb(83,"i",47),r.Zb(),r.ac(84,"i",48),r.ic("click",(function(){return t.nailDown(2)})),r.Zb(),r.ac(85,"i",49),r.ic("click",(function(){return t.nailDown(2)})),r.Zb(),r.Zb(),r.Zb(),r.ac(86,"div",50),r.ac(87,"button",51),r.ic("click",(function(){return t.goBack()})),r.Pc(88,"\u8fd4\u56de "),r.Zb(),r.ac(89,"button",52),r.ic("click",(function(){return t.submitForm()})),r.Pc(90,"\u4fdd\u5b58"),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb()),2&e){var n=r.Cc(24);r.Eb(2),r.Mc("width",t.width,"px"),r.Eb(5),r.tc("professionId",t.professionId)("defaultCheckedKeys",t.defaultTreeKey)("fullNode",!0)("allNodes",!0),r.Eb(7),r.Qc(t.title),r.Eb(1),r.tc("formGroup",t.validateForm),r.Eb(2),r.tc("nzSm",3)("nzXs",24),r.Eb(2),r.tc("nzSm",21)("nzXs",24)("nzErrorTip",n),r.Eb(3),r.Rc("",t.validateForm.value.title.length,"/30"),r.Eb(6),r.tc("nzSm",6)("nzXs",24),r.Eb(2),r.tc("nzSm",18)("nzXs",24)("nzErrorTip",n),r.Eb(3),r.Rc("",null==t.validateForm.value.authorName?null:t.validateForm.value.authorName.length,"/30"),r.Eb(6),r.tc("nzSm",6)("nzXs",24),r.Eb(2),r.tc("nzSm",18)("nzXs",24),r.Eb(2),r.tc("ngForOf",t.learnTargetArr),r.Eb(2),r.tc("nzSm",3)("nzXs",24),r.Eb(2),r.tc("nzSm",21)("nzXs",24),r.Eb(1),r.tc("nzSpinning",t.isBackgroundLoading)("nzDelay",0),r.Eb(1),r.tc("editor",t.Editor)("config",t.backgroundConfig),r.Eb(1),r.Mc("color",t.getContentLength(t.validateForm.value.background)<5e3?"rgb(95, 95, 95)":"red"),r.Eb(1),r.Rc("",t.getContentLength(t.validateForm.value.background)," /5000"),r.Eb(1),r.tc("ngStyle",r.xc(74,Qe,t.dailDown0?"visible":"hidden")),r.Eb(1),r.tc("ngStyle",r.xc(76,Qe,t.dailDown0?"hidden":"visible")),r.Eb(1),r.tc("ngStyle",r.xc(78,Qe,t.dailDown0?"visible":"hidden")),r.Eb(2),r.tc("nzSm",3)("nzXs",24),r.Eb(2),r.tc("nzSm",21)("nzXs",24),r.Eb(1),r.tc("multiple",!0),r.Eb(6),r.tc("nzSm",3)("nzXs",24),r.Eb(2),r.tc("nzSm",21)("nzXs",24),r.Eb(1),r.tc("nzSpinning",t.isAnalysisLoading)("nzDelay",0),r.Eb(1),r.tc("editor",t.Editor)("config",t.analysisConfig),r.Eb(1),r.Mc("color",t.getContentLength(t.validateForm.value.analysis)<5e3?"rgb(95, 95, 95)":"red"),r.Eb(1),r.Rc("",t.getContentLength(t.validateForm.value.analysis)," /5000"),r.Eb(1),r.tc("ngStyle",r.xc(80,Qe,t.dailDown1?"visible":"hidden")),r.Eb(1),r.tc("ngStyle",r.xc(82,Qe,t.dailDown1?"hidden":"visible")),r.Eb(1),r.tc("ngStyle",r.xc(84,Qe,t.dailDown1?"visible":"hidden")),r.Eb(2),r.tc("nzSm",3)("nzXs",24),r.Eb(2),r.tc("nzSm",21)("nzXs",24),r.Eb(1),r.tc("nzSpinning",t.isGuideLoading)("nzDelay",0),r.Eb(1),r.tc("editor",t.Editor)("config",t.guideConfig),r.Eb(1),r.Mc("color",t.getContentLength(t.validateForm.value.guide)<5e3?"rgb(95, 95, 95)":"red"),r.Eb(1),r.Rc("",t.getContentLength(t.validateForm.value.guide)," /5000"),r.Eb(1),r.tc("ngStyle",r.xc(86,Qe,t.dailDown2?"visible":"hidden")),r.Eb(1),r.tc("ngStyle",r.xc(88,Qe,t.dailDown2?"hidden":"visible")),r.Eb(1),r.tc("ngStyle",r.xc(90,Qe,t.dailDown2?"visible":"hidden")),r.Eb(4),r.tc("disabled",100!==t.percent||null)("nzLoading",t.saveLoading)}},directives:[O.a,R.a,O.c,_.a,M.a,S.y,S.p,Le.b,S.i,w.c,Le.c,w.a,Le.d,Le.a,x.b,S.c,S.o,S.g,E.d,z.m,Re.a,De.a,z.o,D.d,Ne.a,T.a,I.a,z.n,E.a],styles:[".margin-btn[_ngcontent-%COMP%]{margin-left:15px}.light-color[_ngcontent-%COMP%]{color:red}.container[_ngcontent-%COMP%]{background-color:#fff;padding:10px;height:100%}.container[_ngcontent-%COMP%]   .editor-icon[_ngcontent-%COMP%]{cursor:pointer}.container[_ngcontent-%COMP%]   .move-handler[_ngcontent-%COMP%]{position:absolute;top:-17px;left:50%;transform:translateX(-50%);font-size:17px;cursor:move;color:#777;border-bottom:1px solid #c4c4c4}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:500}.resource-container[_ngcontent-%COMP%]{height:100%;overflow:hidden;display:flex;position:relative}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]{min-width:200px;overflow-y:auto;overflow-x:hidden}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right-wrap[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;text-align:center;font-size:12px;height:20px;line-height:20px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]{position:relative;padding-left:30px;height:100%;flex:1;border-left:1px solid #ddd;overflow-x:hidden;overflow-y:auto}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .right-title[_ngcontent-%COMP%]{font-size:18px;margin-bottom:15px;position:absolute;top:0;left:26px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .case-form[_ngcontent-%COMP%]{height:calc(100% - 88px);margin-top:44px}.source-header[_ngcontent-%COMP%]{font-weight:bolder}.submit-footer[_ngcontent-%COMP%]{position:absolute;top:0;right:0;text-align:center}[_nghost-%COMP%]     .ant-tree-title{max-width:200px;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"]}),Ke),Ye=n("bE2y"),et=["treeContainer"],tt=["treeknowledge"],nt=function(){return{"max-width":"800px"}};function it(e,t){if(1&e&&r.Vb(0,"i",44),2&e){r.lc();var n=r.Cc(17);r.tc("nzTooltipTitle",n)("nzTooltipOverlayStyle",r.wc(2,nt))}}function ot(e,t){1&e&&(r.ac(0,"div"),r.Pc(1,"1\u3001\u5efa\u8bae\u4f18\u5148WPS\u5236\u4f5cPPT\uff1b"),r.Zb(),r.ac(2,"div"),r.Pc(3,"2\u3001\u5c3d\u91cf\u5c11\u7528\u7b2c\u4e09\u6a21\u677f\uff1b"),r.Zb(),r.ac(4,"div"),r.Pc(5,"3\u3001PPT\u7684\u6587\u4ef6\u5927\u5c0f\u5e94\u63a7\u5236\u5728100M\u4e4b\u5185"),r.Zb())}var at=function(){return{standalone:!0}};function rt(e,t){if(1&e){var n=r.bc();r.ac(0,"div",17),r.ac(1,"div",18),r.ac(2,"nz-form-item"),r.ac(3,"nz-form-label",45),r.Pc(4,"\u521b\u5efa\u4eba "),r.Zb(),r.ac(5,"nz-form-control",46),r.ac(6,"input",47),r.ic("ngModelChange",(function(e){return r.Ec(n),r.lc().createrName=e})),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb()}if(2&e){var i=r.lc();r.Eb(3),r.tc("nzSm",6)("nzXs",24),r.Eb(2),r.tc("nzSm",18)("nzXs",24),r.Eb(1),r.tc("ngModel",i.createrName)("ngModelOptions",r.wc(7,at))("disabled",!0)}}function ct(e,t){if(1&e&&r.Vb(0,"nz-option",48),2&e){var n=t.$implicit;r.tc("nzValue",n.id)("nzLabel",n.name)}}function st(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u8d44\u6e90\u6807\u9898\u4e0d\u80fd\u8d85\u8fc730\u4e2a\u5b57"),r.Xb())}function lt(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u8d44\u6e90\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a"),r.Xb())}function dt(e,t){if(1&e&&(r.Nc(0,st,2,0,"ng-container",50),r.Nc(1,lt,2,0,"ng-container",50)),2&e){var n=t.$implicit;r.tc("ngIf",n.hasError("maxlength")),r.Eb(1),r.tc("ngIf",n.hasError("required"))}}function ut(e,t){if(1&e){var n=r.bc();r.ac(0,"div",18),r.ac(1,"nz-form-item"),r.ac(2,"nz-form-label",32),r.Pc(3,"\u8d44\u6e90\u6807\u9898 "),r.Zb(),r.ac(4,"nz-form-control",33),r.ac(5,"input",49),r.ic("keyup.enter",(function(){return r.Ec(n),r.lc().submitForm()})),r.Zb(),r.ac(6,"span",35),r.Pc(7),r.Zb(),r.Nc(8,dt,2,2,"ng-template",null,36,r.Oc),r.Zb(),r.Zb(),r.Zb()}if(2&e){var i=r.Cc(9),o=r.lc();r.Eb(2),r.tc("nzSm",6)("nzXs",24),r.Eb(2),r.tc("nzSm",18)("nzXs",24)("nzErrorTip",i),r.Eb(3),r.Rc("",null==o.validateForm.value.title?null:o.validateForm.value.title.length,"/30")}}function ht(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u4f5c\u8005\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc730\u4e2a\u5b57"),r.Xb())}function gt(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u4f5c\u8005\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"),r.Xb())}function ft(e,t){if(1&e&&(r.Nc(0,ht,2,0,"ng-container",50),r.Nc(1,gt,2,0,"ng-container",50)),2&e){var n=t.$implicit;r.tc("ngIf",n.hasError("maxlength")),r.Eb(1),r.tc("ngIf",n.hasError("required"))}}function pt(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u6c34\u5370\u6587\u5b57\u4e0d\u80fd\u8d85\u8fc730\u4e2a\u5b57"),r.Xb())}function bt(e,t){1&e&&(r.Yb(0),r.Pc(1,"\u6c34\u5370\u6587\u5b57\u4e0d\u80fd\u4e3a\u7a7a"),r.Xb())}function mt(e,t){if(1&e&&(r.Nc(0,pt,2,0,"ng-container",50),r.Nc(1,bt,2,0,"ng-container",50)),2&e){var n=t.$implicit;r.tc("ngIf",n.hasError("maxlength")),r.Eb(1),r.tc("ngIf",n.hasError("required"))}}function vt(e,t){if(1&e){var n=r.bc();r.ac(0,"div",17),r.ac(1,"div",18),r.ac(2,"nz-form-item"),r.ac(3,"nz-form-label",32),r.Pc(4,"\u6c34\u5370\u6587\u5b57 "),r.Zb(),r.ac(5,"nz-form-control",33),r.ac(6,"input",51),r.ic("keyup.enter",(function(){return r.Ec(n),r.lc().submitForm()})),r.Zb(),r.ac(7,"span",35),r.Pc(8),r.Zb(),r.Nc(9,mt,2,2,"ng-template",null,36,r.Oc),r.Zb(),r.Zb(),r.Zb(),r.Zb()}if(2&e){var i=r.Cc(10),o=r.lc();r.Eb(3),r.tc("nzSm",6)("nzXs",24),r.Eb(2),r.tc("nzSm",18)("nzXs",24)("nzErrorTip",i),r.Eb(3),r.Rc("",null==o.validateForm.value.watermarkText?null:o.validateForm.value.watermarkText.length,"/30")}}var yt,Ct=((yt=function(){function e(t,n,i,o,a,r){_classCallCheck(this,e),this.message=t,this.materialLibService=n,this.menuService=i,this.fb=o,this.route=a,this.modalService=r,this.wid=-1,this.professionId="",this.knowledgePointIds=[],this.title="",this.id="",this.coursewareType="",this.isEdit=!1,this.learnTargetArr=c.f,this.isSaveLoading=!1,this.defaultTreeKey=[],this.minType=5,this.createrName="",this.code="",this.orgCode=h.a.getOrgCode()}return _createClass(e,[{key:"ngOnInit",value:function(){this.initParam(),this.initializeData()}},{key:"initializeData",value:function(){var e=this;"0"===this.id?(this.isEdit=!1,this.title="\u65b0\u589e"+Object(c.k)(this.coursewareType,"MATERIAL_TYPE"),this.initializeForm({})):(this.isEdit=!0,this.title="\u7f16\u8f91"+Object(c.k)(this.coursewareType,"MATERIAL_TYPE"),this.initializeForm({}),this.materialLibService.getResourceDetail(this.id,this.coursewareType).subscribe((function(t){200===t.status&&(e.createrName=t.data.createrName,e.initializeForm(t.data))})))}},{key:"initParam",value:function(){this.code=this.route.snapshot.queryParams.code;var e=this.route.snapshot.paramMap;this.id=e.get("id"),this.coursewareType=e.get("type"),this.professionId=e.get("professionId")}},{key:"onResize",value:function(e){var t=this,n=e.width,i=this.treeContainer&&this.treeContainer.nativeElement&&this.treeContainer.nativeElement.offsetWidth;i&&this.treeContainer.nativeElement.offsetWidth+80<n||i&&this.treeContainer.nativeElement.offsetWidth+10>n||(cancelAnimationFrame(this.wid),this.wid=requestAnimationFrame((function(){t.width=n})))}},{key:"initializeForm",value:function(e){var t=e.id,n=e.learningGoalCode,i=e.attachmentName,o=e.resourceUrl,a=e.title,r=e.authorName,c=e.watermarkText,s=e.isWatermark;this.validateForm=this.fb.group({id:[this.isEdit?t:""],points:[[]],title:this.isEdit?[e.title,[S.w.required,Object(Me.b)(),S.w.maxLength(30)]]:["",[]],type:[this.coursewareType],coursewareType:[this.coursewareType],learningGoalCode:[this.isEdit?n:"",[S.w.required]],uploadFileArr:[this.isEdit?[{name:i,path:o,title:a}]:[]],authorName:[this.isEdit?r:"zksd"===this.orgCode?"\u8003\u62c9\u65e5\u8bb0":"\u6052\u4f01\u6559\u80b2",[S.w.required,Object(Me.b)(),S.w.maxLength(30)]],watermarkText:[this.isEdit?c:"zksd"===this.orgCode?"\u8003\u62c9\u65e5\u8bb0":"\u6052\u4f01\u6559\u80b2",[S.w.required,Object(Me.b)(),S.w.maxLength(30)]],isWatermark:[this.isEdit?s:"1",[S.w.required]]}),this.isEdit&&e.resourcePoints&&e.resourcePoints[0]&&e.resourcePoints[0].knowledgePointId&&(this.knowledgePointIds=this.defaultTreeKey=e.resourcePoints.map((function(e){return e.knowledgePointId})))}},{key:"submitForm",value:function(){var e=this;for(var t in"1"!==this.validateForm.value.isWatermark?this.validateForm.get("watermarkText").clearValidators():this.validateForm.get("watermarkText").setValidators([S.w.required,Object(Me.b)(),S.w.maxLength(30)]),this.validateForm.controls)this.validateForm.controls[t].markAsDirty(),this.validateForm.controls[t].updateValueAndValidity();if(this.validateForm.invalid)this.message.warning("\u8bf7\u6309\u89c4\u5219\u586b\u5199\u5b8c\u6574");else{var n=JSON.parse(JSON.stringify(this.validateForm.value));if(n.type=this.coursewareType,n.coursewareType=this.coursewareType,this.knowledgePointIds.length?(n.pointType=1,n.points=this.knowledgePointIds.map((function(e){return e}))):(n.pointType=2,n.points=[this.treeknowledge.nodes[0].id]),0!==n.uploadFileArr.length){var i=!1;if(this.isEdit)n.attachmentInfos=n.uploadFileArr.map((function(e){return e.path||(i=!0),{attachmentName:e.name,attachmentPath:e.path,title:n.title}}));else{n.attachmentInfos=[];for(var o=0;o<n.uploadFileArr.length;o++){var a=n.uploadFileArr[o];if(a.path||(i=!0),n.attachmentInfos.push({attachmentName:a.name,attachmentPath:a.path,title:a.title}),!a.title)return void this.message.warning("\u8d44\u6e90\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a")}}i?this.message.warning("\u8bf7\u7b49\u5f85\u8d44\u6e90\u4e0a\u4f20\u5b8c\u6210"):(delete n.uploadFileArr,5===this.minType&&0===this.knowledgePointIds.length?this.modalService.warning({nzTitle:"\u672a\u9009\u62e9\u77e5\u8bc6\u70b9\u8d44\u6599\u5c06\u6302\u5230\u8bfe\u7a0b\uff0c\u786e\u5b9a\u5417\uff1f",nzCancelText:"\u53d6\u6d88",nzOkText:"\u786e\u5b9a",nzOnOk:function(){return e.savaRecourse(n)}}):2===n.pointType?this.modalService.warning({nzTitle:"\u9009\u62e9\u7684\u8282\u70b9\u672a\u5305\u542b\u77e5\u8bc6\u70b9\uff0c\u8d44\u6599\u5c06\u6302\u5230\u8bfe\u7a0b\uff0c\u786e\u5b9a\u5417\uff1f",nzCancelText:"\u53d6\u6d88",nzOkText:"\u786e\u5b9a",nzOnOk:function(){return e.savaRecourse(n)}}):this.savaRecourse(n))}else this.message.warning("\u8bf7\u4e0a\u4f20\u8d44\u6e90")}}},{key:"savaRecourse",value:function(e){var t=this;return new Promise((function(n){t.isSaveLoading=!0,t.materialLibService.saveCourseware(e).subscribe((function(e){t.isSaveLoading=!1,201===e.status?(n(!0),t.goBack()):(500===e.status&&t.message.error("\u670d\u52a1\u7aef\u4e1a\u52a1\u5f02\u5e38"),n(!1))}),(function(){n(!1),t.isSaveLoading=!1}))}))}},{key:"nodeChange",value:function(e){this.knowledgePointIds=this.getCheckedLeafKey(e);var t={minType:5};this.getMinLavel(e,t),this.minType=t.minType}},{key:"getMinLavel",value:function(e,t){var n=this;e.length&&e.forEach((function(e){e.origin&&e.origin.children&&e.origin.children.length&&n.getMinLavel(e.children,t),t.minType>e.origin.kType&&(t.minType=e.origin.kType)}))}},{key:"getCheckedLeafKey",value:function(e){var t=[];return function e(n){for(var i=0;i<n.length;i++){var o=n[i]instanceof xe.d?n[i].origin:n[i];o.children&&o.children.length>0?e(o.children):o.isLeaf&&o.checked&&"4"===o.kType&&t.push(o.id)}}(e),t}},{key:"goBack",value:function(){this.menuService.goBack(!1),this.menuService.gotoUrl({url:"/m/rm/read",paramUrl:"",title:"\u9605\u8bfb\u5e93"})}}]),e}()).\u0275fac=function(e){return new(e||yt)(r.Ub(v.e),r.Ub(p.a),r.Ub(b.a),r.Ub(S.d),r.Ub(o.a),r.Ub(m.e))},yt.\u0275cmp=r.Ob({type:yt,selectors:[["app-material-other"]],viewQuery:function(e,t){var n;1&e&&(r.Vc(et,!0),r.Vc(tt,!0)),2&e&&(r.Bc(n=r.jc())&&(t.treeContainer=n.first),r.Bc(n=r.jc())&&(t.treeknowledge=n.first))},inputs:{type:"type"},decls:71,vars:39,consts:[[1,"container"],[1,"resource-container"],["nz-resizable","",1,"left-tree",3,"nzResize"],[2,"margin-bottom","15px","font-size","15px"],[2,"display","inline-block","overflow","hidden","margin-right","30px"],["treeContainer",""],["model","check",3,"professionId","defaultCheckedKeys","fullNode","allNodes","nodeChange"],["treeknowledge",""],["nzDirection","right"],[1,"right-wrap"],["nz-icon","","nzType","more","nzTheme","outline",1,"right"],[1,"right-resource"],[2,"margin-bottom","15px","font-size","18px"],["nz-icon","","nzType","question-circle","nzTheme","outline","nz-tooltip","","class","font-question",3,"nzTooltipTitle","nzTooltipOverlayStyle",4,"ngIf"],["titleTip",""],["nz-form","",1,"case-form",3,"formGroup"],["nz-row","",4,"ngIf"],["nz-row",""],["nz-col","","nzSpan","15"],["nzRequired","","nzFor","learningGoalCode",2,"text-align","left",3,"nzSm","nzXs"],["nzErrorTip","\u8bf7\u9009\u62e9\u5b66\u4e60\u76ee\u6807","nzHasFeedback","",3,"nzSm","nzXs"],["formControlName","learningGoalCode","nzAllowClear","","nzPlaceHolder","\u8bf7\u9009\u62e9\u5b66\u4e60\u76ee\u6807"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nz-col","","nzSpan","15",4,"ngIf"],["nz-row","","nzSpan","15"],["nzFor","uploadFileArr","nzRequired","",2,"text-align","left",3,"nzSm","nzXs"],["nzErrorTip","\u8bf7\u4e0a\u4f20\u6587\u4ef6",3,"nzSm","nzXs"],["materialType","other","formControlName","uploadFileArr",2,"width","100%",3,"isDrag","multiple","maxSize","limit","type","acceptType"],[1,"ant-upload-drag-icon"],["nz-icon","","nzType","inbox"],[1,"ant-upload-text"],[1,"ant-upload-hint"],["nzRequired","","nzFor","title",2,"text-align","left",3,"nzSm","nzXs"],["nzHasFeedback","",3,"nzSm","nzXs","nzErrorTip"],["nz-input","","formControlName","authorName","placeholder","\u8bf7\u8f93\u5165\u4f5c\u8005\u540d\u79f0...",2,"width","calc(100% - 80px)",3,"keyup.enter"],[2,"margin-left","10px"],["titleTpl",""],["nzHasFeedback","",3,"nzSm","nzXs"],["formControlName","isWatermark"],["nz-radio","","nzValue","1"],["nz-radio","","nzValue","0"],[1,"submit-footer"],["nz-button","","nzType","default",2,"margin-right","20px",3,"click"],["nz-button","","nzType","primary",3,"nzLoading","click"],["nz-icon","","nzType","question-circle","nzTheme","outline","nz-tooltip","",1,"font-question",3,"nzTooltipTitle","nzTooltipOverlayStyle"],[2,"text-align","left",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["nz-input","",3,"ngModel","ngModelOptions","disabled","ngModelChange"],[3,"nzValue","nzLabel"],["nz-input","","formControlName","title","placeholder","\u8bf7\u8f93\u5165\u6807\u9898...",2,"width","calc(100% - 80px)",3,"keyup.enter"],[4,"ngIf"],["nz-input","","formControlName","watermarkText","placeholder","\u8bf7\u8f93\u5165\u6c34\u5370\u6587\u5b57...",2,"width","calc(100% - 80px)",3,"keyup.enter"]],template:function(e,t){if(1&e&&(r.ac(0,"div",0),r.ac(1,"section",1),r.ac(2,"section",2),r.ic("nzResize",(function(e){return t.onResize(e)})),r.ac(3,"p",3),r.Pc(4,"\u9009\u62e9\u77e5\u8bc6\u70b9(\u4e0d\u652f\u6301\u8de8\u5b66\u79d1\u77e5\u8bc6\u70b9)"),r.Zb(),r.ac(5,"div",4,5),r.ac(7,"qkc-tree-knowledgegraph",6,7),r.ic("nodeChange",(function(e){return t.nodeChange(e)})),r.Zb(),r.Zb(),r.ac(9,"nz-resize-handle",8),r.ac(10,"div",9),r.Vb(11,"i",10),r.Zb(),r.Zb(),r.Zb(),r.ac(12,"section",11),r.ac(13,"p",12),r.Pc(14),r.Nc(15,it,1,3,"i",13),r.Zb(),r.Nc(16,ot,6,0,"ng-template",null,14,r.Oc),r.ac(18,"form",15),r.Nc(19,rt,7,8,"div",16),r.ac(20,"div",17),r.ac(21,"div",18),r.ac(22,"nz-form-item"),r.ac(23,"nz-form-label",19),r.Pc(24,"\u5b66\u4e60\u76ee\u6807 "),r.Zb(),r.ac(25,"nz-form-control",20),r.ac(26,"nz-select",21),r.Nc(27,ct,1,2,"nz-option",22),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.ac(28,"div",17),r.Nc(29,ut,10,6,"div",23),r.Zb(),r.ac(30,"div",17),r.ac(31,"div",18),r.ac(32,"nz-form-item",24),r.ac(33,"nz-form-label",25),r.Pc(34,"\u6dfb\u52a0\u6587\u4ef6 "),r.Zb(),r.ac(35,"nz-form-control",26),r.ac(36,"qkc-upload",27),r.ac(37,"p",28),r.Vb(38,"i",29),r.Zb(),r.ac(39,"p",30),r.Pc(40,"\u70b9\u51fb\u6216\u5c06\u6587\u4ef6\u62d6\u66f3\u5230\u8fd9\u91cc\u4e0a\u4f20"),r.Zb(),r.ac(41,"p",31),r.Pc(42),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.ac(43,"div",17),r.ac(44,"div",18),r.ac(45,"nz-form-item"),r.ac(46,"nz-form-label",32),r.Pc(47,"\u4f5c\u8005\u540d\u79f0 "),r.Zb(),r.ac(48,"nz-form-control",33),r.ac(49,"input",34),r.ic("keyup.enter",(function(){return t.submitForm()})),r.Zb(),r.ac(50,"span",35),r.Pc(51),r.Zb(),r.Nc(52,ft,2,2,"ng-template",null,36,r.Oc),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.ac(54,"div",17),r.ac(55,"div",18),r.ac(56,"nz-form-item"),r.ac(57,"nz-form-label",32),r.Pc(58,"\u6c34\u5370\u5f00\u5173 "),r.Zb(),r.ac(59,"nz-form-control",37),r.ac(60,"nz-radio-group",38),r.ac(61,"label",39),r.Pc(62,"\u5f00\u542f"),r.Zb(),r.ac(63,"label",40),r.Pc(64,"\u5173\u95ed"),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Nc(65,vt,11,6,"div",16),r.Zb(),r.ac(66,"div",41),r.ac(67,"button",42),r.ic("click",(function(){return t.goBack()})),r.Pc(68,"\u8fd4\u56de "),r.Zb(),r.ac(69,"button",43),r.ic("click",(function(){return t.submitForm()})),r.Pc(70,"\u4fdd\u5b58 "),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb()),2&e){var n=r.Cc(53);r.Eb(2),r.Mc("width",t.width,"px"),r.Eb(5),r.tc("professionId",t.professionId)("defaultCheckedKeys",t.defaultTreeKey)("fullNode",!0)("allNodes",!0),r.Eb(7),r.Rc("",t.title," "),r.Eb(1),r.tc("ngIf","101"===t.coursewareType),r.Eb(3),r.tc("formGroup",t.validateForm),r.Eb(1),r.tc("ngIf",t.isEdit),r.Eb(4),r.tc("nzSm",6)("nzXs",24),r.Eb(2),r.tc("nzSm",18)("nzXs",24),r.Eb(2),r.tc("ngForOf",t.learnTargetArr),r.Eb(2),r.tc("ngIf",t.isEdit),r.Eb(4),r.tc("nzSm",6)("nzXs",24),r.Eb(2),r.tc("nzSm",18)("nzXs",24),r.Eb(1),r.uc("type",t.isEdit?"other-edit":"other-add"),r.tc("isDrag",!0)("multiple",!0)("maxSize","101"==t.coursewareType?100:void 0)("limit",10)("acceptType","103"==t.coursewareType?"mp4":"png,jpg,jpeg,ppt,pptx,doc,docx,pdf,xls,xlsx,rar,zip"),r.Eb(6),r.Rc(" \u652f\u6301\u6269\u5c55\u540d: ","103"==t.coursewareType?"mp4":"png\u3001jpg\u3001jpeg\u3001ppt\u3001pptx\u3001doc\u3001docx\u3001pdf\u3001xls\u3001xlsx\u3001rar\u3001zip"," "),r.Eb(4),r.tc("nzSm",6)("nzXs",24),r.Eb(2),r.tc("nzSm",18)("nzXs",24)("nzErrorTip",n),r.Eb(3),r.Rc("",null==t.validateForm.value.authorName?null:t.validateForm.value.authorName.length,"/30"),r.Eb(6),r.tc("nzSm",6)("nzXs",24),r.Eb(2),r.tc("nzSm",18)("nzXs",24),r.Eb(6),r.tc("ngIf","1"===t.validateForm.value.isWatermark),r.Eb(4),r.tc("nzLoading",t.isSaveLoading)}},directives:[O.a,R.a,O.c,_.a,M.a,z.n,S.y,S.p,Le.b,S.i,w.c,w.a,Le.c,Le.d,Le.a,E.d,S.o,S.g,z.m,Ne.a,x.b,S.c,Ye.c,Ye.b,T.a,I.a,D.d,S.q,E.a],styles:[".margin-btn[_ngcontent-%COMP%]{margin-left:15px}.light-color[_ngcontent-%COMP%]{color:red}.container[_ngcontent-%COMP%]{background-color:#fff;padding:10px;height:100%}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:500}.resource-container[_ngcontent-%COMP%]{height:100%;overflow:hidden;display:flex}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]{min-width:200px;overflow-y:auto;overflow-x:hidden}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right-wrap[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;text-align:center;font-size:12px;height:20px;line-height:20px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]{position:relative;padding-left:30px;height:100%;flex:1;border-left:1px solid #ddd;overflow:hidden}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .case-form[_ngcontent-%COMP%]{height:calc(100% - 88px);overflow:hidden;overflow-y:auto}.source-header[_ngcontent-%COMP%]{font-weight:bolder}.submit-footer[_ngcontent-%COMP%]{position:absolute;top:0;right:0;text-align:center}[_nghost-%COMP%]     .ant-upload.ant-upload-drag .ant-upload{padding:20px}[_nghost-%COMP%]     .ant-tree-title{max-width:200px;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.font-question[_ngcontent-%COMP%]{font-size:20px;cursor:pointer;color:#fff;background-color:#1890ff;border-radius:50%}"]}),yt);function zt(e,t){1&e&&r.Vb(0,"app-material-case")}function Pt(e,t){if(1&e&&r.Vb(0,"app-material-other",2),2&e){var n=r.lc();r.tc("type",n.type)}}var kt,wt=((kt=function(){function e(t){_classCallCheck(this,e),this.route=t,this.type=""}return _createClass(e,[{key:"ngOnInit",value:function(){this.type=this.route.snapshot.paramMap.get("type")}}]),e}()).\u0275fac=function(e){return new(e||kt)(r.Ub(o.a))},kt.\u0275cmp=r.Ob({type:kt,selectors:[["app-material-lib-details"]],decls:2,vars:2,consts:[[4,"ngIf"],[3,"type",4,"ngIf"],[3,"type"]],template:function(e,t){1&e&&(r.Nc(0,zt,1,0,"app-material-case",0),r.Nc(1,Pt,1,1,"app-material-other",1)),2&e&&(r.tc("ngIf","104"===t.type),r.Eb(1),r.tc("ngIf","104"!==t.type))},directives:[z.n,Je,Ct],styles:[""]}),kt),Ot=n("hB+3"),_t=n("KQH3"),Mt=n("5vDB");function xt(e,t){if(1&e){var n=r.bc();r.Yb(0),r.ac(1,"li",2),r.ic("click",(function(){r.Ec(n);var e=t.$implicit;return r.lc().selectItem(e)})),r.ac(2,"span",3),r.Pc(3),r.Zb(),r.Zb(),r.Xb()}if(2&e){var i=t.$implicit,o=r.lc();r.Eb(1),r.tc("nzSelected",o.defaultSelect==i.id),r.Eb(2),r.Qc(i.name)}}var St,Et,Tt=((St=function(){function e(){_classCallCheck(this,e),this.menus=[],this.menuChange=new r.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"selectItem",value:function(e){this.menuChange.emit(e)}}]),e}()).\u0275fac=function(e){return new(e||St)},St.\u0275cmp=r.Ob({type:St,selectors:[["qkc-menu"]],inputs:{menus:"menus",defaultSelect:"defaultSelect"},outputs:{menuChange:"menuChange"},decls:2,vars:1,consts:[["nz-menu","","nzMode","inline"],[4,"ngFor","ngForOf"],["nz-menu-item","",3,"nzSelected","click"],[1,"c_name"]],template:function(e,t){1&e&&(r.ac(0,"ul",0),r.Nc(1,xt,4,2,"ng-container",1),r.Zb()),2&e&&(r.Eb(1),r.tc("ngForOf",t.menus))},directives:[k.c,z.m,k.d],styles:["[_nghost-%COMP%]     .ant-menu-item{text-align:right}.c_name[_ngcontent-%COMP%]{display:inline-block;max-width:200px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}"]}),St),It=n("8pq7"),Zt=((Et=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Et)},Et.\u0275cmp=r.Ob({type:Et,selectors:[["qkc-media-audio"]],inputs:{title:"title",url:"url"},decls:19,vars:7,consts:[[1,"container"],[1,"header"],["vgFor","my-video"],[1,"body"],[1,"item-size"],[1,"item-size",2,"margin","0"],[1,"timer-container"],["vgFor","my-video",1,"item-size",3,"vgProperty","vgFormat"],[1,"divider"],["id","my-video","preload","auto",3,"vgMedia"],["media",""],["type","audio/mp3",3,"src"]],template:function(e,t){if(1&e&&(r.ac(0,"vg-player",0),r.ac(1,"div",1),r.ac(2,"div"),r.Pc(3),r.Zb(),r.ac(4,"div"),r.Vb(5,"vg-volume",2),r.Zb(),r.Zb(),r.ac(6,"vg-controls",3),r.Vb(7,"vg-play-pause",4),r.ac(8,"vg-scrub-bar",5),r.Vb(9,"vg-scrub-bar-current-time"),r.Vb(10,"vg-scrub-bar-buffering-time"),r.Zb(),r.ac(11,"div",6),r.Vb(12,"vg-time-display",7),r.ac(13,"div",8),r.Pc(14,"/"),r.Zb(),r.Vb(15,"vg-time-display",7),r.Zb(),r.Zb(),r.ac(16,"audio",9,10),r.Vb(18,"source",11),r.Zb(),r.Zb()),2&e){var n=r.Cc(17);r.Eb(3),r.Rc(" ",t.title," "),r.Eb(9),r.tc("vgProperty","current")("vgFormat","mm:ss"),r.Eb(3),r.tc("vgProperty","total")("vgFormat","mm:ss"),r.Eb(1),r.tc("vgMedia",n),r.Eb(2),r.tc("src",t.url,r.Hc)}},directives:[It.o,It.h,It.e,It.i,It.j,It.l,It.k,It.m,It.n],styles:[".container[_ngcontent-%COMP%]{height:60px;display:block;background-color:#3b3b4b}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{height:30px;font-size:14px;color:#fff;padding:0 8px;display:flex;justify-content:space-between;align-items:center}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{height:30px;background-color:#3b3b4b}.container[_ngcontent-%COMP%]   .timer-container[_ngcontent-%COMP%]{flex:0 0 95px;justify-content:space-between;display:flex;padding:0 8px}.container[_ngcontent-%COMP%]   .item-size[_ngcontent-%COMP%]{height:30px;width:30px;line-height:30px}.container[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:30px;line-height:30px;color:#fff;font-size:12px}"]}),Et);function Lt(e,t){if(1&e&&(r.ac(0,"div"),r.Vb(1,"qkc-media-audio",21),r.Zb()),2&e){var n=r.lc();r.Eb(1),r.tc("title",null==n.data||null==n.data.audioInfo?null:n.data.audioInfo.attachmentName)("url",null==n.data||null==n.data.audioInfo?null:n.data.audioInfo.attachmentPath)}}function Rt(e,t){if(1&e&&r.Vb(0,"img",24),2&e){var n=r.lc().$implicit;r.tc("src",null==n?null:n.attachmentPath,r.Hc)}}function Dt(e,t){if(1&e&&r.Vb(0,"img",24),2&e){var n=r.lc().$implicit;r.tc("src",null==n?null:n.thumbnail,r.Hc)}}function Nt(e,t){if(1&e){var n=r.bc();r.Yb(0),r.ac(1,"a",22),r.ic("click",(function(){r.Ec(n);var e=t.$implicit;return r.lc().previewAttachment(e)})),r.Nc(2,Rt,1,1,"img",23),r.Nc(3,Dt,1,1,"img",23),r.ac(4,"span"),r.Pc(5),r.Zb(),r.Zb(),r.Xb()}if(2&e){var i=t.$implicit;r.Eb(2),r.tc("ngIf",null==i?null:i.isPic),r.Eb(1),r.tc("ngIf",!(null!=i&&i.isPic)&&(null==i?null:i.thumbnail)),r.Eb(2),r.Qc(i.attachmentName)}}function jt(e,t){if(1&e){var n=r.bc();r.ac(0,"app-resource-preview-modal",25),r.ic("closePreview",(function(){return r.Ec(n),r.lc().closePreview()})),r.Zb()}if(2&e){var i=r.lc();r.tc("isPreviewpolyway",i.isPreviewpolyway)("previewTitle",i.previewTitle)("resourceUrl",i.resourceUrl)}}var At,Ft=function(){return{width:"150px"}},Ut=((At=function(){function e(t,n,i,o,a,r,s,l){_classCallCheck(this,e),this.materialLibService=t,this.route=n,this.menuService=i,this.scrollService=o,this.message=a,this.uploadOssService=r,this.renderer2=s,this.doc=l,this.data={},this.id="",this.type="",this.professionId="",this.activeId="",this.typeList=[{id:"1",name:"\u6848\u4f8b\u80cc\u666f"},{id:"2",name:"\u6848\u4f8b\u89e3\u6790"},{id:"3",name:"\u6559\u5b66\u6307\u5bfc"}],this.isShow=!1,this.isLoading=!1,this.isFullScreen=!1,this.Editor=Te.a,this.config=Object.assign({},c.d),this.previewTitle="",this.isPreviewpolyway=!1,this.previewStart=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.id=this.route.snapshot.paramMap.get("id"),this.type=this.route.snapshot.paramMap.get("type"),this.professionId=this.route.snapshot.paramMap.get("professionId"),this.getResourceDetail()}},{key:"getResourceDetail",value:function(){var e=this;this.isLoading=!0,this.materialLibService.getResourceDetail(this.id,this.type).subscribe((function(t){if(e.isLoading=!1,200===t.status){var n=t.data.attachment,i=n.find((function(e){return"mp3"===e.aattachmentExt}));i&&(i.attachmentPath=f.a.OSS_URL+i.attachmentPath);var o=n.filter((function(e){return"mp3"!==e.aattachmentExt})).map((function(t){var n=e.isPicture(t.aattachmentExt),i=e.isVideo(t.aattachmentExt),o=t.attachmentPath,a=f.a.OSS_URL+t.attachmentPath,r=n||i?a:f.a.ow365+a,c=Object(Ot.a)(t.aattachmentExt);return Object.assign(Object.assign({},t),{attachmentPath:r,isPic:n,isVideo:i,thumbnail:c,originAttachmentPath:o})}));t.data.audioInfo=i,t.data.caseAttch=o,e.data=t.data}}),(function(t){e.isLoading=!1}))}},{key:"closePreview",value:function(){this.isPreviewpolyway=!1,this.resourceUrl="",this.previewTitle="",this.previewStart=!1}},{key:"getContentLength",value:function(e){return e.replace(/<[^>]+>/g,"").replace(/&nbsp;/g,"a").replace(/\s/g,"a").replace(/[\u0391-\uFFE5]/g,"a").length}},{key:"isPicture",value:function(e){return"jpg,jpeg,png".indexOf(e)>-1}},{key:"isVideo",value:function(e){return/mp4|m2v|mkv|rmvb|wmv|avi|flv|mov/.test(e)}},{key:"fullChange",value:function(e){this.isFullScreen=e}},{key:"edit",value:function(){this.menuService.gotoUrl({url:"/m/sel/material-details",paramUrl:"/".concat(this.id,"/").concat(this.type,"/").concat(this.professionId)})}},{key:"previewAttachment",value:function(e){"2"===e.sourceType?(this.resourceUrl=e.originAttachmentPath,this.previewTitle="",this.isPreviewpolyway=!0,this.previewStart=!0):(this.isPreviewpolyway=!1,this.resourceUrl=e.originAttachmentPath,this.previewTitle=e.attachmentName,this.previewStart=!0)}},{key:"menuChange",value:function(e){var t=e.id;this.scrollService.scrollToAnchor("materialSection"+t)}},{key:"backtolist",value:function(){this.menuService.goBack()}},{key:"downloadAttachments",value:function(){window.open()}}]),e}()).\u0275fac=function(e){return new(e||At)(r.Ub(p.a),r.Ub(o.a),r.Ub(b.a),r.Ub(_t.l),r.Ub(v.e),r.Ub(Ze.a),r.Ub(r.E),r.Ub(z.d))},At.\u0275cmp=r.Ob({type:At,selectors:[["app-material-preview-case"]],decls:34,vars:22,consts:[["id","fullContainer",1,"container"],[1,"full-height",3,"nzSpinning","nzDelay"],[1,"header"],[1,"header-title"],["nz-button","","nzType","link","qkcFullscreen","","fullId","fullContainer",2,"float","right",3,"fullScreenChange"],["nz-icon","","nzTheme","outline",3,"nzType"],["nz-button","",2,"float","right","margin-top","3px",3,"click"],[2,"margin","12px 0 24px"],[1,"body"],[1,"left"],[3,"menus","ngStyle","menuChange"],[1,"middle"],["id","materialSection1"],[1,"edit-content",3,"editor","disabled","config","ngModel"],["id","materialSection2"],["id","materialSection3"],[1,"right"],[4,"ngIf"],["nzText","\u9644\u4ef6\u5217\u8868"],[4,"ngFor","ngForOf"],[3,"isPreviewpolyway","previewTitle","resourceUrl","closePreview",4,"ngIf"],[3,"title","url"],[1,"attach-block",3,"click"],["alt","thumbnail",3,"src",4,"ngIf"],["alt","thumbnail",3,"src"],[3,"isPreviewpolyway","previewTitle","resourceUrl","closePreview"]],template:function(e,t){1&e&&(r.ac(0,"div",0),r.ac(1,"nz-spin",1),r.ac(2,"div",2),r.ac(3,"div",3),r.Pc(4),r.Zb(),r.ac(5,"div"),r.ac(6,"button",4),r.ic("fullScreenChange",(function(e){return t.fullChange(e)})),r.Vb(7,"i",5),r.Zb(),r.ac(8,"button",6),r.ic("click",(function(){return t.backtolist()})),r.Pc(9,"\u8fd4\u56de"),r.Zb(),r.Zb(),r.Zb(),r.Vb(10,"nz-divider",7),r.ac(11,"div",8),r.ac(12,"div",9),r.ac(13,"qkc-menu",10),r.ic("menuChange",(function(e){return t.menuChange(e)})),r.Zb(),r.Zb(),r.ac(14,"div",11),r.ac(15,"div",12),r.ac(16,"h2"),r.Pc(17,"\u6848\u4f8b\u80cc\u666f"),r.Zb(),r.Vb(18,"ckeditor",13),r.Zb(),r.ac(19,"div",14),r.ac(20,"h2"),r.Pc(21,"\u6848\u4f8b\u89e3\u6790"),r.Zb(),r.Vb(22,"ckeditor",13),r.Zb(),r.ac(23,"div",15),r.ac(24,"h2"),r.Pc(25,"\u6559\u5b66\u6307\u5bfc"),r.Zb(),r.Vb(26,"ckeditor",13),r.Zb(),r.Zb(),r.ac(27,"div",16),r.ac(28,"div"),r.Nc(29,Lt,2,2,"div",17),r.ac(30,"div"),r.Vb(31,"nz-divider",18),r.Nc(32,Nt,6,3,"ng-container",19),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Nc(33,jt,1,3,"app-resource-preview-modal",20)),2&e&&(r.Eb(1),r.tc("nzSpinning",t.isLoading)("nzDelay",0),r.Eb(3),r.Qc(null==t.data?null:t.data.title),r.Eb(3),r.tc("nzType",t.isFullScreen?"fullscreen-exit":"fullscreen"),r.Eb(6),r.tc("menus",t.typeList)("ngStyle",r.wc(21,Ft)),r.Eb(5),r.tc("editor",t.Editor)("disabled",!0)("config",t.config)("ngModel",null==t.data?null:t.data.background),r.Eb(4),r.tc("editor",t.Editor)("disabled",!0)("config",t.config)("ngModel",null==t.data?null:t.data.analysis),r.Eb(4),r.tc("editor",t.Editor)("disabled",!0)("config",t.config)("ngModel",null==t.data?null:t.data.guide),r.Eb(3),r.tc("ngIf",null==t.data?null:t.data.audioInfo),r.Eb(3),r.tc("ngForOf",null==t.data?null:t.data.caseAttch),r.Eb(1),r.tc("ngIf",t.previewStart))},directives:[Re.a,T.a,_.a,_t.i,M.a,I.a,Mt.a,Tt,z.o,De.a,S.o,S.q,z.n,z.m,Zt,U.a],styles:[".container[_ngcontent-%COMP%]{background-color:#fff;padding:10px;height:100%;overflow:scroll}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.container[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;line-height:32px;margin-left:20px}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;height:calc(100% - 82px)}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{flex:0 0 150px}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .left-fixed[_ngcontent-%COMP%]{position:fixed}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .middle[_ngcontent-%COMP%]{flex:1;padding:0 15px 10px;overflow:auto}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{flex:0 0 350px;padding:10px}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   audio[_ngcontent-%COMP%]{outline:none}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .attach-block[_ngcontent-%COMP%]{display:block;margin-bottom:15px;padding:10px;display:flex;flex-direction:column;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .attach-block[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;display:block;margin-bottom:15px}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .attach-block[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;text-align:center}.full-height[_ngcontent-%COMP%], [_nghost-%COMP%]     .full-height>.ant-spin-container{height:100%}[_nghost-%COMP%]     .edit-content .ck-editor__top{display:none}[_nghost-%COMP%]     .edit-content .ck-content{border-color:transparent!important}"]}),At),Vt=n("jhN1");function qt(e,t){if(1&e&&(r.Yb(0),r.Vb(1,"iframe",6),r.Xb()),2&e){var n=r.lc();r.Eb(1),r.tc("src",null==n.data?null:n.data.resourceUrl,r.Gc)}}var Bt,Gt=((Bt=function(){function e(t,n,i,o){_classCallCheck(this,e),this.materialLibService=t,this.route=n,this.sanitizer=i,this.menuService=o,this.data={},this.id="",this.type="",this.professionId="",this.isShow=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.id=this.route.snapshot.paramMap.get("id"),this.type=this.route.snapshot.paramMap.get("type"),this.professionId=this.route.snapshot.paramMap.get("professionId"),this.materialLibService.getResourceDetail(this.id,this.type).subscribe((function(t){200===t.status&&(t.data.resourceUrl=e.sanitizer.bypassSecurityTrustResourceUrl(f.a.ow365+f.a.OSS_URL+t.data.resourceUrl),e.data=t.data,setTimeout((function(){e.isShow=!0}),200))}),(function(e){}))}},{key:"backtolist",value:function(){this.menuService.goBack()}}]),e}()).\u0275fac=function(e){return new(e||Bt)(r.Ub(p.a),r.Ub(o.a),r.Ub(Vt.b),r.Ub(b.a))},Bt.\u0275cmp=r.Ob({type:Bt,selectors:[["app-material-preview-other"]],decls:8,vars:2,consts:[["id","fullContainer",1,"container"],[1,"header"],[2,"font-size","18px"],["nz-button","",2,"float","right",3,"click"],[1,"body"],[4,"ngIf"],["allowfullscreen","true",2,"width","100%","height","100%","border","none","min-height","680px",3,"src"]],template:function(e,t){1&e&&(r.ac(0,"div",0),r.ac(1,"div",1),r.ac(2,"div",2),r.Pc(3),r.Zb(),r.ac(4,"button",3),r.ic("click",(function(){return t.backtolist()})),r.Pc(5,"\u8fd4\u56de"),r.Zb(),r.Zb(),r.ac(6,"div",4),r.Nc(7,qt,2,1,"ng-container",5),r.Zb(),r.Zb()),2&e&&(r.Eb(3),r.Qc(null==t.data?null:t.data.title),r.Eb(4),r.tc("ngIf",t.isShow))},directives:[T.a,I.a,_.a,z.n],styles:[".container[_ngcontent-%COMP%]{background-color:#fff;padding:10px;height:100%;width:100%;overflow:scroll}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;height:40px;line-height:40px}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center;height:calc(100% - 40px)}"]}),Bt),Xt=n("Lfe1"),Wt=n("2+G5"),$t=["treeContainer"];function Ht(e,t){if(1&e){var n=r.bc();r.ac(0,"qkc-change-profession",40),r.ic("professionChange",(function(e){return r.Ec(n),r.lc().professionChange(e)})),r.Zb()}if(2&e){var i=r.lc();r.tc("select",i.selected)("hidden","scp"===i.from)}}function Kt(e,t){if(1&e){var n=r.bc();r.ac(0,"button",28),r.ic("click",(function(){return r.Ec(n),r.lc().goback()})),r.Pc(1,"\u5b8c\u6210\u8c03\u7528"),r.Zb()}}function Qt(e,t){if(1&e){var n=r.bc();r.ac(0,"button",28),r.ic("click",(function(){return r.Ec(n),r.lc().goAddPage()})),r.Pc(1,"\u65b0\u589e\u5b9e\u8bad"),r.Zb()}}function Jt(e,t){if(1&e){var n=r.bc();r.ac(0,"qkc-tree-knowledgegraph",41,42),r.ic("nodeChange",(function(e){return r.Ec(n),r.lc().nodeChange(e)})),r.Zb()}if(2&e){var i=r.lc();r.tc("fullNode",!0)("allNodes",!0)("practice",!0)("selectedProfesson",i.selectedProfesson)("professionId",null==i.selectedProfesson?null:i.selectedProfesson.id)}}function Yt(e,t){if(1&e){var n=r.bc();r.ac(0,"a",45),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().edit(e)})),r.Pc(1,"\u7f16\u8f91 "),r.Zb()}}function en(e,t){if(1&e){var n=r.bc();r.ac(0,"a",49),r.ic("click",(function(){r.Ec(n);var e=r.lc().$implicit;return r.lc().del(e)})),r.Pc(1,"\u5220\u9664"),r.Zb()}}function tn(e,t){if(1&e){var n=r.bc();r.ac(0,"a",45),r.ic("click",(function(){r.Ec(n);var e=r.lc(),t=e.$implicit,i=e.index;return r.lc().callResource(t,i)})),r.Pc(1,"\u8c03\u7528"),r.Zb()}}function nn(e,t){if(1&e){var n=r.bc();r.ac(0,"a",49),r.ic("click",(function(){r.Ec(n);var e=r.lc(),t=e.$implicit,i=e.index;return r.lc().cancelCallResource(t,i)})),r.Pc(1," \u53d6\u6d88\u8c03\u7528 "),r.Zb()}}function on(e,t){1&e&&(r.ac(0,"a",50),r.Pc(1,"\u5df2\u8c03\u7528"),r.Zb())}function an(e,t){if(1&e){var n=r.bc();r.ac(0,"tr"),r.ac(1,"td"),r.ac(2,"span",43),r.Pc(3),r.Zb(),r.Zb(),r.ac(4,"td"),r.Pc(5),r.Zb(),r.ac(6,"td"),r.Pc(7,"\u6052\u4f01\u5b9e\u4e60\u7cfb\u7edf"),r.Zb(),r.ac(8,"td"),r.Pc(9),r.Zb(),r.ac(10,"td",44),r.ac(11,"a",45),r.ic("click",(function(){r.Ec(n);var e=t.$implicit;return r.lc().preview(e)})),r.Pc(12,"\u67e5\u770b\u8be6\u60c5 "),r.Zb(),r.Nc(13,Yt,2,0,"a",46),r.Nc(14,en,2,0,"a",47),r.Nc(15,tn,2,0,"a",46),r.Nc(16,nn,2,0,"a",47),r.Nc(17,on,2,0,"a",48),r.Zb(),r.Zb()}if(2&e){var i=t.$implicit,o=r.lc();r.Eb(3),r.Qc(null==i?null:i.title),r.Eb(2),r.Qc(o.learningCode[null==i?null:i.learningGoalCode]),r.Eb(4),r.Qc(null==i?null:i.accountId),r.Eb(4),r.tc("ngIf",!o.from),r.Eb(1),r.tc("ngIf",!o.from),r.Eb(1),r.tc("ngIf","scp"==o.from&&!i.isCall&&o.permitedCall),r.Eb(1),r.tc("ngIf","scp"==o.from&&i.isCall&&!o.callResourceData.isStandard),r.Eb(1),r.tc("ngIf",i.isCall&&o.callResourceData.isStandard)}}function rn(e,t){1&e&&r.Pc(0),2&e&&r.Rc("\u5171 ",t.$implicit," \u6761\u8bb0\u5f55")}var cn,sn=function(){return[15,20,30,40,50]},ln=function(e){return{x:"905px",y:e}},dn=((cn=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,a,r,c,s,l){var d;return _classCallCheck(this,n),(d=t.call(this)).trainManageService=e,d.materialLibService=i,d.menuService=o,d.modalService=a,d.message=r,d.route=c,d.courseMgService=s,d.statisticsLogService=l,d._PAGE_ID_="TrainLibraryCourseComponent",d.id=-1,d.selectedProfesson={},d.knowledgePointId="",d.conditionObj={industryId:"",keyword:"",learningGoalCodes:[],knowledgeSubjectId:""},d.selected="",d.from="",d.callResourceData={},d.callResourceId="MaterialCallResource",d.learningCode={},d.changeProfession=!0,d.knowledgegraphTree=!0,d.permitedCall=!0,d.init=!1,d.loading=!1,d}return _createClass(n,[{key:"initData",value:function(){var e=this;this.selected=s.a.getTrainTree()||s.a.getPacketInfoItem("code");var t=this.route.snapshot.queryParams,n=t.from,i=t.task;this.task=i,"scp"===n&&(this.from=n,this.callResourceData=s.a.getScpResourceMaterial()),c.f.map((function(t){e.learningCode[t.id]=t.name}))}},{key:"ngOnAttach",value:function(){var e=this;this.selected=s.a.getTrainTree()||s.a.getPacketInfoItem("code"),this.collectParam(),this.sybcParam(),this.init=!1,this.changeProfession=!1,Object(d.a)(0).subscribe((function(){e.changeProfession=!0}))}},{key:"collectParam",value:function(){var e=s.a.getSearch(this._PAGE_ID_),t=e.keyword,n=e.learningGoalCodes;this.keyword=t||"",this.learningGoalCodes=n||[]}},{key:"sybcParam",value:function(){this.conditionObj.keyword=this.keyword,this.conditionObj.learningGoalCodes=this.learningGoalCodes}},{key:"storingData",value:function(){var e=this.keyword,t=this.learningGoalCodes;this.passData({keyword:e,learningGoalCodes:t})}},{key:"resetInit",value:function(){this.keyword="",this.learningGoalCodes=[],this.conditionObj.learningGoalCodes=[],this.conditionObj.keyword=""}},{key:"getDataList",value:function(){var e=this;this.conditionObj.keyword=this.conditionObj.keyword.trim();var t=Object.assign(Object.assign({},this.conditionObj),{page:this.pageIndex,limit:this.pageSize});this.isLoading=!0;var n=[this.trainManageService.queryPracticalPage(t)];Object(l.a)(n).subscribe((function(t){var n;e.isLoading=!1,200===(n=t[0]).status?(e.data=n.data,e.total=n.page.totalResult,"scp"===e.from&&e.callResourceData.nodes&&e.callResourceData.nodes.length>0&&(e.data=e.data.map((function(t){var n=e.callResourceData.nodes.find((function(e){return e.id===t.id}));return n&&(t.isCall=!0,t.taskId=n.taskId),t})),e.setPermitedCall())):(e.data=[],e.total=0,e.message.create("error",JSON.stringify(n)))}),(function(t){e.isLoading=!1,function(t){e.isLoading=!1,e.message.create("error",JSON.stringify(t))}(t)}))}},{key:"onResize",value:function(e){var t=this,n=e.width,i=this.treeContainer&&this.treeContainer.nativeElement&&this.treeContainer.nativeElement.offsetWidth;i&&this.treeContainer.nativeElement.offsetWidth+80<n||i&&this.treeContainer.nativeElement.offsetWidth+10>n||(cancelAnimationFrame(this.id),this.id=requestAnimationFrame((function(){t.width=n})))}},{key:"setPermitedCall",value:function(){this.callResourceData.hasOwnProperty("limit")&&(this.permitedCall=0===Number(this.callResourceData.limit)||!(this.callResourceData.nodes.length>=this.callResourceData.limit||-1===Number(this.callResourceData.limit)))}},{key:"professionChange",value:function(e){s.a.putTrainTree(e.code),this.selectedProfesson=e,this.conditionObj.knowledgeSubjectId=e.id,this.conditionObj.industryId="",this.init?(this.pageIndex=1,this.searchData()):(this.init=!0,this.searchData("collect"))}},{key:"nodeChange",value:function(e){e.parentNode?(this.conditionObj.industryId=e.key,this.conditionObj.knowledgeSubjectId=""):(this.conditionObj.knowledgeSubjectId=e.key,this.conditionObj.industryId=""),this.pageIndex=1,this.searchData()}},{key:"edit",value:function(e){this.menuService.gotoUrl({url:"/m/rm/save-train",title:"\u7f16\u8f91\u5b9e\u8bad",paramUrl:"/edit/".concat(e.id,"/").concat(this.selectedProfesson.id,"?select=0")})}},{key:"goAddPage",value:function(){this.menuService.gotoUrl({url:"/m/rm/save-train",title:"\u65b0\u589e\u5b9e\u8bad",paramUrl:"/add/0/"+this.selectedProfesson.id+"?select="+this.conditionObj.industryId+"&t="+(new Date).getTime()})}},{key:"preview",value:function(e){var t=this;if(e.url)return this.goPage(e.url);var n={id:e.id,accountId:e.accountId};this.loading=!0,this.trainManageService.getPracticalDetail(n).subscribe((function(n){t.loading=!1,200===n.status&&n.data&&(e.url=n.data,t.goPage(n.data))}),(function(e){t.loading=!1,t.message.create("error",JSON.stringify(e))}))}},{key:"goPage",value:function(e){open(e)}},{key:"goback",value:function(){var e=this;this.menuService.goBack(),Object(d.a)(0).subscribe((function(){e.menuService.gotoUrl({title:"\u8bfe\u5305\u5efa\u8bbe",url:"/m/course-manage/prepare-course",paramUrl:""})}))}},{key:"del",value:function(e){var t=this;this.curSelectedItem=e,this.materialLibService.preDelCheck(this.curSelectedItem.id).subscribe((function(e){var n;200===e.status?(n="1"===e.data?"\u8be5\u8d26\u671f\u6b63\u5728\u88ab\u4f7f\u7528\uff0c\u5220\u9664\u540e\u8bfe\u5305\u4e2d\u7684\u5b9e\u8bad\u4efb\u52a1\u5c06\u540c\u6b65\u5220\u9664\uff0c\u786e\u5b9a\u5220\u9664\u5417\uff1f":"\u786e\u5b9a\u5220\u9664\u8be5\u8d26\u671f\u5417\uff1f",t.modalService.error({nzTitle:"\u5220\u9664",nzContent:n,nzCancelText:"\u53d6\u6d88",nzOnOk:function(){return new Promise((function(e){t.materialLibService.delResource(t.curSelectedItem.id).subscribe((function(n){200===n.status?(e(!0),t.searchData()):(500===n.status&&t.message.error("\u670d\u52a1\u7aef\u4e1a\u52a1\u5f02\u5e38"),e(!1))}),(function(n){e(!1),t.message.error(JSON.stringify(n))}))}))}})):500===e.status&&t.message.warning("\u68c0\u67e5\u8d26\u671f\u4efb\u52a1\u8c03\u7528\u60c5\u51b5\u670d\u52a1\u7aef\u51fa\u9519\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}))}},{key:"callResource",value:function(e,t){var n=this,i=function(e){n.isLoading=!1,n.message.warning(JSON.stringify(e))},o=Object.assign(Object.assign({},this.callResourceData.sectionInfo),{resourceId:e.id,sourceType:1}),a=function(e){if(n.isLoading=!1,201===e.status){var i,a=n.task;i="1"===a?"learnSet-task-action":"101"===a?"learnSet-lecture-action":"104"===a?"learnSet-material-action":"learnSet-record-action",n.statisticsLogService.statisticsPacketInfoLog({name:"\u5b9e\u8bad\u5e93\u8c03\u7528",actionCode:c.j.packetInfo[i].addCode,content:JSON.stringify(o)}),n.data[t].isCall=!0,n.data[t].taskId=e.data.id,n.callResourceData.nodes.push({id:n.data[t].id,taskId:e.data.id}),n.callResourceData.seq+=1,s.a.putScpResourceMaterial(n.callResourceData),n.setPermitedCall()}else n.message.error(500===e.status?"\u670d\u52a1\u5668\u4e1a\u52a1\u5f02\u5e38\u5bfc\u81f4\u8c03\u7528\u5931\u8d25\uff0c\u53ef\u80fd\u6807\u9898\u592a\u957f\uff0c\u8bf7\u4fdd\u630135\u5b57\u7b26\u4ee5\u5185":e.message)};this.isLoading=!0,"1"===this.task?(o.name=e.title,o.taskType="3",o.seq=s.a.getScpResourceMaterial().seq,this.courseMgService.quickCreate_courseSectionResourceTask(o).subscribe(a,i)):(o.title=e.title,o.category=e.category,o.type=this.task,o.seq=s.a.getScpResourceMaterial().seq,this.courseMgService.quickCreate_courseSectionResource(o).subscribe(a,i))}},{key:"cancelCallResource",value:function(e,t){var n=this,i=function(e){n.message.warning(JSON.stringify(e))},o=function(i){if(204===i.status){var o,a=n.task;o="1"===a?"learnSet-task-action":"101"===a?"learnSet-lecture-action":"104"===a?"learnSet-material-action":"learnSet-record-action",n.statisticsLogService.statisticsPacketInfoLog({name:"\u5b9e\u8bad\u5e93\u53d6\u6d88\u8c03\u7528",actionCode:c.j.packetInfo[o].addCode,content:e.taskId}),n.data[t].isCall=!1,n.callResourceData.nodes=n.callResourceData.nodes.filter((function(e){return e.id!==n.data[t].id})),n.callResourceData.seq-=1,s.a.putScpResourceMaterial(n.callResourceData),n.setPermitedCall()}else n.message.warning(i.message||"\u672a\u77e5\u9519\u8bef")};"1"===this.task?this.courseMgService.delInvoke_courseTask(e.taskId).subscribe(o,i):this.courseMgService.delInvoke_course(e.taskId).subscribe(o,i)}}]),n}(u.l)).\u0275fac=function(e){return new(e||cn)(r.Ub(Wt.a),r.Ub(p.a),r.Ub(b.a),r.Ub(m.e),r.Ub(v.e),r.Ub(o.a),r.Ub(y.a),r.Ub(C.a))},cn.\u0275cmp=r.Ob({type:cn,selectors:[["app-train-course-library"]],viewQuery:function(e,t){var n;1&e&&r.Vc($t,!0),2&e&&r.Bc(n=r.jc())&&(t.treeContainer=n.first)},features:[r.Bb],decls:57,vars:31,consts:[[1,"container"],[1,"header"],[1,"title"],[2,"max-width","400px"],[3,"select","hidden","professionChange",4,"ngIf"],["nz-button","","nzType","primary","class","margin-btn",3,"click",4,"ngIf"],["nz-row","",1,"resource-container"],["nz-resizable","",1,"left-tree",3,"nzResize"],[2,"display","inline-block","overflow","hidden","margin-right","30px"],["treeContainer",""],["model","custom",3,"fullNode","allNodes","practice","selectedProfesson","professionId","nodeChange",4,"ngIf"],["nzDirection","right"],[1,"right-wrap"],["nz-icon","","nzType","more","nzTheme","outline",1,"right"],[1,"right-resource"],[1,"search-container"],[1,"list"],[1,"list-title"],[1,"list-input"],["nz-input","","placeholder","\u652f\u6301\u5b9e\u8bad\u6807\u9898/\u8d26\u671fID",3,"ngModel","ngModelChange","keyup.enter"],[1,"list-title",2,"margin-left","20px"],["nzMode","multiple","nzAllowClear","","nzShowSearch","",2,"min-width","150px",3,"ngModel","ngModelChange"],["nzLabel","\u4e86\u89e3",3,"nzValue"],["nzLabel","\u7406\u89e3",3,"nzValue"],["nzLabel","\u638c\u63e1",3,"nzValue"],["nzLabel","\u5e94\u7528",3,"nzValue"],["nzLabel","\u5206\u6790",3,"nzValue"],["nzLabel","\u521b\u65b0",3,"nzValue"],["nz-button","","nzType","primary",1,"margin-btn",3,"click"],["nz-button","","nzType","primary",2,"margin-left","20px",3,"click"],["id","tableScroll",1,"table-container"],[3,"nzData","nzFrontPagination","nzShowSizeChanger","nzPageSizeOptions","nzShowTotal","nzLoading","nzTotal","nzPageIndex","nzPageSize","nzScroll","nzPageIndexChange","nzPageSizeChange"],["ajaxTable",""],[1,"source-header"],["nzWidth","220px"],["nzWidth","120px"],["nzWidth","200px"],["nzWidth","140px","nzRight",""],[4,"ngFor","ngForOf"],["totalTemplate",""],[3,"select","hidden","professionChange"],["model","custom",3,"fullNode","allNodes","practice","selectedProfesson","professionId","nodeChange"],["tree",""],[1,"synopsis-text"],["nzRight",""],[3,"click"],[3,"click",4,"ngIf"],["class","light-color",3,"click",4,"ngIf"],["style","color: #999;",4,"ngIf"],[1,"light-color",3,"click"],[2,"color","#999"]],template:function(e,t){if(1&e&&(r.ac(0,"div",0),r.ac(1,"section",1),r.ac(2,"div",2),r.ac(3,"span",3),r.Pc(4),r.Zb(),r.Nc(5,Ht,1,2,"qkc-change-profession",4),r.Zb(),r.ac(6,"div"),r.Nc(7,Kt,2,0,"button",5),r.Nc(8,Qt,2,0,"button",5),r.Zb(),r.Zb(),r.ac(9,"section",6),r.ac(10,"section",7),r.ic("nzResize",(function(e){return t.onResize(e)})),r.ac(11,"div",8,9),r.Nc(13,Jt,2,5,"qkc-tree-knowledgegraph",10),r.Zb(),r.ac(14,"nz-resize-handle",11),r.ac(15,"div",12),r.Vb(16,"i",13),r.Zb(),r.Zb(),r.Zb(),r.ac(17,"section",14),r.ac(18,"section",15),r.ac(19,"div",16),r.ac(20,"div",17),r.Pc(21,"\u5173\u952e\u8bcd\u641c\u7d22\uff1a"),r.Zb(),r.ac(22,"div",18),r.ac(23,"input",19),r.ic("ngModelChange",(function(e){return t.keyword=e}))("keyup.enter",(function(){return t.searchData("button")}))("ngModelChange",(function(){return t.storingData()})),r.Zb(),r.Zb(),r.ac(24,"div",20),r.Pc(25,"\u5b66\u4e60\u76ee\u6807\uff1a"),r.Zb(),r.ac(26,"div",18),r.ac(27,"nz-select",21),r.ic("ngModelChange",(function(e){return t.learningGoalCodes=e}))("ngModelChange",(function(){return t.storingData()})),r.Vb(28,"nz-option",22),r.Vb(29,"nz-option",23),r.Vb(30,"nz-option",24),r.Vb(31,"nz-option",25),r.Vb(32,"nz-option",26),r.Vb(33,"nz-option",27),r.Zb(),r.Zb(),r.ac(34,"button",28),r.ic("click",(function(){return t.searchData("button")})),r.Pc(35,"\u67e5\u8be2 "),r.Zb(),r.ac(36,"button",29),r.ic("click",(function(){return t.resetData()})),r.Pc(37,"\u91cd\u7f6e"),r.Zb(),r.Zb(),r.Zb(),r.ac(38,"section",30),r.ac(39,"nz-table",31,32),r.ic("nzPageIndexChange",(function(e){return t.pageIndex=e}))("nzPageSizeChange",(function(e){return t.pageSize=e}))("nzPageIndexChange",(function(){return t.searchData()}))("nzPageSizeChange",(function(){return t.searchData()})),r.ac(41,"thead",33),r.ac(42,"tr"),r.ac(43,"th",34),r.Pc(44,"\u5b9e\u8bad\u6807\u9898"),r.Zb(),r.ac(45,"th",35),r.Pc(46,"\u5b66\u4e60\u76ee\u6807"),r.Zb(),r.ac(47,"th",36),r.Pc(48,"\u5b9e\u4e60\u7cfb\u7edf"),r.Zb(),r.ac(49,"th",36),r.Pc(50,"\u8d26\u671fID"),r.Zb(),r.ac(51,"th",37),r.Pc(52,"\u64cd\u4f5c"),r.Zb(),r.Zb(),r.Zb(),r.ac(53,"tbody"),r.Nc(54,an,18,8,"tr",38),r.Zb(),r.Zb(),r.Zb(),r.Nc(55,rn,1,1,"ng-template",null,39,r.Oc),r.Zb(),r.Zb(),r.Zb()),2&e){var n=r.Cc(40),i=r.Cc(56);r.Eb(4),r.Qc(null==t.selectedProfesson?null:t.selectedProfesson.name),r.Eb(1),r.tc("ngIf",t.changeProfession),r.Eb(2),r.tc("ngIf","scp"===t.from),r.Eb(1),r.tc("ngIf",""===t.from),r.Eb(2),r.Mc("width",t.width,"px"),r.Eb(3),r.tc("ngIf",t.knowledgegraphTree),r.Eb(10),r.tc("ngModel",t.keyword),r.Eb(4),r.tc("ngModel",t.learningGoalCodes),r.Eb(1),r.tc("nzValue",1),r.Eb(1),r.tc("nzValue",2),r.Eb(1),r.tc("nzValue",3),r.Eb(1),r.tc("nzValue",4),r.Eb(1),r.tc("nzValue",5),r.Eb(1),r.tc("nzValue",6),r.Eb(5),r.Kb("no-scoll",!t.data.length),r.Eb(1),r.tc("nzData",t.data)("nzFrontPagination",!1)("nzShowSizeChanger",!0)("nzPageSizeOptions",r.wc(28,sn))("nzShowTotal",i)("nzLoading",t.isLoading)("nzTotal",t.total)("nzPageIndex",t.pageIndex)("nzPageSize",t.pageSize)("nzScroll",r.xc(29,ln,t.height+"px")),r.Eb(15),r.tc("ngForOf",n.data)}},directives:[z.n,w.c,O.a,O.c,_.a,M.a,x.b,S.c,S.o,S.q,E.d,E.a,T.a,I.a,Z.c,Z.j,Z.k,Z.b,Z.h,Z.a,Z.e,z.m,L.a,R.a],styles:[".margin-btn[_ngcontent-%COMP%]{margin-left:15px}.light-color[_ngcontent-%COMP%]{color:red}.gray-color[_ngcontent-%COMP%]{color:#999}.container[_ngcontent-%COMP%]{background-color:#fff;padding:10px;height:100%}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px;padding-left:5px}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:500}.resource-container[_ngcontent-%COMP%]{height:calc(100% - 42px);overflow:hidden;display:flex}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]{height:100%;overflow-x:hidden;overflow-y:auto;min-width:200px}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right-wrap[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;text-align:center;font-size:12px;height:20px;line-height:20px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]{padding-left:30px;flex:1;height:100%;overflow:hidden;border-left:1px solid #ddd}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{margin-bottom:10px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;min-height:50px;align-items:center;border-bottom:1px solid #eee}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-title[_ngcontent-%COMP%]{min-width:85px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;padding:5px 15px;margin-right:12px;cursor:pointer}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{background-color:#1890ff;border-radius:5px;color:#fff}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-content[_ngcontent-%COMP%]{flex-grow:2}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{height:calc(100% - 260px);overflow:auto}.source-header[_ngcontent-%COMP%]{font-weight:bolder}tr.light-tr[_ngcontent-%COMP%]{background:#e6f7ff}[_nghost-%COMP%]     .ant-table-tbody>tr>td, [_nghost-%COMP%]     .ant-table-thead>tr>th, [_nghost-%COMP%]     .ant-table tfoot>tr>td, [_nghost-%COMP%]     .ant-table tfoot>tr>th{padding:10px 5px}.ant-table-tbody[_ngcontent-%COMP%] > tr.ant-table-row[_ngcontent-%COMP%]:hover > td[_ngcontent-%COMP%]{background:#dde0df}[_nghost-%COMP%]     .ant-table-pagination.ant-pagination{position:fixed;bottom:20px;right:20px;background:#fff}[_nghost-%COMP%]     .ant-spin-container{position:static}[_nghost-%COMP%]     .ant-tree{position:static!important}nz-content[_ngcontent-%COMP%]{flex:1!important}.synopsis-text[_ngcontent-%COMP%]{width:100%;display:-webkit-box!important;word-break:break-all;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}  .no-scoll .ant-table-body{overflow:hidden!important}[_nghost-%COMP%]     .table-container{height:calc(100% - 120px)!important;overflow:hidden}.list-title[_ngcontent-%COMP%]{max-width:100px!important}[_nghost-%COMP%]     .ant-tree-title{max-width:200px;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"]}),cn),un=n("55n1"),hn=["treeContainer"];function gn(e,t){if(1&e){var n=r.bc();r.ac(0,"button",1),r.ic("click",(function(){return r.Ec(n),r.lc().onContine()})),r.Pc(1,"\u4fdd\u5b58\u5e76\u7ee7\u7eed\u6dfb\u52a0 "),r.Zb()}if(2&e){var i=r.lc();r.tc("nzType","primary")("nzLoading",i.isLoading)}}function fn(e,t){if(1&e&&r.Vb(0,"nz-option",29),2&e){var n=t.$implicit;r.tc("nzLabel",n.name)("nzValue",n.id)}}var pn,bn=function(){return{border:"none","padding-left":"10px"}},mn=function(){return{}},vn=((pn=function(){function e(t,n,i,o,a){_classCallCheck(this,e),this.message=t,this.trainManageService=n,this.routerinfo=i,this.menuService=o,this.fb=a,this.id=-1,this.type="add",this.resourceId="",this.curProfessor={},this.curProfessorId="",this.defaultTreeKey=[],this.checkTreeNode=[],this.data={},this.isLoading=!1,this.userInfo=un.a.getUser(),this.learningTarget=c.f}return _createClass(e,[{key:"ngOnInit",value:function(){this.initParam(),this.initForm(),"add"!==this.type&&this.getData(this.resourceId),this.echoTreeData()}},{key:"echoTreeData",value:function(){var e=this.routerinfo.snapshot.queryParams.select;e&&(this.defaultTreeKey=[e],this.checkTreeNode=[e])}},{key:"initParam",value:function(){var e=this;this.routerinfo.params.subscribe((function(t){var n=t.id,i=t.type,o=t.professionId;e.type=i,e.resourceId=n,e.curProfessorId=o,e.curProfessor={id:o}}))}},{key:"initForm",value:function(){this.modalForms=this.fb.group({authorName:[this.userInfo.nickName,[S.w.required]],authorUnit:["1",[S.w.required]],title:["",[S.w.required,S.w.maxLength(30),Object(Me.b)()]],learningGoalCode:["",[S.w.required]],accountId:["",[S.w.required]]})}},{key:"onResize",value:function(e){var t=this,n=e.width,i=this.treeContainer&&this.treeContainer.nativeElement&&this.treeContainer.nativeElement.offsetWidth;i&&this.treeContainer.nativeElement.offsetWidth+80<n||i&&this.treeContainer.nativeElement.offsetWidth+10>n||(cancelAnimationFrame(this.id),this.id=requestAnimationFrame((function(){t.width=n})))}},{key:"nodeChange",value:function(e){this.checkTreeNode=[e.id]}},{key:"getData",value:function(e){var t=this;this.isLoading=!0,this.trainManageService.getPracticalById({id:e}).subscribe((function(e){t.data=e.data||{},t.defaultTreeKey=[t.data.industryId],t.checkTreeNode=[t.data.industryId],t.modalForms.patchValue({authorName:t.data.authorName,authorUnit:t.data.authorUnit,title:t.data.title,learningGoalCode:t.data.learningGoalCode,accountId:t.data.accountId}),t.isLoading=!1}),(function(e){t.isLoading=!1,t.message.create("error",JSON.stringify(e))}))}},{key:"goBack",value:function(){this.menuService.goBack(!1),this.menuService.gotoUrl({url:"/m/rm/setting",paramUrl:"",title:"\u5b9e\u8bad\u8bbe\u7f6e"})}},{key:"onContine",value:function(e){var t=this;for(var n in this.modalForms.controls)this.modalForms.controls[n].markAsDirty(),this.modalForms.controls[n].updateValueAndValidity();if(this.modalForms.valid){if(this.curProfessor.id===this.checkTreeNode[0])return void this.message.warning("\u8bf7\u9009\u62e9\u884c\u4e1a\u65b0\u589e\u5b9e\u8bad\uff0c\u76ee\u524d\u60a8\u9009\u62e9\u4e86\u8bfe\u7a0b");if(!this.checkTreeNode[0])return this.message.warning("\u8bf7\u9009\u62e9\u884c\u4e1a\u518d\u8fdb\u884c\u5b9e\u8bad\u8bbe\u7f6e");var i=Object.assign(Object.assign({},this.modalForms.value),{industryId:this.checkTreeNode[0],companyId:"0"});this.resourceId&&"edit"===this.type&&(i.id=this.resourceId),this.isLoading=!0,this.trainManageService.savePractical(i).subscribe((function(n){if(t.isLoading=!1,201===n.status)if(e)t.goBack();else for(var i in t.modalForms.patchValue({title:"",learningGoalCode:"",accountId:""}),t.modalForms.controls)t.modalForms.controls[i].markAsPristine(),t.modalForms.controls[i].markAsUntouched(),t.modalForms.controls[i].updateValueAndValidity()}),(function(){t.isLoading=!1}))}}},{key:"titleContent",get:function(){return this.modalForms.get("title").value.length}}]),e}()).\u0275fac=function(e){return new(e||pn)(r.Ub(v.e),r.Ub(Wt.a),r.Ub(o.a),r.Ub(b.a),r.Ub(S.d))},pn.\u0275cmp=r.Ob({type:pn,selectors:[["app-save-train-course"]],viewQuery:function(e,t){var n;1&e&&r.Vc(hn,!0),2&e&&r.Bc(n=r.jc())&&(t.treeContainer=n.first)},decls:45,vars:27,consts:[[1,"header-container"],["nz-button","",2,"float","right","margin","14px 10px 0 0",3,"nzType","nzLoading","click"],["nz-button","","style","float: right;margin:14px 10px 0 0;",3,"nzType","nzLoading","click",4,"ngIf"],["nz-button","",1,"margin-btn",2,"float","right","margin","14px 10px 0 0",3,"click"],[1,"resource-container"],["nz-resizable","",1,"left-tree",3,"hidden","nzResize"],[2,"display","inline-block","overflow","hidden","margin-right","30px"],["treeContainer",""],["model","custom",3,"practice","professionId","defaultCheckedKeys","allNodes","nodeChange"],["tree",""],["nzDirection","right"],[1,"right-wrap"],["nz-icon","","nzType","more","nzTheme","outline",1,"right"],[1,"right-resource",3,"ngStyle"],[3,"nzSpinning","nzDelay"],[1,"title"],["nz-form","",1,"search-container",3,"formGroup"],["nzRequired","",3,"nzSpan"],["nzHasFeedback","","nzErrorTip","\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u5e76\u4e14\u4e0d\u80fd\u8d85\u8fc730\u4e2a\u5b57\u7b26",3,"nzSpan"],["nz-input","","type","text","formControlName","title","placeholder","\u8bf7\u8f93\u5165\u6807\u9898......",3,"keyup.enter"],[2,"line-height","40px","margin-left","10px"],["nzHasFeedback","","nzErrorTip","\u5b66\u4e60\u76ee\u6807\u4e0d\u80fd\u4e3a\u7a7a",3,"nzSpan"],["nzPlaceHolder","\u8bf7\u9009\u62e9","formControlName","learningGoalCode",2,"width","100%"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzHasFeedback","","nzErrorTip","\u5b9e\u4e60\u7cfb\u7edf\u4e0d\u80fd\u4e3a\u7a7a",3,"nzSpan"],["nzPlaceHolder","\u8bf7\u9009\u62e9\u5b9e\u4e60\u7cfb\u7edf","formControlName","authorUnit",2,"width","100%"],["nzLabel","\u6052\u4f01\u5b9e\u4e60\u7cfb\u7edf","nzValue","1"],["nzHasFeedback","","nzErrorTip","\u8d26\u671fID\u4e0d\u80fd\u4e3a\u7a7a",3,"nzSpan"],["nz-input","","type","text","formControlName","accountId","placeholder","\u8bf7\u8f93\u5165\u8d26\u671fID",3,"keyup.enter"],[3,"nzLabel","nzValue"]],template:function(e,t){1&e&&(r.ac(0,"div",0),r.Pc(1," \u5b9e\u8bad\u8bbe\u7f6e "),r.ac(2,"button",1),r.ic("click",(function(){return t.onContine(!0)})),r.Pc(3,"\u4fdd\u5b58 "),r.Zb(),r.Nc(4,gn,2,2,"button",2),r.ac(5,"button",3),r.ic("click",(function(){return t.goBack()})),r.Pc(6,"\u8fd4\u56de"),r.Zb(),r.Zb(),r.ac(7,"section",4),r.ac(8,"section",5),r.ic("nzResize",(function(e){return t.onResize(e)})),r.ac(9,"div",6,7),r.ac(11,"qkc-tree-knowledgegraph",8,9),r.ic("nodeChange",(function(e){return t.nodeChange(e)})),r.Zb(),r.Zb(),r.ac(13,"nz-resize-handle",10),r.ac(14,"div",11),r.Vb(15,"i",12),r.Zb(),r.Zb(),r.Zb(),r.ac(16,"section",13),r.ac(17,"nz-spin",14),r.ac(18,"div",15),r.Pc(19),r.Zb(),r.ac(20,"form",16),r.ac(21,"nz-form-item"),r.ac(22,"nz-form-label",17),r.Pc(23,"\u5b9e\u8bad\u6807\u9898"),r.Zb(),r.ac(24,"nz-form-control",18),r.ac(25,"input",19),r.ic("keyup.enter",(function(){return t.onContine()})),r.Zb(),r.Zb(),r.ac(26,"span",20),r.Pc(27),r.Zb(),r.Zb(),r.ac(28,"nz-form-item"),r.ac(29,"nz-form-label",17),r.Pc(30,"\u5b66\u4e60\u76ee\u6807"),r.Zb(),r.ac(31,"nz-form-control",21),r.ac(32,"nz-select",22),r.Nc(33,fn,1,2,"nz-option",23),r.Zb(),r.Zb(),r.Zb(),r.ac(34,"nz-form-item"),r.ac(35,"nz-form-label",17),r.Pc(36,"\u5b9e\u4e60\u7cfb\u7edf"),r.Zb(),r.ac(37,"nz-form-control",24),r.ac(38,"nz-select",25),r.Vb(39,"nz-option",26),r.Zb(),r.Zb(),r.Zb(),r.ac(40,"nz-form-item"),r.ac(41,"nz-form-label",17),r.Pc(42,"\u8d26\u671fID"),r.Zb(),r.ac(43,"nz-form-control",27),r.ac(44,"input",28),r.ic("keyup.enter",(function(){return t.onContine()})),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb()),2&e&&(r.Eb(2),r.tc("nzType","primary")("nzLoading",t.isLoading),r.Eb(2),r.tc("ngIf","add"===t.type),r.Eb(4),r.Mc("width",t.width,"px"),r.tc("hidden","edit"===t.type),r.Eb(3),r.tc("practice",!0)("professionId",null==t.curProfessor?null:t.curProfessor.id)("defaultCheckedKeys",t.defaultTreeKey)("allNodes",!0),r.Eb(5),r.tc("ngStyle","edit"===t.type?r.wc(25,bn):r.wc(26,mn)),r.Eb(1),r.tc("nzSpinning",t.isLoading)("nzDelay",0),r.Eb(2),r.Rc("","add"===t.type?"\u65b0\u589e":"\u7f16\u8f91","\u5b9e\u8bad"),r.Eb(1),r.tc("formGroup",t.modalForms),r.Eb(2),r.tc("nzSpan",3),r.Eb(2),r.tc("nzSpan",15),r.Eb(3),r.Rc("",t.titleContent||0,"/30"),r.Eb(2),r.tc("nzSpan",3),r.Eb(2),r.tc("nzSpan",15),r.Eb(2),r.tc("ngForOf",t.learningTarget),r.Eb(2),r.tc("nzSpan",3),r.Eb(2),r.tc("nzSpan",15),r.Eb(4),r.tc("nzSpan",3),r.Eb(2),r.tc("nzSpan",15))},directives:[T.a,I.a,_.a,z.n,O.a,R.a,O.c,M.a,z.o,Re.a,S.y,S.p,Le.b,S.i,w.c,Le.c,w.a,Le.d,Le.a,x.b,S.c,S.o,S.g,E.d,z.m,E.a],styles:[".resource-container[_ngcontent-%COMP%]{overflow:hidden;display:flex;padding:10px;height:calc(100% - 60px)}.resource-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:17px;margin-bottom:15px}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;min-width:200px}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right-wrap[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.resource-container[_ngcontent-%COMP%]   .left-tree[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;text-align:center;font-size:12px;height:20px;line-height:20px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]{flex:1;padding-left:30px;height:100%;border-left:1px solid #ddd}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{margin-bottom:10px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;min-height:50px;align-items:center;border-bottom:1px solid #eee}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-title[_ngcontent-%COMP%]{width:80px}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;padding:5px 15px;margin-right:12px;cursor:pointer}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{background-color:#1890ff;border-radius:5px;color:#fff}.resource-container[_ngcontent-%COMP%]   .right-resource[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list-content[_ngcontent-%COMP%]{flex-grow:2}.btn-group[_ngcontent-%COMP%]{display:flex;justify-content:center}.btn-group[_ngcontent-%COMP%]   .margin-btn[_ngcontent-%COMP%]{margin-left:15px}.header-container[_ngcontent-%COMP%]{height:60px;font-size:18px;padding-left:20px;line-height:60px;border-bottom:1px solid #ddd}"]}),pn);function yn(e,t){if(1&e&&r.Vb(0,"iframe",3),2&e){var n=r.lc();r.tc("src",n.url,r.Gc)}}var Cn,zn,Pn,kn=[{path:"read",component:le},{path:"case",component:_e},{path:"setting",component:dn},{path:"exercise",component:(Cn=function(){function e(t){_classCallCheck(this,e),this.sanitizer=t,this._PAGE_ID_="ExerciseLibraryComponent",this.orgCode=h.a.getOrgCode(),this.codeMap={cjsd:1,zksd:2,zxjy:3,hgls:4,qm:5},this.tokenObj=un.a.getTkToken(),this.getUrl()}return _createClass(e,[{key:"getUrl",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.getProdIdSync();case 2:t=e.sent,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(f.a.questionBank+"/#/questionList?proId="+t+"&token="+this.tokenObj.token+"&refreshToken="+this.tokenObj.refreshToken+"&show_layout=false");case 4:case"end":return e.stop()}}),e,this)})))}}]),e}(),Cn.\u0275fac=function(e){return new(e||Cn)(r.Ub(Vt.b))},Cn.\u0275cmp=r.Ob({type:Cn,selectors:[["app-exercise-library"]],decls:3,vars:1,consts:[["id","fullContainer",1,"container"],[1,"body"],["allowfullscreen","true","style","width: 100%;height:100%;border: none;min-height: 680px;",3,"src",4,"ngIf"],["allowfullscreen","true",2,"width","100%","height","100%","border","none","min-height","680px",3,"src"]],template:function(e,t){1&e&&(r.ac(0,"div",0),r.ac(1,"div",1),r.Nc(2,yn,1,1,"iframe",2),r.Zb(),r.Zb()),2&e&&(r.Eb(2),r.tc("ngIf",t.url))},directives:[z.n],styles:[".container[_ngcontent-%COMP%]{background-color:#fff;height:100%;width:100%;overflow:scroll}.container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center;height:100%}"]}),Cn)},{path:"save-train/:type/:id/:professionId",component:vn},{path:"material-details/:id/:type/:professionId",component:wt},{path:"material-pre-case/:id/:type/:professionId",component:Ut},{path:"material-pre-other/:id/:type/:professionId",component:Gt},{path:"**",component:Xt.a,data:{title:"404"}}],wn=((zn=function e(){_classCallCheck(this,e)}).\u0275mod=r.Sb({type:zn}),zn.\u0275inj=r.Rb({factory:function(e){return new(e||zn)},imports:[[o.l.forChild(kn)],o.l]}),zn),On=n("r1OT"),_n=((Pn=function e(){_classCallCheck(this,e)}).\u0275mod=r.Sb({type:Pn}),Pn.\u0275inj=r.Rb({factory:function(e){return new(e||Pn)},imports:[[i.a,On.d,wn,On.c,De.b,F]]}),Pn)},xKc1:function(e,t,n){e.exports=function(){"use strict";var e=function(){},t=Object.prototype.hasOwnProperty,n=Array.prototype.slice;function i(e,i,o){for(var a,r,c=0,s=(o=n.call(arguments,2)).length;c<s;c++)for(a in r=o[c])e&&!t.call(r,a)||(i[a]=r[a])}function o(){}o.class_="Nevis",o.super_=Object,o.extend=function(t,n,o,a){var r=this;return"string"!=typeof t&&(a=o,o=n,n=t,t=null),"function"!=typeof n&&(a=o,o=n,n=function(){return r.apply(this,arguments)}),i(!1,n,r,a),n.prototype=function(t,n){var o;return"function"==typeof Object.create?o=Object.create(t):(e.prototype=t,o=new e,e.prototype=null),n&&i(!0,o,n),o}(r.prototype,o),n.prototype.constructor=n,n.class_=t||r.class_,n.super_=r,n};var a=o,r=a.extend((function(e,t,n){this.qrious=e,this.element=t,this.element.qrious=e,this.enabled=Boolean(n)}),{draw:function(e){},getElement:function(){return this.enabled||(this.enabled=!0,this.render()),this.element},getModuleSize:function(e){var t=this.qrious,n=Math.floor((t.size-2*(t.padding||0))/e.width);return Math.max(1,n)},getOffset:function(e){var t=this.qrious,n=t.padding;if(null!=n)return n;var i=this.getModuleSize(e),o=Math.floor((t.size-i*e.width)/2);return Math.max(0,o)},render:function(e){this.enabled&&(this.resize(),this.reset(),this.draw(e))},reset:function(){},resize:function(){}}),c=r.extend({draw:function(e){var t,n,i=this.qrious,o=this.getModuleSize(e),a=this.getOffset(e),r=this.element.getContext("2d");for(r.fillStyle=i.foreground,r.globalAlpha=i.foregroundAlpha,t=0;t<e.width;t++)for(n=0;n<e.width;n++)e.buffer[n*e.width+t]&&r.fillRect(o*t+a,o*n+a,o,o)},reset:function(){var e=this.qrious,t=this.element.getContext("2d"),n=e.size;t.lineWidth=1,t.clearRect(0,0,n,n),t.fillStyle=e.background,t.globalAlpha=e.backgroundAlpha,t.fillRect(0,0,n,n)},resize:function(){var e=this.element;e.width=e.height=this.qrious.size}}),s=a.extend(null,{BLOCK:[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28]}),l=a.extend(null,{BLOCKS:[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],FINAL_FORMAT:[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],LEVELS:{L:1,M:2,Q:3,H:4}}),d=a.extend(null,{EXPONENT:[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],LOG:[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175]}),u=a.extend(null,{BLOCK:[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177]}),h=a.extend((function(e){var t,n,i,o,a,r=e.value.length;for(this._badness=[],this._level=l.LEVELS[e.level],this._polynomial=[],this._value=e.value,this._version=0,this._stringBuffer=[];this._version<40&&(this._version++,i=4*(this._level-1)+16*(this._version-1),o=l.BLOCKS[i++],a=l.BLOCKS[i++],t=l.BLOCKS[i++],n=l.BLOCKS[i],!(r<=(i=t*(o+a)+a-3+(this._version<=9)))););this._dataBlock=t,this._eccBlock=n,this._neccBlock1=o,this._neccBlock2=a;var c=this.width=17+4*this._version;this.buffer=h._createArray(c*c),this._ecc=h._createArray(t+(t+n)*(o+a)+a),this._mask=h._createArray((c*(c+1)+1)/2),this._insertFinders(),this._insertAlignments(),this.buffer[8+c*(c-8)]=1,this._insertTimingGap(),this._reverseMask(),this._insertTimingRowAndColumn(),this._insertVersion(),this._syncMask(),this._convertBitStream(r),this._calculatePolynomial(),this._appendEccToData(),this._interleaveBlocks(),this._pack(),this._finish()}),{_addAlignment:function(e,t){var n,i=this.buffer,o=this.width;for(i[e+o*t]=1,n=-2;n<2;n++)i[e+n+o*(t-2)]=1,i[e-2+o*(t+n+1)]=1,i[e+2+o*(t+n)]=1,i[e+n+1+o*(t+2)]=1;for(n=0;n<2;n++)this._setMask(e-1,t+n),this._setMask(e+1,t-n),this._setMask(e-n,t-1),this._setMask(e+n,t+1)},_appendData:function(e,t,n,i){var o,a,r,c=this._polynomial,s=this._stringBuffer;for(a=0;a<i;a++)s[n+a]=0;for(a=0;a<t;a++){if(255!==(o=d.LOG[s[e+a]^s[n]]))for(r=1;r<i;r++)s[n+r-1]=s[n+r]^d.EXPONENT[h._modN(o+c[i-r])];else for(r=n;r<n+i;r++)s[r]=s[r+1];s[n+i-1]=255===o?0:d.EXPONENT[h._modN(o+c[0])]}},_appendEccToData:function(){var e,t=0,n=this._dataBlock,i=this._calculateMaxLength(),o=this._eccBlock;for(e=0;e<this._neccBlock1;e++)this._appendData(t,n,i,o),t+=n,i+=o;for(e=0;e<this._neccBlock2;e++)this._appendData(t,n+1,i,o),t+=n+1,i+=o},_applyMask:function(e){var t,n,i,o,a=this.buffer,r=this.width;switch(e){case 0:for(o=0;o<r;o++)for(i=0;i<r;i++)i+o&1||this._isMasked(i,o)||(a[i+o*r]^=1);break;case 1:for(o=0;o<r;o++)for(i=0;i<r;i++)1&o||this._isMasked(i,o)||(a[i+o*r]^=1);break;case 2:for(o=0;o<r;o++)for(t=0,i=0;i<r;i++,t++)3===t&&(t=0),t||this._isMasked(i,o)||(a[i+o*r]^=1);break;case 3:for(n=0,o=0;o<r;o++,n++)for(3===n&&(n=0),t=n,i=0;i<r;i++,t++)3===t&&(t=0),t||this._isMasked(i,o)||(a[i+o*r]^=1);break;case 4:for(o=0;o<r;o++)for(t=0,n=o>>1&1,i=0;i<r;i++,t++)3===t&&(t=0,n=!n),n||this._isMasked(i,o)||(a[i+o*r]^=1);break;case 5:for(n=0,o=0;o<r;o++,n++)for(3===n&&(n=0),t=0,i=0;i<r;i++,t++)3===t&&(t=0),(i&o&1)+!(!t|!n)||this._isMasked(i,o)||(a[i+o*r]^=1);break;case 6:for(n=0,o=0;o<r;o++,n++)for(3===n&&(n=0),t=0,i=0;i<r;i++,t++)3===t&&(t=0),(i&o&1)+(t&&t===n)&1||this._isMasked(i,o)||(a[i+o*r]^=1);break;case 7:for(n=0,o=0;o<r;o++,n++)for(3===n&&(n=0),t=0,i=0;i<r;i++,t++)3===t&&(t=0),(t&&t===n)+(i+o&1)&1||this._isMasked(i,o)||(a[i+o*r]^=1)}},_calculateMaxLength:function(){return this._dataBlock*(this._neccBlock1+this._neccBlock2)+this._neccBlock2},_calculatePolynomial:function(){var e,t,n=this._eccBlock,i=this._polynomial;for(i[0]=1,e=0;e<n;e++){for(i[e+1]=1,t=e;t>0;t--)i[t]=i[t]?i[t-1]^d.EXPONENT[h._modN(d.LOG[i[t]]+e)]:i[t-1];i[0]=d.EXPONENT[h._modN(d.LOG[i[0]]+e)]}for(e=0;e<=n;e++)i[e]=d.LOG[i[e]]},_checkBadness:function(){var e,t,n,i,o,a=0,r=this._badness,c=this.buffer,s=this.width;for(o=0;o<s-1;o++)for(i=0;i<s-1;i++)(c[i+s*o]&&c[i+1+s*o]&&c[i+s*(o+1)]&&c[i+1+s*(o+1)]||!(c[i+s*o]||c[i+1+s*o]||c[i+s*(o+1)]||c[i+1+s*(o+1)]))&&(a+=h.N2);var l=0;for(o=0;o<s;o++){for(n=0,r[0]=0,e=0,i=0;i<s;i++)e===(t=c[i+s*o])?r[n]++:r[++n]=1,l+=(e=t)?1:-1;a+=this._getBadness(n)}l<0&&(l=-l);var d=0,u=l;for(u+=u<<2,u<<=1;u>s*s;)u-=s*s,d++;for(a+=d*h.N4,i=0;i<s;i++){for(n=0,r[0]=0,e=0,o=0;o<s;o++)e===(t=c[i+s*o])?r[n]++:r[++n]=1,e=t;a+=this._getBadness(n)}return a},_convertBitStream:function(e){var t,n,i=this._ecc,o=this._version;for(n=0;n<e;n++)i[n]=this._value.charCodeAt(n);var a=this._stringBuffer=i.slice(),r=this._calculateMaxLength();e>=r-2&&(e=r-2,o>9&&e--);var c=e;if(o>9){for(a[c+2]=0,a[c+3]=0;c--;)a[c+3]|=255&(t=a[c])<<4,a[c+2]=t>>4;a[2]|=255&e<<4,a[1]=e>>4,a[0]=64|e>>12}else{for(a[c+1]=0,a[c+2]=0;c--;)a[c+2]|=255&(t=a[c])<<4,a[c+1]=t>>4;a[1]|=255&e<<4,a[0]=64|e>>4}for(c=e+3-(o<10);c<r;)a[c++]=236,a[c++]=17},_getBadness:function(e){var t,n=0,i=this._badness;for(t=0;t<=e;t++)i[t]>=5&&(n+=h.N1+i[t]-5);for(t=3;t<e-1;t+=2)i[t-2]===i[t+2]&&i[t+2]===i[t-1]&&i[t-1]===i[t+1]&&3*i[t-1]===i[t]&&(0===i[t-3]||t+3>e||3*i[t-3]>=4*i[t]||3*i[t+3]>=4*i[t])&&(n+=h.N3);return n},_finish:function(){var e,t;this._stringBuffer=this.buffer.slice();var n=0,i=3e4;for(t=0;t<8&&(this._applyMask(t),(e=this._checkBadness())<i&&(i=e,n=t),7!==n);t++)this.buffer=this._stringBuffer.slice();n!==t&&this._applyMask(n),i=l.FINAL_FORMAT[n+(this._level-1<<3)];var o=this.buffer,a=this.width;for(t=0;t<8;t++,i>>=1)1&i&&(o[a-1-t+8*a]=1,t<6?o[8+a*t]=1:o[8+a*(t+1)]=1);for(t=0;t<7;t++,i>>=1)1&i&&(o[8+a*(a-7+t)]=1,t?o[6-t+8*a]=1:o[7+8*a]=1)},_interleaveBlocks:function(){var e,t,n=this._dataBlock,i=this._ecc,o=this._eccBlock,a=0,r=this._calculateMaxLength(),c=this._neccBlock1,s=this._neccBlock2,l=this._stringBuffer;for(e=0;e<n;e++){for(t=0;t<c;t++)i[a++]=l[e+t*n];for(t=0;t<s;t++)i[a++]=l[c*n+e+t*(n+1)]}for(t=0;t<s;t++)i[a++]=l[c*n+e+t*(n+1)];for(e=0;e<o;e++)for(t=0;t<c+s;t++)i[a++]=l[r+e+t*o];this._stringBuffer=i},_insertAlignments:function(){var e,t,n,i=this._version,o=this.width;if(i>1)for(e=s.BLOCK[i],n=o-7;;){for(t=o-7;t>e-3&&(this._addAlignment(t,n),!(t<e));)t-=e;if(n<=e+9)break;this._addAlignment(6,n-=e),this._addAlignment(n,6)}},_insertFinders:function(){var e,t,n,i,o=this.buffer,a=this.width;for(e=0;e<3;e++){for(t=0,i=0,1===e&&(t=a-7),2===e&&(i=a-7),o[i+3+a*(t+3)]=1,n=0;n<6;n++)o[i+n+a*t]=1,o[i+a*(t+n+1)]=1,o[i+6+a*(t+n)]=1,o[i+n+1+a*(t+6)]=1;for(n=1;n<5;n++)this._setMask(i+n,t+1),this._setMask(i+1,t+n+1),this._setMask(i+5,t+n),this._setMask(i+n+1,t+5);for(n=2;n<4;n++)o[i+n+a*(t+2)]=1,o[i+2+a*(t+n+1)]=1,o[i+4+a*(t+n)]=1,o[i+n+1+a*(t+4)]=1}},_insertTimingGap:function(){var e,t,n=this.width;for(t=0;t<7;t++)this._setMask(7,t),this._setMask(n-8,t),this._setMask(7,t+n-7);for(e=0;e<8;e++)this._setMask(e,7),this._setMask(e+n-8,7),this._setMask(e,n-8)},_insertTimingRowAndColumn:function(){var e,t=this.buffer,n=this.width;for(e=0;e<n-14;e++)1&e?(this._setMask(8+e,6),this._setMask(6,8+e)):(t[8+e+6*n]=1,t[6+n*(8+e)]=1)},_insertVersion:function(){var e,t,n,i,o=this.buffer,a=this._version,r=this.width;if(a>6)for(e=u.BLOCK[a-7],t=17,n=0;n<6;n++)for(i=0;i<3;i++,t--)1&(t>11?a>>t-12:e>>t)?(o[5-n+r*(2-i+r-11)]=1,o[2-i+r-11+r*(5-n)]=1):(this._setMask(5-n,2-i+r-11),this._setMask(2-i+r-11,5-n))},_isMasked:function(e,t){var n=h._getMaskBit(e,t);return 1===this._mask[n]},_pack:function(){var e,t,n,i=1,o=1,a=this.width,r=a-1,c=a-1,s=(this._dataBlock+this._eccBlock)*(this._neccBlock1+this._neccBlock2)+this._neccBlock2;for(t=0;t<s;t++)for(e=this._stringBuffer[t],n=0;n<8;n++,e<<=1){128&e&&(this.buffer[r+a*c]=1);do{o?r--:(r++,i?0!==c?c--:(i=!i,6==(r-=2)&&(r--,c=9)):c!==a-1?c++:(i=!i,6==(r-=2)&&(r--,c-=8))),o=!o}while(this._isMasked(r,c))}},_reverseMask:function(){var e,t,n=this.width;for(e=0;e<9;e++)this._setMask(e,8);for(e=0;e<8;e++)this._setMask(e+n-8,8),this._setMask(8,e);for(t=0;t<7;t++)this._setMask(8,t+n-7)},_setMask:function(e,t){var n=h._getMaskBit(e,t);this._mask[n]=1},_syncMask:function(){var e,t,n=this.width;for(t=0;t<n;t++)for(e=0;e<=t;e++)this.buffer[e+n*t]&&this._setMask(e,t)}},{_createArray:function(e){var t,n=[];for(t=0;t<e;t++)n[t]=0;return n},_getMaskBit:function(e,t){var n;return e>t&&(n=e,e=t,t=n),n=t,n+=t*t,(n>>=1)+e},_modN:function(e){for(;e>=255;)e=((e-=255)>>8)+(255&e);return e},N1:3,N2:3,N3:40,N4:10}),g=h,f=r.extend({draw:function(){this.element.src=this.qrious.toDataURL()},reset:function(){this.element.src=""},resize:function(){var e=this.element;e.width=e.height=this.qrious.size}}),p=a.extend((function(e,t,n,i){this.name=e,this.modifiable=Boolean(t),this.defaultValue=n,this._valueTransformer=i}),{transform:function(e){var t=this._valueTransformer;return"function"==typeof t?t(e,this):e}}),b=a.extend(null,{abs:function(e){return null!=e?Math.abs(e):null},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},noop:function(){},toUpperCase:function(e){return null!=e?e.toUpperCase():null}}),m=a.extend((function(e){this.options={},e.forEach((function(e){this.options[e.name]=e}),this)}),{exists:function(e){return null!=this.options[e]},get:function(e,t){return m._get(this.options[e],t)},getAll:function(e){var t,n=this.options,i={};for(t in n)b.hasOwn(n,t)&&(i[t]=m._get(n[t],e));return i},init:function(e,t,n){var i,o;for(i in"function"!=typeof n&&(n=b.noop),this.options)b.hasOwn(this.options,i)&&(m._set(o=this.options[i],o.defaultValue,t),m._createAccessor(o,t,n));this._setAll(e,t,!0)},set:function(e,t,n){return this._set(e,t,n)},setAll:function(e,t){return this._setAll(e,t)},_set:function(e,t,n,i){var o=this.options[e];if(!o)throw new Error("Invalid option: "+e);if(!o.modifiable&&!i)throw new Error("Option cannot be modified: "+e);return m._set(o,t,n)},_setAll:function(e,t,n){if(!e)return!1;var i,o=!1;for(i in e)b.hasOwn(e,i)&&this._set(i,e[i],t,n)&&(o=!0);return o}},{_createAccessor:function(e,t,n){var i={get:function(){return m._get(e,t)}};e.modifiable&&(i.set=function(i){m._set(e,i,t)&&n(i,e)}),Object.defineProperty(t,e.name,i)},_get:function(e,t){return t["_"+e.name]},_set:function(e,t,n){var i="_"+e.name,o=n[i],a=e.transform(null!=t?t:e.defaultValue);return n[i]=a,a!==o}}),v=m,y=a.extend((function(){this._services={}}),{getService:function(e){var t=this._services[e];if(!t)throw new Error("Service is not being managed with name: "+e);return t},setService:function(e,t){if(this._services[e])throw new Error("Service is already managed with name: "+e);t&&(this._services[e]=t)}}),C=new v([new p("background",!0,"white"),new p("backgroundAlpha",!0,1,b.abs),new p("element"),new p("foreground",!0,"black"),new p("foregroundAlpha",!0,1,b.abs),new p("level",!0,"L",b.toUpperCase),new p("mime",!0,"image/png"),new p("padding",!0,null,b.abs),new p("size",!0,100,b.abs),new p("value",!0,"")]),z=new y,P=a.extend((function(e){C.init(e,this,this.update.bind(this));var t=C.get("element",this),n=z.getService("element"),i=t&&n.isCanvas(t)?t:n.createCanvas(),o=t&&n.isImage(t)?t:n.createImage();this._canvasRenderer=new c(this,i,!0),this._imageRenderer=new f(this,o,o===t),this.update()}),{get:function(){return C.getAll(this)},set:function(e){C.setAll(e,this)&&this.update()},toDataURL:function(e){return this.canvas.toDataURL(e||this.mime)},update:function(){var e=new g({level:this.level,value:this.value});this._canvasRenderer.render(e),this._imageRenderer.render(e)}},{use:function(e){z.setService(e.getName(),e)}});Object.defineProperties(P.prototype,{canvas:{get:function(){return this._canvasRenderer.getElement()}},image:{get:function(){return this._imageRenderer.getElement()}}});var k=P,w=a.extend({getName:function(){}}).extend({createCanvas:function(){},createImage:function(){},getName:function(){return"element"},isCanvas:function(e){},isImage:function(e){}}).extend({createCanvas:function(){return document.createElement("canvas")},createImage:function(){return document.createElement("img")},isCanvas:function(e){return e instanceof HTMLCanvasElement},isImage:function(e){return e instanceof HTMLImageElement}});return k.use(new w),k}()}}]);
//# sourceMappingURL=13-es5.caf4c1a0ec5ee1ed632f.js.map