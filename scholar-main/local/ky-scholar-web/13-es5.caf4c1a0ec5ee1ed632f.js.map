{"version":3,"sources":["webpack:///node_modules/angular2-qrcode/__ivy_ngcc__/lib/angular2-qrcode.js","webpack:///src/app/routes/resource-manage/material-library/read-lib/read-lib.component.html","webpack:///src/app/routes/resource-manage/material-library/read-lib/read-lib.component.ts","webpack:///src/app/routes/resource-manage/material-library/case-lib/case-lib.component.html","webpack:///src/app/routes/resource-manage/material-library/case-lib/case-lib.component.ts","webpack:///src/app/routes/resource-manage/material-library/material-case/material-case.component.html","webpack:///src/app/routes/resource-manage/material-library/material-case/material-case.component.ts","webpack:///src/app/routes/resource-manage/material-library/material-other/material-other.component.html","webpack:///src/app/routes/resource-manage/material-library/material-other/material-other.component.ts","webpack:///src/app/routes/resource-manage/material-library/material-lib-details/material-lib-details.component.html","webpack:///src/app/routes/resource-manage/material-library/material-lib-details/material-lib-details.component.ts","webpack:///components-qkc/qkc-menu/qkc-menu.component.html","webpack:///components-qkc/qkc-menu/qkc-menu.component.ts","webpack:///components-qkc/qkc-media/qkc-media-audio/qkc-media-audio.component.ts","webpack:///components-qkc/qkc-media/qkc-media-audio/qkc-media-audio.component.html","webpack:///src/app/routes/resource-manage/material-library/material-preview-case/material-preview-case.component.html","webpack:///src/app/routes/resource-manage/material-library/material-preview-case/material-preview-case.component.ts","webpack:///src/app/routes/resource-manage/material-library/material-preview-other/material-preview-other.component.html","webpack:///src/app/routes/resource-manage/material-library/material-preview-other/material-preview-other.component.ts","webpack:///src/app/routes/resource-manage/train-library-course/train-library-course.component.html","webpack:///src/app/routes/resource-manage/train-library-course/train-library-course.component.ts","webpack:///src/app/routes/resource-manage/train-library-course/save-train-course/save-train-course.component.html","webpack:///src/app/routes/resource-manage/train-library-course/save-train-course/save-train-course.component.ts","webpack:///src/app/routes/resource-manage/exercise-library/exercise-library.component.html","webpack:///src/app/routes/resource-manage/resource-manage-routing.module.ts","webpack:///src/app/routes/resource-manage/exercise-library/exercise-library.component.ts","webpack:///src/app/routes/resource-manage/resource-manage.module.ts","webpack:///node_modules/qrious/dist/qrious.js"],"names":["QRCodeComponent","elementRef","this","background","backgroundAlpha","foreground","foregroundAlpha","level","mime","padding","size","value","canvas","prototype","ngOnChanges","changes","generate","el","nativeElement","innerHTML","qr","appendChild","image","e","console","error","message","ɵfac","t","ɵcmp","type","selectors","inputs","features","decls","vars","template","rf","ctx","encapsulation","QRCodeModule","ɵmod","ɵinj","factory","ReadLibComponent","materialLibService","menuService","modalService","courseMgService","route","statisticsLogService","locale","super","_PAGE_ID_","id","materialMenus","filter","item","knowledgePointId","from","callResourceData","callResourceId","permitedCall","fileType","selected","getTwoWords","getName","conditionObj","category","knowledgeSubjectId","knowledgeModuleId","knowledgeUnitId","condition","coursewareType","learningGoalCode","init","knowledgegraphTree","changeProfession","previewTitle","isPreviewpolyway","previewStart","order","qrcode","qrName","getReadtree","getPacketInfoItem","snapshot","queryParams","task","reward","storingData","getScpResourceMaterial","getSearch","passData","trim","param","page","pageIndex","limit","pageSize","sort","length","isLoading","work","resConditionQuery","forkJoin","subscribe","ret","result","status","data","records","total","nodes","map","hasCallItem","find","it","isCall","taskId","taskType","supportType","setPermitedCall","create","err","JSON","stringify","collectParam","sybcParam","timer","width","flag","treeContainer","offsetWidth","cancelAnimationFrame","requestAnimationFrame","putReadtree","code","selectedProfesson","searchData","nodeOpt","kType","gotoUrl","url","paramUrl","Date","getTime","title","name","getResourceDetail","sourceType","environment","ow365","substr","resourceUrl","OSS_URL","indexOf","qrcodeVisible","log","goBack","attachmentName","loadingControl","Promise","resolve","delResource","hasOwnProperty","Number","supportFileType","toLowerCase","index","paramResult","sectionInfo","resourceId","downloadType","seq","source$","params","invoke_courseSectionFileTask","levelInformationAddAndModify","invoke_courseSectionFile","res","field","statisticsPacketInfoLog","actionCode","packetInfo","modify","content","addCode","push","putScpResourceMaterial","warning","nzTitle","nzContent","nzCancelText","nzOkText","nzOnOk","del_courseSectionFileTask","levelDataDeletion","del_courseSectionFile","delCode","$event","getDataList","String","useTime","link","document","createElement","setAttribute","querySelector","src","split","style","visibility","body","click","removeChild","onResize","nzSortOtrderChange","downloadQrcode","args","CaseLibComponent","getCasetree","reset","removeData","putCasetree","collectSearch","copyResource","isGrade","success","quickCreate_courseSectionResourceTask","quickCreate_courseSectionResource","delInvoke_courseTask","delInvoke_course","resetSearch","resetData","MaterialCaseComponent","fb","uploadOssService","renderer2","win","doc","wid","professionId","knowledgePointIds","isEdit","learnTargetArr","ktype","minType","defaultTreeKey","dailDown0","dailDown1","dailDown2","dailDownMove","0","isDown","leftCha","topCha","1","2","Editor","isBackgroundLoading","isGuideLoading","isAnalysisLoading","backgroundConfig","Object","assign","getImgVideoReosolver","analysisConfig","guideConfig","current","dom","domEdit","domContainer","domIcon","domIconOut","domMoveHandler","percent","saveLoading","orgCode","getOrgCode","that","initParam","initializeData","addEventListener","nailMove","removeEventListener","keys","forEach","ee","startMove","endMove","routerP","paramMap","get","initializeForm","replace","event","clientX","offsetLeft","clientY","offsetTop","i","getElementById","querySelectorAll","mouseDownLabel","fixStyles","resetStyle","setStyle","offsetHeight","fixStyle","removeAttribute","window","every","ii","moveHandler","domItem","domIndex","left","top","getBoundingClientRect","label","videoUpload","getResolver","imageUpload","file","reject","uploadOss","editor","guide","analysis","attachment","authorName","validateForm","group","points","required","maxLength","caseAttanmentArr","ele","path","attachmentPath","resourcePoints","controls","markAsDirty","updateValueAndValidity","invalid","getContentLength","postData","parse","pointType","treeknowledge","caseAttach","aattachmentExt","getExt","attachmentType","attachments","savaRecourse","saveCase","getCheckedLeafKey","obj","getMinLavel","origin","children","arr","checkKeyArr","recurTree","node","isLeaf","checked","keyCode","stopPropagation","nodeChange","submitForm","nailDown","percentReport","MaterialOtherComponent","isSaveLoading","createrName","watermarkText","isWatermark","uploadFileArr","clearValidators","setValidators","isUploadFail","attachmentInfos","saveCourseware","MaterialLibDetailsComponent","QkcMenuComponent","QkcMediaAudioComponent","menus","menuChange","emit","MaterialPreviewCaseComponent","scrollService","activeId","typeList","isShow","isFullScreen","config","attchArr","audioInfo","caseAttch","isPic","isPicture","isVideo","originAttachmentPath","thumbnail","ext","test","scrollToAnchor","open","fullChange","backtolist","MaterialPreviewOtherComponent","sanitizer","bypassSecurityTrustResourceUrl","setTimeout","TrainLibraryCourseComponent","trainManageService","industryId","keyword","learningGoalCodes","learningCode","loading","getTrainTree","queryPracticalPage","totalResult","putTrainTree","parentNode","key","goPage","accountId","getPracticalDetail","curSelectedItem","preDelCheck","resPre","text","SaveTrainCourseComponent","routerinfo","curProfessor","curProfessorId","checkTreeNode","userInfo","getUser","learningTarget","initForm","getData","echoTreeData","select","modalForms","nickName","authorUnit","getPracticalById","patchValue","valid","companyId","savePractical","markAsPristine","markAsUntouched","onContine","ExerciseLibraryComponent","ResourceManageRoutingModule","ResourceManageModule","routes","component","codeMap","cjsd","zksd","zxjy","hgls","qm","tokenObj","getTkToken","getUrl","codeUid","getProdIdSync","questionBank","token","refreshToken","forChild","module","exports","Constructor","slice","Array","extendObject","own","target","sources","property","source","call","arguments","Nevis","class_","super_","extend","constructor","statics","superConstructor","apply","properties","lite","Renderer_1","qrious","element","enabled","Boolean","draw","frame","getElement","render","getModuleSize","pixels","Math","floor","max","getOffset","moduleSize","offset","resize","CanvasRenderer_1","j","context","getContext","fillStyle","globalAlpha","buffer","fillRect","lineWidth","clearRect","height","Alignment_1","BLOCK","ErrorCorrection_1","BLOCKS","FINAL_FORMAT","LEVELS","L","M","Q","H","Galois_1","EXPONENT","LOG","Version_1","Frame","options","dataBlock","eccBlock","neccBlock1","neccBlock2","valueLength","_badness","_level","_polynomial","_value","_version","_stringBuffer","_dataBlock","_eccBlock","_neccBlock1","_neccBlock2","_createArray","_ecc","_mask","_insertFinders","_insertAlignments","_insertTimingGap","_reverseMask","_insertTimingRowAndColumn","_insertVersion","_syncMask","_convertBitStream","_calculatePolynomial","_appendEccToData","_interleaveBlocks","_pack","_finish","_addAlignment","x","y","_setMask","_appendData","dataLength","ecc","eccLength","bit","polynomial","stringBuffer","_modN","_calculateMaxLength","_applyMask","mask","r3x","r3y","_isMasked","_checkBadness","b","b1","h","bad","badness","N2","bw","_getBadness","count","big","N4","version","charCodeAt","badRuns","N1","N3","currentMask","k","_getMaskBit","v","array","Frame_1","ImageRenderer_1","toDataURL","Option_1","modifiable","defaultValue","valueTransformer","_valueTransformer","transform","transformer","Utilities_1","abs","hasOwn","object","noop","toUpperCase","string","OptionManager","option","exists","_get","getAll","changeHandler","_set","_createAccessor","_setAll","set","setAll","allowUnmodifiable","Error","changed","descriptor","defineProperty","fieldName","oldValue","newValue","OptionManager_1","ServiceManager_1","_services","getService","service","setService","optionManager","serviceManager","QRious","update","bind","elementService","isCanvas","createCanvas","isImage","createImage","_canvasRenderer","_imageRenderer","use","defineProperties","BrowserElementService","HTMLCanvasElement","HTMLImageElement"],"mappings":"8sGAII,EAAmB,WAInB,SAASA,EAAgBC,GACrBC,KAAKD,WAAaA,EAClBC,KAAKC,WAAa,QAClBD,KAAKE,gBAAkB,EACvBF,KAAKG,WAAa,QAClBH,KAAKI,gBAAkB,EACvBJ,KAAKK,MAAQ,IACbL,KAAKM,KAAO,YACZN,KAAKO,QAAU,KACfP,KAAKQ,KAAO,IACZR,KAAKS,MAAQ,GACbT,KAAKU,UA+ET,OAzEAZ,EAAgBa,UAAUC,YAAc,SAAUC,IAC1C,eAAgBA,GAChB,oBAAqBA,GACrB,eAAgBA,GAChB,oBAAqBA,GACrB,UAAWA,GACX,SAAUA,GACV,YAAaA,GACb,SAAUA,GACV,UAAWA,GACX,WAAYA,IACZb,KAAKc,YAMbhB,EAAgBa,UAAUG,SAAW,WACjC,IACI,IAAqBC,EAAKf,KAAKD,WAAWiB,cAC1CD,EAAGE,UAAY,GACf,IAAqBC,EAAK,IAAI,IAAO,CACjCjB,WAAYD,KAAKC,WACjBC,gBAAiBF,KAAKE,gBACtBC,WAAYH,KAAKG,WACjBC,gBAAiBJ,KAAKI,gBACtBC,MAAOL,KAAKK,MACZC,KAAMN,KAAKM,KACXC,QAASP,KAAKO,QACdC,KAAMR,KAAKQ,KACXC,MAAOT,KAAKS,QAGZM,EAAGI,YADHnB,KAAKU,OACUQ,EAAGR,OAGHQ,EAAGE,OAG1B,MAAOC,GACHC,QAAQC,MAAM,+BAAiCF,EAAEG,WAG7D1B,EAAgB2B,UAAO,SAAiCC,GAAK,OAAO,IAAKA,GAAK5B,GAAiB,KAAyB,OACxHA,EAAgB6B,UAAO,KAAyB,CAAEC,KAAM9B,EAAiB+B,UAAW,CAAC,CAAC,YAAaC,OAAQ,CAAE7B,WAAY,aAAcC,gBAAiB,kBAAmBC,WAAY,aAAcC,gBAAiB,kBAAmBC,MAAO,QAASC,KAAM,OAAQC,QAAS,UAAWC,KAAM,OAAQC,MAAO,QAASC,OAAQ,UAAYqB,SAAU,CAAC,MAA8BC,MAAO,EAAGC,KAAM,EAAGC,SAAU,SAAkCC,EAAIC,KAAUC,cAAe,IA6BvcvC,EA9FY,GAkHnB,EAAgB,WAChB,SAASwC,KAYT,OAVJA,EAAaC,UAAO,KAAwB,CAAEX,KAAMU,IACpDA,EAAaE,UAAO,KAAwB,CAAEC,QAAS,SAA8Bf,GAAK,OAAO,IAAKA,GAAKY,MAShGA,EAbS,G,qEClHd,mCAAuB,kFAC4C,O,qBAA5C,0BAAmB,0B,qCAG1C,oBAAsD,2DAAwC,mCAAI,Q,yBAClG,oBAC4C,oCAC5C,Q,0BAFsC,0B,qCAKlC,QACE,gBAAiB,kFAA2B,QAAgB,OAC9D,O,0BAD8C,mC,qCAchD,qCACyB,sEACkB,O,qBAFJ,2EAAsC,gB,qCAqC3E,oBAA8D,8DAC5D,yBACF,Q,qCA4CI,eAAuB,iFAAwC,uBAAE,Q,qCAJnE,gBACE,eAAG,oFAAwB,wBAAG,OAC9B,eAAG,iFAAqB,wBAAG,OAC3B,eAAG,kFAAsB,8BAAI,OAC7B,qBACF,O,wCAD6C,iC,qCAI3C,eAAG,0GAAyF,uBAAE,Q,qCAC9F,eAEE,gHAEA,qCACF,Q,qCACA,eAEE,gHAEA,qCACF,Q,uBACA,eAGE,+BACF,Q,sCAnBF,gBACE,eAAG,oFAAwB,wBAAG,OAC9B,qBACA,qBAMA,qBAMA,sBAKF,O,wCAlBqC,8DAIjC,8DAMA,+EAIA,gF,0BAjCN,aACE,aAAI,kBAA4B,QAAiB,OAAO,OACxD,aAAI,QAA0C,OAC9C,gBAA4B,kBACyC,QAAmB,OAAO,OAC/F,aAAI,SAAwD,OAC5D,cAAI,SAAuB,OAC3B,cAAI,SAAsB,OAE1B,cAAI,SAAoC,OACxC,cAAI,SAAkB,OACtB,uBAMA,wBAqBF,Q,gCArCkC,mCAC5B,6DAE8B,wDAAmC,uCACjE,2EACA,yCACA,wCAEA,yDACA,qCACA,gCAMA,oC,sBAyB4B,Q,KAAA,e,YAAA,uB,yBAUxC,qB,kBAAS,uBAAgB,gB,sCAQ7B,wCAE4B,wEAAgC,O,qBAFhC,4CAAqC,8BAArC,CAAqC,8B,ICpIpDI,G,6EAAN,KAAMA,GAAN,iDAiDL,WACUC,EACAC,EACAC,EACDrB,EACAsB,EACAC,EACCC,EACkBC,yCAE1BC,gBATQP,qBACA,EAAAC,cACA,EAAAC,eACD,EAAArB,UACA,EAAAsB,kBACA,EAAAC,QACC,EAAAC,uBACkB,EAAAC,SAxD5B,EAAAE,UAAY,+BACZ,EAAAC,IAAM,EAGN,EAAAC,cAAgB,IAAcC,QAAQC,YAAIA,MAAiB,QAAZA,EAAKH,MACpD,EAAAI,iBAAmB,GAGnB,EAAAC,KAAmB,GACnB,EAAAC,iBAAwB,GACxB,EAAAC,eAAiB,uBAEjB,EAAAC,gBACA,EAAAhC,KAAO,IACP,EAAAiC,SAAW,IAGX,EAAAC,SAAW,GACX,EAAAC,YAAc,IAAUA,YACxB,EAAAC,QAAU,IACV,EAAAC,aAAe,CACbC,SAAU,IACVC,mBAAoB,GACpBC,kBAAmB,GACnBC,gBAAiB,GACjBb,iBAAkB,GAClBc,UAAW,GACXC,eAAgB,GAChBC,iBAAkB,IAEpB,EAAAF,UAAY,GACZ,EAAAC,eAAiB,GACjB,EAAAC,iBAAwB,GACxB,EAAAC,QACA,EAAAC,sBACA,EAAAC,oBAEA,EAAAC,aAAe,GACf,EAAAC,oBACA,EAAAC,gBACA,EAAAC,MAAQ,KACR,EAAAC,OAAS,GACT,EAAAC,OAAS,GACT,EAAAzE,KAAO,IAaqByC,EAzDvB,wDAmEHjD,KAAK8D,SAAW,IAAmBoB,eAAiB,IAAmBC,kBAAkB,QADjF,MAEqBnF,KAAK+C,MAAMqC,SAASC,YAA1C5B,EAFC,EAEF,KAAO6B,EAFL,EAEG,KAAQC,EAFX,EAES,OACjBvF,KAAKsF,KAAOA,EACZtF,KAAKuF,OAASA,EACD,QAAT9B,IACFzD,KAAKyD,KAAOA,EACM,QAAdzD,KAAKsF,MAAgC,QAAdtF,KAAKsF,MAC9BtF,KAAKiE,aAAaM,eAAiB,CAACvE,KAAKsF,MACzCtF,KAAKuE,eAAiB,CAACvE,KAAKsF,QAE5BtF,KAAKiE,aAAaM,eAAiB,CAAC,MAAO,MAAO,OAClDvE,KAAKuE,eAAiB,CAAC,MAAO,MAAO,QAEvCvE,KAAKwF,cACLxF,KAAK0D,iBAAmB,IAAmB+B,4BAjF1C,qCAyFS,MAC0C,IAAmBC,UAAU1F,KAAKmD,WAAjFmB,EADK,EACN,UAAYE,EADN,EACI,iBAAoBD,EADxB,EACsB,eAClCvE,KAAKsE,UAAYA,GAAa,GAC9BtE,KAAKwE,iBAAmBA,GAAoB,GAC5CxE,KAAKuE,eAAiBA,GAAkB,KA7FrC,kCAoGHvE,KAAKiE,aAAaK,UAAYtE,KAAKsE,UACnCtE,KAAKiE,aAAaM,eAAiBvE,KAAKuE,eACxCvE,KAAKiE,aAAaO,iBAAmBxE,KAAKwE,mBAtGvC,oCA4GQ,IACJF,EAA+CtE,KAAhD,UAAYuE,EAAoCvE,KAAtC,eAAkBwE,EAAoBxE,KAAtB,iBAChCA,KAAK2F,SAAS,CAACrB,YAAWE,mBAAkBD,qBA9GzC,kCAqHHvE,KAAKsE,UAAY,GACjBtE,KAAKuE,eAAiB,GACtBvE,KAAKwE,iBAAmB,GACxBxE,KAAKiE,aAAaM,eAAiB,GACnCvE,KAAKiE,aAAaO,iBAAmB,GACrCxE,KAAKiE,aAAaK,UAAY,KA1H3B,oCAgIQ,WACXtE,KAAKiE,aAAaK,UAAYtE,KAAKiE,aAAaK,UAAUsB,OAC1D,IAAMC,EAAK,+BACN7F,KAAKiE,cAAY,CACpB6B,KAAM9F,KAAK+F,UACXC,MAAOhG,KAAKiG,WAEVjG,KAAK+E,QACPc,EAAMK,KAAsB,WAAflG,KAAK+E,MAAqB,cAAgB,gBAEpD/E,KAAKiE,aAAaM,eAAe4B,SACpCN,EAAMtB,eAAiB,CAAC,MAAO,MAAO,QAyExCvE,KAAKoG,aACL,IAAMC,EAAO,CAACrG,KAAK2C,mBAAmB2D,kBAAkBT,IACxD,OAAAU,EAAA,GAASF,GAAMG,WACZC,YA1EcC,MA2Eb1G,EAAKoG,aA3EQM,EA4ELD,EAAI,GA3EdzG,EAAKoG,aACiB,MAAlBM,EAAOC,OACLD,EAAOE,MAAQF,EAAOE,KAAKC,SAAWH,EAAOE,KAAKC,QAAQV,QAC5DnG,EAAK4G,KAAOF,EAAOE,KAAKC,QAkCxB7G,EAAK8G,MAAQJ,EAAOE,KAAKE,MACP,QAAd9G,EAAKyD,MAAkBzD,EAAK0D,iBAAiBqD,QAE/C/G,EAAK4G,KAAO5G,EAAK4G,KAAKI,KAAKzD,YACzB,IAAM0D,EAAcjH,EAAK0D,iBAAiBqD,MAAMG,MAC7CC,YAAEA,OAAKA,EAAG/D,KAAOG,EAAKH,MAUzB,OARI6D,GACF1D,EAAK6D,UACL7D,EAAK8D,OAASJ,EAAYI,OAC1B9D,EAAK+D,SAAWL,EAAYK,UAE5B/D,EAAK+D,SAAW,KAElB/D,EAAKgE,YAAcvH,EAAKuH,YAAYhE,EAAKM,UAClCN,KAETvD,EAAKwH,qBAGPxH,EAAK4G,KAAO,GACZ5G,EAAK8G,MAAQ,IAGf9G,EAAK4G,KAAO,GACZ5G,EAAK8G,MAAQ,EACb9G,EAAKwB,QAAQiG,OAAO,QAASf,EAAOlF,aAcrCkG,YACC1H,EAAKoG,aAZMsB,YACb1H,EAAKoG,aACLpG,EAAKwB,QAAQiG,OAAO,QAASE,KAAKC,UAAUF,IAW1CnG,CAAMmG,QA7NP,mCAqOO,WACV1H,KAAK8D,SAAW,IAAmBoB,eAAiB,IAAmBC,kBAAkB,QACzFnF,KAAK6H,eACL7H,KAAK8H,YACL9H,KAAKyE,QACLzE,KAAK0E,sBACL1E,KAAK2E,oBACL,OAAAoD,EAAA,GAAM,GAAGvB,WAAU,WACjBxG,EAAK0E,sBACL1E,EAAK2E,yBA9OJ,kCAmPKqD,eAAD,MACDC,EAAOjI,KAAKkI,eACblI,KAAKkI,cAAclH,eACnBhB,KAAKkI,cAAclH,cAAcmH,YAEpCF,GAAUjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAKH,GAE7DC,GAASjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAMH,IAIjEI,qBAAqBpI,KAAKoD,IAC1BpD,KAAKoD,GAAKiF,uBAAsB,WAE9BrI,EAAKgI,MAAQA,QAjQZ,uCAqQYzE,GACf,IAAmB+E,YAAY/E,EAAKgF,MACpCvI,KAAKwI,kBAAoBjF,EACzBvD,KAAKiE,aAAaE,mBAAqBZ,EAAKH,GACvCpD,KAAKyE,MAIRzE,KAAK+F,UAAY,EACjB/F,KAAKyI,eAJLzI,KAAKyE,QACLzE,KAAKyI,WAAW,cA3Qf,iCAkRMC,GACa,MAAlBA,EAAQC,OACV3I,KAAKiE,aAAaE,mBAAqBuE,EAAQtF,GAC/CpD,KAAKiE,aAAaG,kBAAoB,GACtCpE,KAAKiE,aAAaI,gBAAkB,GACpCrE,KAAKiE,aAAaT,iBAAmB,IACV,MAAlBkF,EAAQC,OACjB3I,KAAKiE,aAAaE,mBAAqB,GACvCnE,KAAKiE,aAAaG,kBAAoBsE,EAAQtF,GAC9CpD,KAAKiE,aAAaI,gBAAkB,GACpCrE,KAAKiE,aAAaT,iBAAmB,IACV,MAAlBkF,EAAQC,OACjB3I,KAAKiE,aAAaE,mBAAqB,GACvCnE,KAAKiE,aAAaG,kBAAoB,GACtCpE,KAAKiE,aAAaI,gBAAkBqE,EAAQtF,GAC5CpD,KAAKiE,aAAaT,iBAAmB,IACV,MAAlBkF,EAAQC,QACjB3I,KAAKiE,aAAaE,mBAAqB,GACvCnE,KAAKiE,aAAaG,kBAAoB,GACtCpE,KAAKiE,aAAaI,gBAAkB,GACpCrE,KAAKiE,aAAaT,iBAAmBkF,EAAQtF,GAC7CpD,KAAKwD,iBAAmBkF,EAAQtF,IAElCpD,KAAK+F,UAAY,EACjB/F,KAAKyI,eA1SF,iCA6SMlF,GACT,IAAKvD,KAAKwI,kBACR,OAAOxI,KAAKwB,QAAQD,MAAM,qDAG5BvB,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,yBACLC,SAASA,MAADA,OAAQvF,EAAKH,GAAb0F,YAHkB9I,KAAKwI,kBAAoBxI,KAAKwI,kBAAkBpF,GAAK,EAGvE0F,wBAAsD9I,KAAKiE,aAAaT,kBAAoB,GAA5FsF,eAAoG,IAAIC,MAAOC,WACvHC,MAAO,eAAO1F,EAAK2F,SArTlB,2BA0TAtC,GACH5G,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,yBACLC,SAASA,IAADA,OAAMlC,EAAKxD,GAAX0F,YAAiBlC,EAAKhF,KAAtBkH,YAA8B9I,KAAKwI,kBAAkBpF,QA7T5D,4BAiUCwD,GAAKA,WACT5G,KAAK2C,mBAAmBwG,kBAAkBvC,EAAKxD,GAAIwD,EAAKhF,MAAM4E,WAAUE,YAChD,MAAlBA,EAAOC,SACT3G,EAAKiF,OAASyB,EAAOE,KAAKqC,MAExBjJ,EAAKgF,OADiB,MAApB4B,EAAKwC,WACOC,EAAA,EAAYC,MAAMC,OAAO,EAAGF,EAAA,EAAYC,MAAMnD,OAAS,GACjE,aACFO,EAAOE,KAAK4C,YACV,4BAEUH,EAAA,EAAYC,MAAQD,EAAA,EAAYI,SACF,MAAzC/C,EAAOE,KAAK4C,YAAYE,QAAQ,KAC/BhD,EAAOE,KAAK4C,YAAgB,IAAM9C,EAAOE,KAAK4C,aAAgB,4BAEpExJ,EAAK2J,iBACLrI,QAAQsI,IAAI5J,EAAKgF,cAhVlB,+BAsVHhF,KAAK4C,YAAYiH,QAAOA,GACxB7J,KAAK4C,YAAYgG,QAAQ,CACvBK,MAAO,2BACPJ,IAAK,kCACLC,SAAU,OA1VT,8BA+VGlC,cACDA,EAAKqC,MAAMS,QAAQ,KAAO,GAA0B,MAApB9C,EAAKwC,YAAoC,QAAdxC,EAAKhF,MACnE5B,KAAK6E,oBACL7E,KAAK8E,gBACL,OAAAiD,EAAA,GAAM,GAAGvB,WAAU,WACjBxG,EAAKwJ,YAAc5C,EAAK/C,SACxB7D,EAAK4E,aAAe,GACpB5E,EAAK6E,oBACL7E,EAAK8E,oBAGP9E,KAAK2C,mBAAmBwG,kBAAkBvC,EAAKxD,GAAIwD,EAAKhF,MAAM4E,WAAUE,YAChD,MAAlBA,EAAOC,SACLD,EAAOE,KAAKkD,eAAeJ,QAAQ,KAAO,GAAgC,MAA3BhD,EAAOE,KAAKwC,YAAoC,QAAdxC,EAAKhF,MACxF5B,EAAK8E,gBACL9E,EAAK6E,oBACL,OAAAkD,EAAA,GAAM,GAAGvB,WAAU,WACjBxG,EAAKwJ,YAAc5C,EAAK/C,SACxB7D,EAAK4E,aAAe,GACpB5E,EAAK6E,oBACL7E,EAAK8E,qBAGP9E,EAAK8E,gBACL9E,EAAK6E,oBACL,OAAAkD,EAAA,GAAM,GAAGvB,WAAU,WACjBxG,EAAK6E,oBACL7E,EAAKwJ,YAAc9C,EAAOE,KAAK4C,YAC/BxJ,EAAK4E,aAAe8B,EAAOE,KAAKqC,MAChCjJ,EAAK8E,0BA5XZ,qCAqYH9E,KAAK6E,oBACL7E,KAAKwJ,YAAc,GACnBxJ,KAAK4E,aAAe,GACpB5E,KAAK8E,kBAxYF,0BAiZD8B,EAAWmD,cACb,OAAO,IAAIC,SAASC,YAClBjK,EAAK2C,mBAAmBuH,YAAYtD,EAAKxD,IAAIoD,WAC1CE,YACuB,MAAlBA,EAAOC,QACTsD,GAAQA,GACRjK,EAAKyI,eAELwB,GAAQA,GACc,MAAlBvD,EAAOC,QACT3G,EAAKwB,QAAQD,MAAM,kDAIxBA,YACC0I,GAAQA,GACRjK,EAAKwB,QAAQD,MAAMoG,KAAKC,UAAUrG,YAjarC,wCAwaCvB,KAAK0D,iBAAiByG,eAAe,WAErCnK,KAAK4D,aADqC,IAAxCwG,OAAOpK,KAAK0D,iBAAiBsC,UAG/BhG,KAAK0D,iBAAiBqD,MAAMZ,QAAUnG,KAAK0D,iBAAiBsC,QAAkD,IAAzCoE,OAAOpK,KAAK0D,iBAAiBsC,WA5anG,kCAqbOnC,GACV,OAAKA,IAGA7D,KAAK0D,iBAAiB2G,kBAIiC,IAD5BrK,KAAK0D,iBAAiB2G,gBAC/BX,QAAQ7F,EAASyG,iBA7brC,mCAgcQ1D,EAAM2D,GAAMA,WAyBjBC,EAnBa,WACjB,GAAmC,wBAA/BxK,EAAK0D,iBAAiB9B,KACxB,OAAO,OAAP,wBACK5B,EAAK0D,iBAAiB+G,aAAW,CACpCC,WAAY9D,EAAKxD,KAJJ,GAoBD,MAAdpD,KAAKsF,MACPkF,EAAYpB,WAAaxC,EAAKwC,WAC9BoB,EAAYtB,KAAOtC,EAAKqC,MACxBuB,EAAYlD,SAAW,IACvBkD,EAAYG,aAAe,MACJ,MAAd3K,KAAKsF,OAGdkF,EAAYpB,WAAaxC,EAAKwC,WAE5BoB,EAAYG,aADI,QAAd3K,KAAKsF,KACoB,IAEA,IAE7BkF,EAAYE,WAAa9D,EAAKxD,GAC9BoH,EAAY5I,KAAO5B,KAAKsF,KACxBkF,EAAYtG,SAAW0C,EAAK1C,UAV5BsG,EAAYvB,MAAQrC,EAAKqC,OAa3BuB,EAAYI,IAAM,IAAmBnF,yBAAyBmF,IAC9D,IAAMC,EAhCcC,YAClB,GAAmC,wBAA/B9K,EAAK0D,iBAAiB9B,KACxB,MAAkB,MAAd5B,EAAKsF,KACAtF,EAAK8C,gBAAgBiI,6BAA6BD,GAClC,MAAd9K,EAAKsF,KACPtF,EAAK8C,gBAAgBkI,6BAA6BF,GAElD9K,EAAK8C,gBAAgBmI,yBAAyBH,GAPvCA,CAgCON,GAC3BxK,KAAKoG,aACLyE,EAAQrE,WAAW0E,YAEjB,GADAlL,EAAKoG,aACc,MAAf8E,EAAIvE,OAAgB,CAAC,IAEnBwE,EADG7F,EAAQtF,EAAT,KAGJmL,EADW,MAAT7F,EACM,uBACU,QAATA,EACD,0BACU,QAATA,EACD,2BAEA,yBAGRtF,EAAKgD,qBAAqBoI,wBADR,MAAhBpL,EAAKuF,OAC2C,CAChD2D,KAAM,qEACNmC,WAAY,IAAiBC,WAAW,gCAAgCC,OACxEC,QAAS7D,KAAKC,UAAU4C,IAGwB,CAChDtB,KAAM,iCACNmC,WAAY,IAAiBC,WAAWH,GAAOM,QAC/CD,QAAS7D,KAAKC,UAAU4C,KAGxBU,EAAItE,MAAQsE,EAAItE,KAAKxD,KACvBpD,EAAK4G,KAAK2D,GAAOnD,UACjBpH,EAAK4G,KAAK2D,GAAOlD,OAAS6D,EAAItE,KAAKxD,GACnCpD,EAAK4G,KAAK2D,GAAOjD,SAAW4D,EAAItE,KAAKU,SACrCtH,EAAK0D,iBAAiBqD,MAAM2E,KAAK,CAC/BtI,GAAIpD,EAAK4G,KAAK2D,GAAOnH,GACrBiE,OAAQ6D,EAAItE,KAAKxD,GACjBkE,SAAU4D,EAAItE,KAAKU,WAErBtH,EAAK0D,iBAAiBkH,KAAO,EAC7B,IAAmBe,uBAAuB3L,EAAK0D,kBAC/C1D,EAAKwH,wBAILxH,EAAKwB,QAAQD,MADI,MAAf2J,EAAIvE,OACa,6KAEAuE,EAAI1J,YA1FdkG,YACb1H,EAAKoG,aACLpG,EAAKwB,QAAQoK,QAAQjE,KAAKC,UAAUF,SApcnC,yCAkiBcd,EAAM2D,GAAMA,WAE7BvK,KAAK6C,aAAa+I,QAAQ,CACxBC,QAAS,eACTC,UAAyB,MAAd9L,KAAKsF,KAAe,mDAAa,6IAC5CyG,aAAc,eACdC,SAAU,eACVC,OAAQ,kBACC,IAAIjC,SAASC,YA+DlBjK,EAAKoG,aAzDe,WAClB,GAAmC,wBAA/BpG,EAAK0D,iBAAiB9B,KACxB,MAAkB,MAAd5B,EAAKsF,KACAtF,EAAK8C,gBAAgBoJ,0BAC1BtF,EAAKS,QAEgB,MAAdrH,EAAKsF,KACPtF,EAAK8C,gBAAgBqJ,kBAC1BvF,EAAKS,QAGArH,EAAK8C,gBAAgBsJ,sBAC1BxF,EAAKS,QAZO,GA0DPb,WAzCI0E,YAEf,GADAlL,EAAKoG,aACc,MAAf8E,EAAIvE,OAAgB,CACtB,GAAoB,MAAhB3G,EAAKuF,OACPvF,EAAKgD,qBAAqBoI,wBAAwB,CAChDlC,KAAM,iFACNmC,WAAY,IAAiBC,WAAW,gCAAgCC,OACxEC,QAAS5E,EAAKS,aAEX,CAAC,IAEF8D,EADG7F,EAAQtF,EAAT,KAGJmL,EADW,MAAT7F,EACM,uBACU,QAATA,EACD,0BACU,QAATA,EACD,2BAEA,yBAEVtF,EAAKgD,qBAAqBoI,wBAAwB,CAChDlC,KAAM,6CACNmC,WAAY,IAAiBC,WAAWH,GAAOkB,QAC/Cb,QAAS5E,EAAKS,SAGlBrH,EAAK4G,KAAK2D,GAAOnD,UACjBpH,EAAK0D,iBAAiBqD,MAAQ/G,EAAK0D,iBAAiBqD,MAAMzD,QACvDC,YAAIA,OAAKA,EAAKH,KAAOpD,EAAK4G,KAAK2D,GAAOnH,MAEzCpD,EAAK0D,iBAAiBkH,KAAO,EAC7B,IAAmBe,uBAAuB3L,EAAK0D,kBAC/C1D,EAAKwH,kBACLyC,GAAQA,QAERjK,EAAKwB,QAAQoK,QAAQV,EAAI1J,SAAW,4BACpCyI,GAAQA,MA3DGvC,YACb1H,EAAKoG,aACLpG,EAAKwB,QAAQoK,QAAQjE,KAAKC,UAAUF,IACpCuC,GAAQA,cA9iBb,yCAgnBcqC,GACjBtM,KAAK+E,MAAQuH,EACbtM,KAAKuM,gBAlnBF,4BAkpBC3F,GACJ,MAAgC,MAAzB4F,OAAO5F,EAAK6F,WAnpBhB,uCAupBH,IAAMC,EAAOC,SAASC,cAAc,KACpCF,EAAKG,aAAa,OAASF,SAASG,cAAc,kBAAuCC,KACzFL,EAAKG,aAAa,YAAa7M,KAAKiF,OAAOyE,QAAQ,MAAQ,EAAI1J,KAAKiF,OAAO+H,MAAM,KAAK,GAAKhN,KAAKiF,QAAU,QAC1GyH,EAAKO,MAAMC,WAAa,SACxBP,SAASQ,KAAKhM,YAAYuL,GAC1BA,EAAKU,QACLT,SAASQ,KAAKE,YAAYX,OA7pBvB,GAA+B,M,oCAAzBhK,IAAgB,2EAyDjB,O,wBAzDCA,GAAgB,qD,MAAA,K,i4GDzB7B,gBACE,oBACE,gBACE,QACA,wCAEF,OACA,cACE,yBACA,yBAGA,kCACE,gBACE,gCAGF,OACF,OACF,OACF,OAEA,qBACE,sBAGS,oCAAY,EAAA4K,SAAA,MAEnB,qBACE,4CAGF,OAEA,+BACE,kBACE,gBACF,OACF,OACF,OACA,sBACE,sBACE,kBACE,kBAAwB,gDAAM,OAC9B,oBAEO,0DAAuB,iCAAgB,EAAA7E,WAAW,YAAlD,CAAuB,mCAAuD,EAAAjD,iBAFrF,OAGA,kBAAmD,0CAAK,OACxD,wBAA6D,+DAA4B,mCAC7D,EAAAA,iBAE1B,wBACA,wBACA,wBACF,OACA,kBAAmD,0CAAK,OACxD,wBAAW,iEAA8B,mCACb,EAAAA,iBAC1B,wBACA,wBACA,wBACA,wBACA,wBACA,wBACF,OACA,qBAA8D,gCAAS,EAAAiD,WAAW,aAAW,wBAAE,OAC/F,2BAGF,OACF,OACA,sBACE,0BAIU,8DAA2B,sDAA3B,CAA2B,uCAEoB,EAAAA,eAF/C,CAA2B,sCAGP,EAAAA,gBAC5B,oBACA,cACE,iBAAoB,wBAAE,OACtB,iBAAoB,oCAAI,OACxB,iBAAoB,8BAAG,OACvB,iBAAoB,oCAAI,OACxB,iBAAoB,8BAAG,OACvB,iBAAoB,wBAAE,OAEtB,iBAAoB,oCAAI,OACxB,iBACI,6CAAqB,EAAA8E,mBAAA,MAA4B,qCACrD,OACA,iBAA4B,wBAAE,OAChC,OACA,OACA,iBACA,yBAuCA,OACF,OACF,OACA,2CACF,OACF,OACF,OAEA,uBAAU,gEAA6B,sDACrC,kBACI,SACJ,OACA,kBACE,6BACF,OACA,kBACE,qBAAuC,gCAAS,EAAAC,oBAA0C,sDAAO,OACnG,OACF,OAGA,iD,+BA1JM,8EACqE,wCAII,oCACD,iCAKtD,wCAWX,mCAKsD,0CAgBlD,oCAEsD,yCAQlD,2CAUyE,oCAKtC,wCAC3B,8BAAe,uBAAf,CAAe,qCAAf,CAAe,uBAAf,CAAe,gBAAf,CAAe,wBAAf,CAAe,kBAAf,CAAe,0BAAf,CAAe,gCAAf,CAAe,yBAkB5B,+BAAmB,uBAOrB,+BA+CJ,0CAA6B,iBAEjC,+BAGsC,8BAGtB,iCAMkC,sC,gtIC4QtD,aALC,YAAgB,CACfvE,MAAQwE,YAAIA,yCAAcA,EAAK,GAAGxE,MAAtBwE,0CACZjC,QAAS,GACT5J,KAAM,a,wFCpaJ,mCAAuB,kFACiD,O,qBADH,0BAAmB,0B,sCAIxF,oBAAsD,2DAAwC,mCAAI,Q,sCAClG,oBAAsD,8DAAwC,mCAAI,Q,sCAShG,qCACyB,sEAAoD,O,qBADtC,2EAAsC,gB,sCAiFvE,eAAuB,iFAAwC,uBAAE,Q,sCAJnE,gBACE,eAAG,iFAAqB,wBAAG,OAC3B,eAAG,oFAAwB,wBAAG,OAC9B,eAAG,iFAAqB,wBAAG,OAC3B,sBACF,O,wCAD6C,iC,sCAI3C,eAAG,0GAAmE,uBAAE,Q,sCACxE,eACG,gHAEF,mCAAI,Q,uBACL,eAA2E,6BAAG,Q,sCAPhF,gBACE,eAAG,oFAAwB,wBAAG,OAC9B,sBACA,sBAIA,sBACF,O,wCANqC,+CAGhC,8DAEA,8D,0BAzBP,aAEE,aAAI,kBAA4B,QAAiB,OAAO,OACxD,aAAI,QAAwD,OAC5D,gBAAmG,kBAC3E,QAAmB,OAAO,OAElD,aAAI,SAAuB,OAC3B,cAAI,SAAsB,OAE1B,cAAI,SAAoC,OACxC,cAAI,SAAkB,OACtB,wBAMA,wBASF,Q,gCAzBkC,mCAC5B,2EAC4D,wDACxC,uCAEpB,yCACA,wCAEA,yDACA,qCACA,gCAMA,oC,sBAa4B,Q,KAAA,e,YAAA,uB,IC9F/B8L,G,6EAAN,KAAMA,GAAN,iDAgCL,WACU9K,EACAC,EACDrB,EACAuB,EACCJ,EACDG,EACCE,EACkBC,yCAE1BC,gBATQN,cACA,EAAAC,eACD,EAAArB,UACA,EAAAuB,QACC,EAAAJ,qBACD,EAAAG,kBACC,EAAAE,uBACkB,EAAAC,SAvC5B,EAAAE,UAAY,+BACZ,EAAAC,IAAM,EAGN,EAAAI,iBAAmB,GAEnB,EAAAS,aAAe,CACbC,SAAU,IACVC,mBAAoB,GACpBC,kBAAmB,GACnBC,gBAAiB,GACjBb,iBAAkB,GAClBc,UAAW,GACXC,eAAgB,CAAC,OACjBC,iBAAkB,CAAC,KAKrB,EAAAf,KAAmB,GACnB,EAAAC,iBAAwB,GACxB,EAAAC,eAAiB,uBACjB,EAAAG,SAAW,GACX,EAAAY,sBACA,EAAAC,oBACA,EAAAF,QACA,EAAAb,gBACA,EAAAI,QAAU,IAEV,EAAAe,MAAuC,KAUX9B,EAxCvB,wDAkDHjD,KAAK8D,SAAW,IAAmB6J,eAAiB,IAAmBxI,kBAAkB,QADjF,MAEanF,KAAK+C,MAAMqC,SAASC,YAAlC5B,EAFC,EAEF,KAAO6B,EAFL,EAEG,KACXtF,KAAKsF,KAAOA,EACC,QAAT7B,IACFzD,KAAKyD,KAAOA,EACZzD,KAAK0D,iBAAmB,IAAmB+B,4BAvD1C,mCA8DO,WACVzF,KAAK8D,SAAW,IAAmB6J,eAAiB,IAAmBxI,kBAAkB,QACzFnF,KAAK6H,eACL7H,KAAK8H,YACL9H,KAAKyE,QACLzE,KAAK0E,sBACL1E,KAAK2E,oBACL,OAAAoD,EAAA,GAAM,GAAGvB,WAAU,WACjBxG,EAAK0E,sBACL1E,EAAK2E,yBAvEJ,qCA8ES,MAC0B,IAAmBe,UAAU1F,KAAKmD,WAAjEmB,EADK,EACN,UAAYE,EADN,EACI,iBAChBxE,KAAKsE,UAAYA,GAAa,GAC9BtE,KAAKwE,iBAAmBA,GAAoB,KAjFzC,kCAwFHxE,KAAKiE,aAAaK,UAAYtE,KAAKsE,UACnCtE,KAAKiE,aAAaO,iBAAmBxE,KAAKwE,mBAzFvC,oCA+FQ,IACJF,EAA+BtE,KAAhC,UAAYwE,EAAoBxE,KAAtB,iBAChBA,KAAK2F,SAAS,CAACrB,YAAWE,uBAjGvB,kCAyGHxE,KAAKsE,UAAY,GACjBtE,KAAKwE,iBAAmB,GACxBxE,KAAKiE,aAAaO,iBAAmB,GACrCxE,KAAKiE,aAAaK,UAAY,KA5G3B,mCAkHuB,IAAjBsJ,EAAiB,wDACtBA,IACF5N,KAAK+F,UAAY,EACjB/F,KAAKwE,iBAAmB,GACxBxE,KAAKsE,UAAY,GACjBtE,KAAKiE,aAAaO,iBAAmB,GACrCxE,KAAKiE,aAAaK,UAAY,GAC9BtE,KAAK6N,cAEP7N,KAAKuM,gBA3HF,sCA+HHvM,KAAK6H,eACL7H,KAAK8H,YACL9H,KAAKuM,gBAjIF,oCAqIHvM,KAAK+F,UAAY,EACjB/F,KAAKiE,aAAaK,UAAYtE,KAAKsE,UACnCtE,KAAKiE,aAAaO,iBAAmBxE,KAAKwE,iBAC1CxE,KAAKuM,gBAxIF,oCA2IQ,WACXvM,KAAKiE,aAAaK,UAAYtE,KAAKiE,aAAaK,UAAUsB,OAC1D,IAAMC,EAAK,+BACN7F,KAAKiE,cAAY,CACpB6B,KAAM9F,KAAK+F,UACXC,MAAOhG,KAAKiG,WAGVjG,KAAK+E,QACPc,EAAMK,KAAsB,WAAflG,KAAK+E,MAAqB,cAAgB,gBA2EzD/E,KAAKoG,aAEL,IAAMC,EAAO,CAACrG,KAAK2C,mBAAmB2D,kBAAkBT,IACxD,OAAAU,EAAA,GAASF,GAAMG,WACZC,YA7EcC,MA8Eb1G,EAAKoG,aA9EQM,EA+ELD,EAAI,GA9EdzG,EAAKoG,aACiB,MAAlBM,EAAOC,OACLD,EAAOE,MAAQF,EAAOE,KAAKC,SAAWH,EAAOE,KAAKC,QAAQV,QAC5DnG,EAAK4G,KAAOF,EAAOE,KAAKC,QAkCxB7G,EAAK8G,MAAQJ,EAAOE,KAAKE,MAET,QAAd9G,EAAKyD,MACLzD,EAAK0D,iBAAiBqD,OACtB/G,EAAK0D,iBAAiBqD,MAAMZ,OAAS,IAGrCnG,EAAK4G,KAAO5G,EAAK4G,KAAKI,KAAKzD,YACzB,IAAM0D,EAAcjH,EAAK0D,iBAAiBqD,MAAMG,MAC7CC,YAAEA,OAAKA,EAAG/D,KAAOG,EAAKH,MAMzB,OAJI6D,IACF1D,EAAK6D,UACL7D,EAAK8D,OAASJ,EAAYI,QAErB9D,KAETvD,EAAKwH,qBAGPxH,EAAK4G,KAAO,GACZ5G,EAAK8G,MAAQ,IAGf9G,EAAK4G,KAAO,GACZ5G,EAAK8G,MAAQ,EACb9G,EAAKwB,QAAQiG,OAAO,QAASf,EAAOlF,aAiBrCkG,YACC1H,EAAKoG,aAdMsB,YACb1H,EAAKoG,aACLpG,EAAKwB,QAAQiG,OAAO,QAASE,KAAKC,UAAUF,IAa1CnG,CAAMmG,QAzOP,kCA8OKM,eAAD,MACDC,EAAOjI,KAAKkI,eACblI,KAAKkI,cAAclH,eACnBhB,KAAKkI,cAAclH,cAAcmH,YAEpCF,GAAUjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAKH,GAE7DC,GAASjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAMH,IAIjEI,qBAAqBpI,KAAKoD,IAC1BpD,KAAKoD,GAAKiF,uBAAsB,WAE9BrI,EAAKgI,MAAQA,QA5PZ,wCAkQChI,KAAK0D,iBAAiByG,eAAe,WAErCnK,KAAK4D,aADqC,IAAxCwG,OAAOpK,KAAK0D,iBAAiBsC,UAG/BhG,KAAK0D,iBAAiBqD,MAAMZ,QAAUnG,KAAK0D,iBAAiBsC,QAAkD,IAAzCoE,OAAOpK,KAAK0D,iBAAiBsC,WAtQnG,uCAgRYzC,GACf,IAAmBuK,YAAYvK,EAAKgF,MACpCvI,KAAKwI,kBAAoBjF,EACzBvD,KAAKiE,aAAaE,mBAAqBZ,EAAKH,GACvCpD,KAAKyE,MAIRzE,KAAK+F,UAAY,EACjB/F,KAAKyI,eAJLzI,KAAKyE,QACLzE,KAAK+N,mBAtRJ,iCA8RMrF,GACa,MAAlBA,EAAQC,OACV3I,KAAKiE,aAAaE,mBAAqBuE,EAAQtF,GAC/CpD,KAAKiE,aAAaG,kBAAoB,GACtCpE,KAAKiE,aAAaI,gBAAkB,GACpCrE,KAAKiE,aAAaT,iBAAmB,IACV,MAAlBkF,EAAQC,OACjB3I,KAAKiE,aAAaE,mBAAqB,GACvCnE,KAAKiE,aAAaG,kBAAoBsE,EAAQtF,GAC9CpD,KAAKiE,aAAaI,gBAAkB,GACpCrE,KAAKiE,aAAaT,iBAAmB,IACV,MAAlBkF,EAAQC,OACjB3I,KAAKiE,aAAaE,mBAAqB,GACvCnE,KAAKiE,aAAaG,kBAAoB,GACtCpE,KAAKiE,aAAaI,gBAAkBqE,EAAQtF,GAC5CpD,KAAKiE,aAAaT,iBAAmB,IACV,MAAlBkF,EAAQC,QACjB3I,KAAKiE,aAAaE,mBAAqB,GACvCnE,KAAKiE,aAAaG,kBAAoB,GACtCpE,KAAKiE,aAAaI,gBAAkB,GACpCrE,KAAKiE,aAAaT,iBAAmBkF,EAAQtF,GAC7CpD,KAAKwD,iBAAmBkF,EAAQtF,IAElCpD,KAAK+F,UAAY,EACjB/F,KAAKyI,eAtTF,kCA0TH,IAAKzI,KAAKwI,kBACR,OAAOxI,KAAKwB,QAAQD,MAAM,qDAK5BvB,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,yBACLC,SAASA,UAADA,OALkB9I,KAAKwI,kBAC7BxI,KAAKwI,kBAAkBpF,GACvB,EAGM0F,eAAqC,IAAIC,MAAOC,WACxDC,MAAO,+BAnUN,2BAwUArC,GACH5G,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,yBACLC,SAASA,IAADA,OAAMlC,EAAKxD,GAAX0F,YAAiBlC,EAAKhF,KAAtBkH,YAA8B9I,KAAKwI,kBAAkBpF,IAC7D6F,MAAO,+BA5UN,8BAgVGrC,GAGN5G,KAAK4C,YAAYgG,QAAQ,CACvBC,IAHU,0BAIVC,SAASA,IAADA,OAAMlC,EAAKxD,GAAX0F,YAAiBlC,EAAKhF,KAAtBkH,YAA8B9I,KAAKwI,kBAAkBpF,IAC7D6F,MAJe,+BAlVd,2BAgWArC,GAAKA,WACR,OAAO,IAAIoD,SAASC,YAClBjK,EAAK2C,mBAAmBqL,aAAapH,EAAKxD,IAAIoD,WAC3CE,YACuB,MAAlBA,EAAOC,QACT3G,EAAKyI,aACLwB,GAAQA,KAEc,MAAlBvD,EAAOC,QACT3G,EAAKwB,QAAQD,MAAM,8CAErB0I,GAAQA,OAGX1I,YACCvB,EAAKwB,QAAQD,MAAMoG,KAAKC,UAAUrG,IAClC0I,GAAQA,WAhXX,+BAuXHjK,KAAK4C,YAAYiH,QAAOA,GACxB7J,KAAK4C,YAAYgG,QAAQ,CACvBK,MAAO,2BACPJ,IAAK,kCACLC,SAAU,OA3XT,0BAoYDlC,cACF,OAAO,IAAIoD,SAASC,YAClBjK,EAAK2C,mBAAmBuH,YAAYtD,EAAKxD,IAAIoD,WAC1CE,YACuB,MAAlBA,EAAOC,QACT3G,EAAKyI,aACLwB,GAAQA,KAEc,MAAlBvD,EAAOC,QACT3G,EAAKwB,QAAQD,MAAM,8CAErB0I,GAAQA,OAGX1I,YACCvB,EAAKwB,QAAQD,MAAMoG,KAAKC,UAAUrG,IAClC0I,GAAQA,WApZX,4BA0ZCrD,GACJ,MAAgC,MAAzB4F,OAAO5F,EAAK6F,WA3ZhB,mCA8ZQ7F,EAAM2D,GAAMA,WAEjBhJ,EAASmG,YACb1H,EAAKoG,aACLpG,EAAKwB,QAAQoK,QAAQjE,KAAKC,UAAUF,KAEhCoD,EAAM,+BACP9K,KAAK0D,iBAAiB+G,aAAW,CACpCC,WAAY9D,EAAKxD,GACjBgG,WAAY,EACZ6E,QAAS,MAELC,EAAWhD,YAEf,GADAlL,EAAKoG,aACc,MAAf8E,EAAIvE,OAAgB,CAAC,IAEnBwE,EADG7F,EAAQtF,EAAT,KAGJmL,EADW,MAAT7F,EACM,uBACU,QAATA,EACD,0BACU,QAATA,EACD,2BAEA,yBAEVtF,EAAKgD,qBAAqBoI,wBAAwB,CAChDlC,KAAM,iCACNmC,WAAY,IAAiBC,WAAWH,GAAOM,QAC/CD,QAAS7D,KAAKC,UAAUkD,KAE1B9K,EAAK4G,KAAK2D,GAAOnD,UACjBpH,EAAK4G,KAAK2D,GAAOlD,OAAS6D,EAAItE,KAAKxD,GACnCpD,EAAK0D,iBAAiBqD,MAAM2E,KAAK,CAC/BtI,GAAIpD,EAAK4G,KAAK2D,GAAOnH,GACrBiE,OAAQ6D,EAAItE,KAAKxD,KAEnBpD,EAAK0D,iBAAiBkH,KAAO,EAC7B,IAAmBe,uBAAuB3L,EAAK0D,kBAC/C1D,EAAKwH,uBAIHxH,EAAKwB,QAAQD,MADI,MAAf2J,EAAIvE,OACa,6KAEAuE,EAAI1J,UAI7BxB,KAAKoG,aACa,MAAdpG,KAAKsF,MACPwF,EAAO5B,KAAOtC,EAAKqC,MACnB6B,EAAOxD,SAAW,IAClBwD,EAAOF,IAAM,IAAmBnF,yBAAyBmF,IACzD5K,KAAK8C,gBACFqL,sCAAsCrD,GACtCtE,UAAU0H,EAAS3M,KAEtBuJ,EAAO7B,MAAQrC,EAAKqC,MACpB6B,EAAO5G,SAAW0C,EAAK1C,SACvB4G,EAAOlJ,KAAO5B,KAAKsF,KACnBwF,EAAOF,IAAM,IAAmBnF,yBAAyBmF,IACzD5K,KAAK8C,gBACFsL,kCAAkCtD,GAClCtE,UAAU0H,EAAS3M,MA9drB,yCAkecqF,EAAM2D,GAAMA,WACvBhJ,EAASmG,YACb1H,EAAKoG,aACLpG,EAAKwB,QAAQoK,QAAQjE,KAAKC,UAAUF,KAEhCwG,EAAWhD,YAEf,GADAlL,EAAKoG,aACc,MAAf8E,EAAIvE,OAAgB,CAAC,IAEnBwE,EADG7F,EAAQtF,EAAT,KAGJmL,EADW,MAAT7F,EACM,uBACU,QAATA,EACD,0BACU,QAATA,EACD,2BAEA,yBAEVtF,EAAKgD,qBAAqBoI,wBAAwB,CAChDlC,KAAM,6CACNmC,WAAY,IAAiBC,WAAWH,GAAOkB,QAC/Cb,QAAS5E,EAAKS,SAEhBrH,EAAK4G,KAAK2D,GAAOnD,UACjBpH,EAAK0D,iBAAiBqD,MAAQ/G,EAAK0D,iBAAiBqD,MAAMzD,QACvDC,YAAIA,OAAKA,EAAKH,KAAOpD,EAAK4G,KAAK2D,GAAOnH,MAEzCpD,EAAK0D,iBAAiBkH,KAAO,EAC7B,IAAmBe,uBAAuB3L,EAAK0D,kBAC/C1D,EAAKwH,uBAELxH,EAAKwB,QAAQoK,QAAQjE,KAAKC,UAAUsD,KAGxClL,KAAKoG,aACa,MAAdpG,KAAKsF,KACPtF,KAAK8C,gBACFuL,qBAAqBzH,EAAKS,QAC1Bb,UAAU0H,EAAS3M,GAEtBvB,KAAK8C,gBACFwL,iBAAiB1H,EAAKS,QACtBb,UAAU0H,EAAS3M,KA7gBrB,yCAihBc+K,GACjBtM,KAAK+E,MAAQuH,EACbtM,KAAKuM,kBAnhBF,GAA+B,M,oCAAzBmB,IAAgB,2EAwCjB,O,wBAxCCA,GAAgB,qD,MAAA,K,2pEDpB7B,gBACE,oBACE,gBACE,QACA,yCAEF,OACA,cACE,0BACA,0BACF,OACF,OAEA,oBACE,oBAES,oCAAY,EAAAJ,SAAA,MACnB,mBACE,4CAEF,OACA,+BACE,kBACE,gBACF,OACF,OACF,OACA,sBACE,sBACE,kBACE,kBAAwB,gDAAM,OAC9B,kBACE,oBACO,0DAAuB,mCAAkB,EAAA9H,gBAAzC,CAAuB,iCAAiD,EAAA+I,iBAD/E,OAEF,OACF,OACA,kBACE,kBAAiD,0CAAK,OACtD,kBACE,wBAAW,iEAA8B,mCAAkB,EAAA/I,iBAEzD,iEAEA,wBACA,wBACA,wBACA,wBACA,wBACA,wBACF,OACF,OACF,OACA,qBACQ,gCAAS,EAAA+I,iBAAe,yBAChC,OACA,qBAA6D,gCAAS,EAAAC,eAAa,wBAAE,OACvF,OACA,sBACE,0BAKU,8DAA2B,sDAA3B,CAA2B,uCACoB,EAAA/F,eAD/C,CAA2B,sCAEP,EAAAA,gBAC5B,oBACA,cACE,iBAAoB,wBAAE,OACtB,iBAAoB,oCAAI,OACxB,iBAAoB,8BAAG,OAEvB,iBAAoB,8BAAG,OACvB,iBAAoB,wBAAE,OAEtB,iBAAoB,oCAAI,OACxB,iBAAI,6CAAqB,EAAA8E,mBAAA,MACL,qCACpB,OACA,iBAA4B,wBAAE,OAChC,OACA,OACA,iBACA,0BA4BA,OACF,OACF,OACA,2CACF,OACF,OACF,Q,+BAlHM,8EAEuB,wCAGkD,oCACG,iCAMrE,mCAGyE,0CAenE,qCAMI,2CAkBiC,yCAC3B,8BAAe,uBAAf,CAAe,uBAAf,CAAe,gCAAf,CAAe,qCAAf,CAAe,gBAAf,CAAe,wBAAf,CAAe,kBAAf,CAAe,0BAAf,CAAe,yBAkBqB,+BAAmB,uBAOtE,iC,s+ICiSZ,aANC,YAAgB,CACbtE,MAAO,2BACPuC,QAAUiC,YAAIA,MAAM,iCAAUA,EAAK,GAAGxE,MAAQ,4BAC9CrH,KAAM,a,0BAuCV,aALC,YAAgB,CACfqH,MAAQwE,YAAIA,yCAAcA,EAAK,GAAGxE,MAAtBwE,0CACZjC,QAAS,GACT5J,KAAM,a,0RC7WI,QAAoD,yEAAY,Q,uBAChE,QAAmD,2DAAQ,Q,0BAD3D,iCACA,kC,uBADc,qCACA,6C,uBAgBV,QAAoD,yEAAY,Q,uBAChE,QAAmD,2DAAQ,Q,0BAD3D,iCACA,kC,uBADc,qCACA,6C,yBAed,uB,uBACW,qBAAkB,mB,ICjDlC6M,G,qCAAN,KAAMA,GAAN,WA6DL,WACUjN,EACAmB,EACA+L,EACA3L,EACAH,EACAC,EACA8L,EACAC,EACeC,EACGC,2BATlB,KAAAtN,UACA,KAAAmB,qBACA,KAAA+L,KACA,KAAA3L,QACA,KAAAH,cACA,KAAAC,eACA,KAAA8L,mBACA,KAAAC,YACe,KAAAC,MACG,KAAAC,MAtE5B,KAAAC,KAAO,EAEP,KAAAC,aAAe,GACf,KAAAC,kBAA8B,GAC9B,KAAAhG,MAAQ,GACR,KAAA7F,GAAK,GACL,KAAAmB,eAAiB,GACjB,KAAA2K,UAEA,KAAAC,eAAiB,IACjB,KAAAC,MAAQ,EACR,KAAAC,QAAU,EACV,KAAAC,eAAiB,GACjB,KAAAC,aACA,KAAAC,aACA,KAAAC,aACA,KAAAC,aAAoB,CAClBC,EAAG,CACDC,QAAOA,EACPC,QAAS,EACTC,OAAQ,EACRrL,MAAKA,GAEPsL,EAAG,CACDH,QAAOA,EACPC,QAAS,EACTC,OAAQ,EACRrL,MAAKA,GAEPuL,EAAG,CACDJ,QAAOA,EACPC,QAAS,EACTC,OAAQ,EACRrL,MAAKA,IAGT,KAAAwL,OAAS,KACT,KAAAC,uBACA,KAAAC,kBACA,KAAAC,qBACA,KAAAC,iBAAmBC,OAAOC,OAAO,GAAI,IAAevQ,KAAKwQ,qBAAqB,wBAC9E,KAAAC,eAAiBH,OAAOC,OAAO,GAAI,IAAevQ,KAAKwQ,qBAAqB,sBAC5E,KAAAE,YAAcJ,OAAOC,OAAO,GAAI,IAAevQ,KAAKwQ,qBAAqB,mBACzE,KAAAG,QAAU,EACV,KAAAC,IAAW,GACX,KAAAC,QAAe,GACf,KAAAC,aAAoB,GACpB,KAAAC,QAAe,GACf,KAAAC,WAAkB,GAClB,KAAAC,eAAsB,GACtB,KAAAC,QAAU,IACV,KAAAC,eACA,KAAAC,QAAU,IAAUC,aAoBlBrR,KAAK6O,IAAIyC,KAAOtR,KAzEb,wDA6EHA,KAAKuR,YACLvR,KAAKwR,mBA9EF,wCAiFY,WACf,OAAAzJ,EAAA,GAAM,KAAMvB,WAAU,WACpBxG,EAAK6O,IAAI4C,iBAAiB,YAAazR,EAAK0R,eAnF3C,oCAuFQ,WACX1R,KAAK6O,IAAI8C,oBAAoB,YAAa3R,KAAK0R,UAC/CpB,OAAOsB,KAAK5R,KAAKiR,gBAAgBY,SAAQC,YACvC9R,EAAKiR,eAAea,GAAIH,oBAAoB,YAAa3R,EAAK+R,WAC9D/R,EAAKiR,eAAea,GAAIH,oBAAoB,UAAW3R,EAAKgS,cA3F3D,kCAgGH,IAAMC,EAAUjS,KAAK+C,MAAMqC,SAAS8M,SACpClS,KAAKoD,GAAK6O,EAAQE,IAAI,MACtBnS,KAAKuE,eAAiB0N,EAAQE,IAAI,QAClCnS,KAAKgP,aAAeiD,EAAQE,IAAI,kBAnG7B,oCAsGSjB,GACZlR,KAAKkR,QAAUA,IAvGZ,uCA0GW,WACdlR,KAAKoS,eAAe,IACJ,MAAZpS,KAAKoD,IACPpD,KAAKkP,UACLlP,KAAKiJ,MAAQ,eAAK,YAAQjJ,KAAKuE,eAAgB,mBAE/CvE,KAAKkP,UACLlP,KAAKiJ,MAAQ,eAAK,YAAQjJ,KAAKuE,eAAgB,iBAC/CvE,KAAK2C,mBAAmBwG,kBAAkBnJ,KAAKoD,GAAIpD,KAAKuE,gBAAgBiC,WAAUE,YAC1D,MAAlBA,EAAOC,QACT3G,EAAKoS,eAAe1L,EAAOE,SAE5BrF,YACDvB,EAAKwB,QAAQoK,QAAQjE,KAAKC,UAAUrG,UAvHrC,uCA4HY0H,GACf,OAAOA,EAAMoJ,QAAQ,WAAY,IAAIA,QAAQ,UAAW,KAAKA,QAAQ,MAAO,KAAKA,QAAQ,mBAAoB,KAAKlM,SA7H/G,uCAkIEnG,KAAK0P,aAAa1P,KAAK2Q,SAASlM,OACnCzE,KAAK0P,aAAa1P,KAAK2Q,SAASlM,QAChCzE,KAAKiR,eAAejR,KAAK2Q,SAASc,iBAAiB,YAAazR,KAAK+R,WACrE/R,KAAKiR,eAAejR,KAAK2Q,SAASc,iBAAiB,UAAWzR,KAAKgS,YArIlE,8BA0IG3Q,GACN,IAAMiQ,EAAQtR,KAAasR,KAC3BA,EAAK5B,aAAa4B,EAAKX,SAASf,YA5I7B,gCA+IKvO,GACR,IAAMiQ,EAAQtR,KAAasR,KACrBT,EAAUS,EAAKT,QAAQS,EAAKX,SAClC,GAAKW,EAAK,WAAaA,EAAKX,SAA5B,CAGA,IAAM2B,EAAQjR,GAAKiQ,EAAKzC,IAAIyD,MAC5BhB,EAAK5B,aAAa4B,EAAKX,SAASd,QAC9ByC,EAAMC,QAAU1B,EAAQ2B,WAC1BlB,EAAK5B,aAAa4B,EAAKX,SAASb,OAC9BwC,EAAMG,QAAU5B,EAAQ6B,UAC1BpB,EAAK5B,aAAa4B,EAAKX,SAASf,aA1J7B,+BA8JI+C,GACP3S,KAAK2Q,QAAUgC,EACV3S,KAAK4Q,IAAI+B,KACZ3S,KAAK4Q,IAAI+B,GAAK3S,KAAK8O,IAAI8D,eAAe,SAAWD,GACjD3S,KAAK6Q,QAAQ8B,GAAK3S,KAAK4Q,IAAI+B,GAAGE,iBAAiB,iCAAiC,GAChF7S,KAAK8Q,aAAa6B,GAAK3S,KAAK4Q,IAAI+B,GAAGE,iBAAiB,uBAAuB,GAC3E7S,KAAK+Q,QAAQ4B,GAAK3S,KAAK8O,IAAI8D,eAAe,cAAgBD,GAC1D3S,KAAKgR,WAAW2B,GAAK3S,KAAK8O,IAAI8D,eAAe,kBAAoBD,GACjE3S,KAAKiR,eAAe0B,GAAK3S,KAAK8O,IAAI8D,eAAe,cAAgBD,GACjE3S,KAAK6Q,QAAQ8B,GAAGrB,KAAOtR,KACvBA,KAAKiR,eAAe0B,GAAGrB,KAAOtR,MAEhCA,KAAK8S,iBACL9S,KAAK,WAAa2S,IAAM3S,KAAK,WAAa2S,GACtC3S,KAAK,WAAa2S,GACpB3S,KAAK+S,UAAUJ,GAEf3S,KAAKgT,WAAWL,KA/Kf,gCAmLKA,GACR3S,KAAK4O,UAAUqE,SAASjT,KAAK8Q,aAAa6B,GAAI,aAAc3S,KAAK6Q,QAAQ8B,GAAGO,aAAe,MAC3FlT,KAAK4O,UAAUqE,SAASjT,KAAK6Q,QAAQ8B,GAAI,gBAAiB,kBAC1D3S,KAAKmT,SAASnT,KAAK+Q,QAAQ4B,IAC3B3S,KAAKmT,SAASnT,KAAKgR,WAAW2B,IAC9B3S,KAAKmT,SAASnT,KAAK6Q,QAAQ8B,IAC3B3S,KAAKmT,SAASnT,KAAKiR,eAAe0B,MAzL/B,iCA4LMA,GAAEA,IACJ/D,EAAa5O,KAAd,UACN4O,EAAUwE,gBAAgBpT,KAAK8Q,aAAa6B,GAAI,SAChD/D,EAAUwE,gBAAgBpT,KAAKgR,WAAW2B,GAAI,SAC9C/D,EAAUwE,gBAAgBpT,KAAK+Q,QAAQ4B,GAAI,SAC3C/D,EAAUwE,gBAAgBpT,KAAK6Q,QAAQ8B,GAAI,SAC3C/D,EAAUwE,gBAAgBpT,KAAKiR,eAAe0B,GAAI,WAlM/C,+BAqMItR,GACP,IAAMiQ,EAAQ+B,OAAe/B,KACvBgB,EAAQjR,GAAKiQ,EAAKzC,IAAIyD,MAC5BhC,OAAOsB,KAAKN,EAAK5B,cAAc4D,OAAM,SAACxB,EAAIyB,GACxC,IAAIjC,EAAK5B,aAAaoC,GAAIlC,OAiCxB,OAAM,EAhCN,IACMiB,EADMS,EAAKxC,IAAI8D,eAAe,SAAWW,GAC3BV,iBAAiB,iCAAiC,GAChE9B,EAAUO,EAAKxC,IAAI8D,eAAe,cAAgBW,GAClDvC,EAAaM,EAAKxC,IAAI8D,eAAe,kBAAoBW,GACzDC,EAAclC,EAAKxC,IAAI8D,eAAe,cAAgBW,GAC5D,CAACxC,EAASC,EAAYH,EAAS2C,GAAa3B,SAAQ,SAAC4B,EAASC,GAC3C,IAAbA,GACFD,EAAQxG,MAAM0G,KACZrB,EAAMC,QAAUjB,EAAK5B,aAAaoC,GAAIjC,QAAU,KAClD4D,EAAQxG,MAAM2G,IACZtB,EAAMG,QAAUnB,EAAK5B,aAAaoC,GAAIhC,OAAS,MAC3B,IAAb4D,GACTD,EAAQxG,MAAM0G,KACZrB,EAAMC,QACNjB,EAAK5B,aAAaoC,GAAIjC,QACrBgB,EAAQ1I,YAAc,EACtBmJ,EAAKL,eAAea,GAAI3J,YAAc,EACvC,KACFsL,EAAQxG,MAAM2G,IACZtB,EAAMG,QAAUnB,EAAK5B,aAAaoC,GAAIhC,OAAS,GAAK,OAEtD2D,EAAQxG,MAAM0G,KACZrB,EAAMC,QACNjB,EAAK5B,aAAaoC,GAAIjC,QACtBgB,EAAQ1I,YACR,KACFsL,EAAQxG,MAAM2G,IACZtB,EAAMG,QAAUnB,EAAK5B,aAAaoC,GAAIhC,OAAS,cArOtD,+BA+OIc,GACD5I,MAAQ4I,EAAIzI,YAAc,KAC1ByL,EAAMhD,EAAIiD,wBAAwBD,IAAM,KACxCD,EAAO/C,EAAIiD,wBAAwBF,KAAO,KACzC/E,EAAa5O,KAAd,UACN4O,EAAUqE,SAASrC,EAAK,WAAY,SACpChC,EAAUqE,SAASrC,EAAK,aAAc,SACtChC,EAAUqE,SAASrC,EAAK,UAAW,OACnChC,EAAUqE,SAASrC,EAAK,QAAS5I,GACjC4G,EAAUqE,SAASrC,EAAK,MAAOgD,GAC/BhF,EAAUqE,SAASrC,EAAK,OAAQ+C,GAChC/E,EAAUqE,SAASrC,EAAK,YAAa,aA1PlC,2CA6PgBkD,GACnB,MAAO,CACLC,YAAa/T,KAAKgU,YAAYF,GAC9BG,YAAajU,KAAKgU,YAAYF,MAhQ7B,kCAoQOA,GACV,IAAMxC,EAAOtR,KACb,OAAQkU,YAAIA,OACV5C,EAAKwC,MACE,IAAI9J,SAAQ,SAACC,EAASkK,GAc3B7C,EAAK3C,iBACFyF,UAAUF,EAAM,KAAUG,QAC1B7N,WAfcqC,YACfyI,EAAKwC,MACDjL,EACFoB,EAAQ,CAACpB,IAAKQ,EAAA,EAAYI,QAAUZ,IAEpCyI,EAAK9P,QAAQoK,QAAQ,+BAGVlE,YACb4J,EAAKwC,MACLxC,EAAK9P,QAAQoK,QAAQ,4BACrBuI,EAAOzM,YApRV,kCA6RKM,eAAD,MACDC,EAAOjI,KAAKkI,eACblI,KAAKkI,cAAclH,eACnBhB,KAAKkI,cAAclH,cAAcmH,YAEpCF,GAAUjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAKH,GAE7DC,GAASjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAMH,IAIjEI,qBAAqBpI,KAAK+O,KAC1B/O,KAAK+O,IAAM1G,uBAAsB,WAE/BrI,EAAKgI,MAAQA,QA3SZ,qCA+SUpB,OACNrC,EAA0BvE,KAA3B,eAAiBkP,EAAUlP,KAAZ,OACdoD,EAAoFwD,EAArF,GAAKqC,EAAgFrC,EAAlF,MAASpC,EAAyEoC,EAA3E,iBAAoB3G,EAAuD2G,EAAzD,WAAc0N,EAA2C1N,EAA7C,MAAS2N,EAAoC3N,EAAtC,SAAY4N,EAA0B5N,EAA5B,WAAc6N,EAAc7N,EAAhB,WAC3E5G,KAAK0U,aAAe1U,KAAK0O,GAAGiG,MAAM,CAChCvR,GAAI,CAAC8L,EAAS9L,EAAK,IACnBwR,OAAQ,CAAC,IACThT,KAAM,CAAC2C,GACPA,eAAgB,CAACA,GACjB0E,MAAO,CAACiG,EAASjG,EAAQ,GAAI,CAAC,IAAW4L,SAAU,eAAkB,IAAWC,UAAU,MAC1FtQ,iBAAkB,CAAC0K,EAAS1K,EAAmB,GAAI,CAAC,IAAWqQ,WAC/D5U,WAAY,CAACiP,EAASjP,EAAa,GAAI,CAAC,IAAW4U,WACnDP,MAAO,CAACpF,EAASoF,EAAQ,IACzBC,SAAU,CAACrF,EAASqF,EAAW,IAC/BQ,iBAAkB,CAAC7F,EAASsF,EAAWxN,KAAIgO,YAAGA,MAAI,CAChD9L,KAAM8L,EAAIlL,eACVmL,KAAMD,EAAIE,eACVjM,MAAO+L,EAAIlL,mBACP,IACN2K,WAAY,CAACvF,EAASuF,EACF,SAAjBzU,KAAKoR,QAAqB,2BAAS,2BAAS,CAAC,IAAWyD,SAAU,eAAkB,IAAWC,UAAU,QAE1G5F,GAAUtI,EAAKuO,eAAe,GAAG3R,mBACnCxD,KAAKiP,kBAAoBjP,KAAKsP,eAAiB1I,EAAKuO,eAAenO,KAAI,qBAAExD,uBArUxE,mCAyUO,aAC4BxD,KAAK0U,aAAajU,MAAjDR,EADG,EACJ,WAAasU,EADT,EACO,SAAYD,EADnB,EACiB,MAE3B,IAAK,IAAM3B,KAAK3S,KAAK0U,aAAaU,SAChCpV,KAAK0U,aAAaU,SAASzC,GAAG0C,cAC9BrV,KAAK0U,aAAaU,SAASzC,GAAG2C,yBAEhC,GAAItV,KAAK0U,aAAaa,QACpBvV,KAAKwB,QAAQoK,QAAQ,2EAGvB,GAAI5L,KAAKwV,iBAAiBvV,GAAc,IACtCD,KAAKwB,QAAQoK,QAAQ,+DAGvB,GAAI5L,KAAKwV,iBAAiBjB,GAAY,IACpCvU,KAAKwB,QAAQoK,QAAQ,+DAGvB,GAAI5L,KAAKwV,iBAAiBlB,GAAS,IACjCtU,KAAKwB,QAAQoK,QAAQ,0EADvB,CAIA,IAAM6J,EAAW9N,KAAK+N,MAAM/N,KAAKC,UAAU5H,KAAK0U,aAAajU,QAEzDT,KAAKiP,kBAAkB9I,QACzBsP,EAASE,UAAY,EACrBF,EAASb,OAAS5U,KAAKiP,kBAAkBjI,KAAKgO,YAAGA,OAAaA,OAE9DS,EAASE,UAAY,EACrBF,EAASb,OAAS,CAAC5U,KAAK4V,cAAc7O,MAAM,GAAG3D,KAEjD,IAAMyS,EAAaJ,EAASV,iBAAiB/N,KAAIgO,YAAGA,MAAI,CACtDlL,eAAgBkL,EAAI9L,KACpBgM,eAAgBF,EAAIC,KACpBa,eAAgB,IAAUC,OAAOf,EAAIC,MACrCe,eAAgB,OAElBP,EAASQ,YAATR,mBAA2BI,UACpBJ,EAASV,iBACK,IAAjB/U,KAAKqP,SAAmD,IAAlCrP,KAAKiP,kBAAkB9I,OAC/CnG,KAAK6C,aAAa+I,QAAQ,CACxBC,QAAS,+GACTE,aAAc,eACdC,SAAU,eACVC,OAAQ,kBACCjM,EAAKkW,aAAaT,MAIF,IAAvBA,EAASE,UACX3V,KAAK6C,aAAa+I,QAAQ,CACxBC,QAAS,mJACTE,aAAc,eACdC,SAAU,eACVC,OAAQ,kBACCjM,EAAKkW,aAAaT,MAI7BzV,KAAKkW,aAAaT,MArYnB,mCA2YQA,GAASA,WACpB,OAAO,IAAIzL,SAASC,YAClBjK,EAAKmR,eACLnR,EAAK2C,mBAAmBwT,SAASV,GAAUjP,WAAUE,YACnD1G,EAAKmR,eACiB,MAAlBzK,EAAOC,QACTsD,GAAQA,GACRjK,EAAK6J,WAEiB,MAAlBnD,EAAOC,QACT3G,EAAKwB,QAAQD,MAAM,8CAErB0I,GAAQA,OAETvC,YACDuC,GAAQA,GACRjK,EAAKmR,eACLnR,EAAKwB,QAAQD,MAAMoG,KAAKC,UAAUF,YA5ZnC,iCAkaMgB,GACT1I,KAAKiP,kBAAoBjP,KAAKoW,kBAAkB1N,GAChD,IAAM2N,EAAM,CAAChH,QAAS,GACtBrP,KAAKsW,YAAY5N,EAAS2N,GAC1BrW,KAAKqP,QAAUgH,EAAIhH,UAtahB,kCAyaO3G,EAAS2N,GAAIA,WACnB3N,EAAQvC,QACVuC,EAAQmJ,SAASxQ,YACXA,EAAEkV,QAAUlV,EAAEkV,OAAOC,UAAYnV,EAAEkV,OAAOC,SAASrQ,QACrDnG,EAAKsW,YAAYjV,EAAEmV,SAAUH,GAE3BA,EAAIhH,QAAUhO,EAAEkV,OAAO5N,QACzB0N,EAAIhH,QAAUhO,EAAEkV,OAAO5N,YAhb1B,wCAuba8N,GAChB,IAAM7E,EAAiB,GAkBvB,OAjBmB8E,SAAbC,EAAaD,GAEjB,IAAK,IAAI/D,EAAI,EAAGA,EAAI+D,EAAYvQ,OAAQwM,IAAK,CAC3C,IAAMiE,EACJF,EAAY/D,aAAc,KACtB+D,EAAY/D,GAAG4D,OACfG,EAAY/D,GACdiE,EAAKJ,UAAYI,EAAKJ,SAASrQ,OAAS,EAC1CwQ,EAAUC,EAAKJ,UAEXI,EAAKC,QAAUD,EAAKE,SAA2B,MAAfF,EAAKjO,OACvCiJ,EAAKlG,KAAKkL,EAAKxT,KAKvBuT,CAAUF,GACH7E,IA1cJ,+BA8cH5R,KAAK4C,YAAYiH,QAAOA,GACxB7J,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,aACLC,SAAU,GACVG,MAAO,yBAldN,sCAudWqJ,GACd,GAAsB,KAAlBA,EAAMyE,QAER,OADAzE,EAAM0E,yBAzdL,M,oCAAMvI,IAAqB,sFAsEtB,MAAM,KACN,O,wBAvECA,GAAqB,0D,MAAA,M,2nJD1BlC,gBACE,oBACE,oBAGS,oCAAY,EAAAnB,SAAA,MACnB,cAAgD,kGAAgB,OAChE,kBACE,sCAIE,sCAAc,EAAA2J,WAAA,MAIhB,OACF,OACA,6BACE,iBACE,gBACF,OACF,OACF,OACA,sBACE,gBAAuB,SAAS,OAChC,mBACE,wBACE,4BAC6B,qCAC7B,OACA,8BACE,oBAIO,sCAAe,EAAAC,eAAf,CAA4B,8BACjB,EAAAF,gBAAA,MALlB,OAOA,mBAAiC,SAAsC,OACvE,2CAIF,OACF,OACA,kBACE,kBACE,wBACE,4BAC6B,qCAC7B,OACA,8BACE,oBAEyC,sCAAe,EAAAE,gBAFxD,OAGA,mBAAiC,SAA4C,OAC7E,2CAIF,OACF,OACF,OACF,OACA,kBACE,kBACE,wBACE,4BACC,qCACD,OACA,8BACE,wBAEE,+BAEF,OACF,OACF,OACF,OACF,OACA,wBACE,4BAA2F,qCAC3F,OACA,8BAEE,sBAEE,uBAEA,mBAEiG,SAC1F,OACT,OACA,gBAGF,OACA,gBAEG,gCAAS,EAAAC,SAAS,MACsC,OAC3D,gBAEG,gCAAS,EAAAA,SAAS,MACsC,OAC7D,OACA,wBACE,4BAAgF,oCAAI,OACpF,8BAGE,yBAKE,yCAAiB,EAAAC,cAAA,MAGjB,qBAAkB,gBAA+B,gBAAM,oCAAI,OAAO,OACpE,OACF,OACF,OACA,wBACE,4BACyD,qCACzD,OACA,8BACE,sBAEE,uBAGA,mBAE+F,SACxF,OACT,OACA,gBAGF,OACA,gBAEG,gCAAS,EAAAD,SAAS,MACsC,OAC3D,gBAEG,gCAAS,EAAAA,SAAS,MACsC,OAC7D,OACA,2BACE,4BAAgF,qCAChF,OACA,8BACE,sBAEE,uBAGA,mBAE4F,SACrF,OACT,OACA,gBAGF,OACA,gBAEG,gCAAS,EAAAA,SAAS,MACsC,OAC3D,gBAEG,gCAAS,EAAAA,SAAS,MACsC,OAC7D,OACF,OACA,kBACE,qBACoC,gCAAS,EAAAtN,YAAU,yBACvD,OACA,qBAAmC,gCAAS,EAAAqN,gBAA6E,wBAAE,OAC7H,OACF,OACF,OACF,Q,oBAzLa,mCAMH,4CAA6B,sCAA7B,CAA6B,cAA7B,CAA6B,eAeV,sBACT,yCAEK,uBAAU,WAGR,wBAAW,UAAX,CAAW,gBAQO,yDAUhB,uBAAU,WAGR,wBAAW,UAAX,CAAW,gBAIO,yGAYpB,uBAAU,WAGR,wBAAW,WAGb,yCAQJ,uBAAU,WAER,wBAAW,WAEjB,iDAAkC,aAE/B,gCAAiB,6BAIzB,sGAA+F,8EAG1E,mEAOxB,mEAIA,mEAGY,uBAAU,WACR,wBAAW,WAOxB,4BASW,uBAAU,WAGR,wBAAW,WACjB,+CAAgC,aAE7B,gCAAiB,2BAKzB,oGAA6F,4EAGxE,mEAOxB,mEAIA,mEAGY,uBAAU,WAER,wBAAW,WACjB,4CAA6B,aAE1B,gCAAiB,wBAKzB,iGAA0F,yEAGnD,mEAO1C,mEAIA,mEAOqD,+CAAoC,6B,y1EEhKvC,e,2BAAkE,yBAA2B,qC,uBAGpJ,cAAK,kEAAe,OACpB,cAAK,wEAAW,OAChB,cAAK,2FAAoB,Q,+EAGzB,iBACE,iBACE,uBACE,2BAAgE,8BAChE,OACA,6BACE,mBAAgB,yEAAhB,OACF,OACF,OACF,OACF,O,qBAPqB,uBAAU,WAER,wBAAW,WACV,sCAAyB,4BAAzB,CAAyB,gB,yBAcvC,uB,uBACW,qBAAkB,mB,uBAkB7B,QAAoD,yEAAY,Q,uBAChE,QAAmD,2DAAQ,Q,0BAD3D,iCACA,kC,uBADc,qCACA,6C,sCAZtB,iBACE,uBACE,2BAC6B,oCAC7B,OACA,6BACE,mBAEyC,qEAFzC,OAGA,kBAAiC,QAAuC,OACxE,0CAIF,OACF,OACF,O,+BAdmB,uBAAU,WAGR,wBAAW,UAAX,CAAW,gBAIO,gG,uBAiD/B,QAAoD,yEAAY,Q,uBAChE,QAAmD,2DAAQ,Q,0BAD3D,iCACA,kC,uBADc,qCACA,6C,uBAiCd,QAAoD,yEAAY,Q,uBAChE,QAAmD,2DAAQ,Q,0BAD3D,iCACA,kC,uBADc,qCACA,6C,sCAbxB,iBACE,iBACE,uBACE,2BAC6B,oCAC7B,OACA,6BACE,mBAEyC,qEAFzC,OAGA,kBAAiC,QAA+C,OAChF,0CAIF,OACF,OACF,OACF,O,gCAfqB,uBAAU,WAGR,wBAAW,UAAX,CAAW,gBAIO,gHCrI1C,IAAMG,GAAN,KAAMA,GAAN,WAsBL,WACU7V,EACAmB,EACAC,EACA8L,EACA3L,EACAF,2BALA,KAAArB,UACA,KAAAmB,qBACA,KAAAC,cACA,KAAA8L,KACA,KAAA3L,QACA,KAAAF,eA3BV,KAAAkM,KAAO,EAEP,KAAAC,aAAe,GACf,KAAAC,kBAA8B,GAC9B,KAAAhG,MAAQ,GACR,KAAA7F,GAAK,GACL,KAAAmB,eAAiB,GACjB,KAAA2K,UAEA,KAAAC,eAAiB,IACjB,KAAAmI,iBACA,KAAAhI,eAAiB,GACjB,KAAAD,QAAU,EACV,KAAAkI,YAAc,GACd,KAAAhP,KAAO,GAIC,KAAA6I,QAAU,IAAUC,aAnBvB,wDAkCHrR,KAAKuR,YACLvR,KAAKwR,mBAnCF,uCAsCW,WACE,MAAZxR,KAAKoD,IACPpD,KAAKkP,UACLlP,KAAKiJ,MAAQ,eAAK,YAAQjJ,KAAKuE,eAAgB,iBAC/CvE,KAAKoS,eAAe,MAEpBpS,KAAKkP,UACLlP,KAAKiJ,MAAQ,eAAK,YAAQjJ,KAAKuE,eAAgB,iBAC/CvE,KAAKoS,eAAe,IACpBpS,KAAK2C,mBAAmBwG,kBAAkBnJ,KAAKoD,GAAIpD,KAAKuE,gBAAgBiC,WAAUE,YAC1D,MAAlBA,EAAOC,SACT3G,EAAKuX,YAAc7Q,EAAOE,KAAK2Q,YAC/BvX,EAAKoS,eAAe1L,EAAOE,aAlD9B,kCAyDH5G,KAAKuI,KAAOvI,KAAK+C,MAAMqC,SAASC,YAAYkD,KAC5C,IAAM0J,EAAUjS,KAAK+C,MAAMqC,SAAS8M,SACpClS,KAAKoD,GAAK6O,EAAQE,IAAI,MACtBnS,KAAKuE,eAAiB0N,EAAQE,IAAI,QAClCnS,KAAKgP,aAAeiD,EAAQE,IAAI,kBA7D7B,kCAgEKnK,eAAD,MACDC,EAAOjI,KAAKkI,eACblI,KAAKkI,cAAclH,eACnBhB,KAAKkI,cAAclH,cAAcmH,YAEpCF,GAAUjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAKH,GAE7DC,GAASjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAMH,IAIjEI,qBAAqBpI,KAAK+O,KAC1B/O,KAAK+O,IAAM1G,uBAAsB,WAE/BrI,EAAKgI,MAAQA,QA9EZ,qCAkFUpB,OACNxD,EAAoGwD,EAArG,GAAKpC,EAAgGoC,EAAlG,iBAAoBkD,EAA8ElD,EAAhF,eAAkB4C,EAA8D5C,EAAhE,YAAeqC,EAAiDrC,EAAnD,MAAS6N,EAA0C7N,EAA5C,WAAc4Q,EAA8B5Q,EAAhC,cAAiB6Q,EAAe7Q,EAAjB,YAC1F5G,KAAK0U,aAAe1U,KAAK0O,GAAGiG,MAAM,CAChCvR,GAAI,CAACpD,KAAKkP,OAAS9L,EAAK,IACxBwR,OAAQ,CAAC,IACT3L,MAAOjJ,KAAKkP,OAAS,CAACtI,EAAKqC,MAAO,CAAC,IAAW4L,SAAU,eAAkB,IAAWC,UAAU,MAAQ,CAAC,GAAI,IAC5GlT,KAAM,CAAC5B,KAAKuE,gBACZA,eAAgB,CAACvE,KAAKuE,gBACtBC,iBAAkB,CAACxE,KAAKkP,OAAS1K,EAAmB,GAAI,CAAC,IAAWqQ,WACpE6C,cAAe,CAAC1X,KAAKkP,OAAS,CAAC,CAAChG,KAAMY,EAAgBmL,KAAMzL,EAAaP,UAAU,IACnFwL,WAAY,CAACzU,KAAKkP,OAASuF,EACP,SAAjBzU,KAAKoR,QAAqB,2BAAS,2BAAS,CAAC,IAAWyD,SAAU,eAAkB,IAAWC,UAAU,MAC5G0C,cAAe,CAACxX,KAAKkP,OAASsI,EACV,SAAjBxX,KAAKoR,QAAqB,2BAAS,2BAAS,CAAC,IAAWyD,SAAU,eAAkB,IAAWC,UAAU,MAC5G2C,YAAa,CAACzX,KAAKkP,OAASuI,EAAc,IAAK,CAAC,IAAW5C,aAEzD7U,KAAKkP,QAAUtI,EAAKuO,gBAAkBvO,EAAKuO,eAAe,IAAMvO,EAAKuO,eAAe,GAAG3R,mBACzFxD,KAAKiP,kBAAoBjP,KAAKsP,eAAiB1I,EAAKuO,eAAenO,KAAI,qBAAExD,uBAnGxE,mCAuGO,WAOV,IAAK,IAAMmP,IANiC,MAAxC3S,KAAK0U,aAAajU,MAAMgX,YAC1BzX,KAAK0U,aAAavC,IAAI,iBAAiBwF,kBAEvC3X,KAAK0U,aAAavC,IAAI,iBAAiByF,cAAc,CAAC,IAAW/C,SAAU,eAAkB,IAAWC,UAAU,MAGpG9U,KAAK0U,aAAaU,SAChCpV,KAAK0U,aAAaU,SAASzC,GAAG0C,cAC9BrV,KAAK0U,aAAaU,SAASzC,GAAG2C,yBAEhC,GAAItV,KAAK0U,aAAaa,QACpBvV,KAAKwB,QAAQoK,QAAQ,wDADvB,CAIA,IAAM6J,EAAW9N,KAAK+N,MAAM/N,KAAKC,UAAU5H,KAAK0U,aAAajU,QAW7D,GAVAgV,EAAS7T,KAAO5B,KAAKuE,eACrBkR,EAASlR,eAAiBvE,KAAKuE,eAE3BvE,KAAKiP,kBAAkB9I,QACzBsP,EAASE,UAAY,EACrBF,EAASb,OAAS5U,KAAKiP,kBAAkBjI,KAAKgO,YAAGA,OAAaA,OAE9DS,EAASE,UAAY,EACrBF,EAASb,OAAS,CAAC5U,KAAK4V,cAAc7O,MAAM,GAAG3D,KAEX,IAAlCqS,EAASiC,cAAcvR,OAA3B,CAIA,IAAI0R,KACJ,GAAI7X,KAAKkP,OACPuG,EAASqC,gBAAkBrC,EAASiC,cAAc1Q,KAAKgO,YAAGA,OACnDA,EAAIC,OACP4C,MAEK,CACL/N,eAAgBkL,EAAI9L,KACpBgM,eAAgBF,EAAIC,KACpBhM,MAAOwM,EAASxM,cAGf,CACLwM,EAASqC,gBAAkB,GAE3B,IAAK,IAAInF,EAAI,EAAGA,EAAI8C,EAASiC,cAAcvR,OAAQwM,IAAK,CACtD,IAAMqC,EAAMS,EAASiC,cAAc/E,GASnC,GARKqC,EAAIC,OACP4C,MAEFpC,EAASqC,gBAAgBpM,KAAK,CAC5B5B,eAAgBkL,EAAI9L,KACpBgM,eAAgBF,EAAIC,KACpBhM,MAAO+L,EAAI/L,SAER+L,EAAI/L,MAEP,YADAjJ,KAAKwB,QAAQoK,QAAQ,qDAKvBiM,EACF7X,KAAKwB,QAAQoK,QAAQ,kEAGhB6J,EAASiC,cAGK,IAAjB1X,KAAKqP,SAAmD,IAAlCrP,KAAKiP,kBAAkB9I,OAC/CnG,KAAK6C,aAAa+I,QAAQ,CACxBC,QAAS,+GACTE,aAAc,eACdC,SAAU,eACVC,OAAQ,kBACCjM,EAAKkW,aAAaT,MAIF,IAAvBA,EAASE,UACX3V,KAAK6C,aAAa+I,QAAQ,CACxBC,QAAS,mJACTE,aAAc,eACdC,SAAU,eACVC,OAAQ,kBACCjM,EAAKkW,aAAaT,MAI7BzV,KAAKkW,aAAaT,SA7DpBzV,KAAKwB,QAAQoK,QAAQ,qCAlIpB,mCAoMQ6J,GAASA,WACpB,OAAO,IAAIzL,SAASC,YAClBjK,EAAKsX,iBACLtX,EAAK2C,mBAAmBoV,eAAetC,GAAUjP,WAAUE,YACzD1G,EAAKsX,iBACiB,MAAlB5Q,EAAOC,QACTsD,GAAQA,GACRjK,EAAK6J,WAEiB,MAAlBnD,EAAOC,QACT3G,EAAKwB,QAAQD,MAAM,8CAErB0I,GAAQA,OAET,WACDA,GAAQA,GACRjK,EAAKsX,yBApNN,iCA0NM5O,GACT1I,KAAKiP,kBAAoBjP,KAAKoW,kBAAkB1N,GAChD,IAAM2N,EAAM,CAAChH,QAAS,GACtBrP,KAAKsW,YAAY5N,EAAS2N,GAC1BrW,KAAKqP,QAAUgH,EAAIhH,UA9NhB,kCAiOO3G,EAAS2N,GAAIA,WACnB3N,EAAQvC,QACVuC,EAAQmJ,SAASxQ,YACXA,EAAEkV,QAAUlV,EAAEkV,OAAOC,UAAYnV,EAAEkV,OAAOC,SAASrQ,QACrDnG,EAAKsW,YAAYjV,EAAEmV,SAAUH,GAE3BA,EAAIhH,QAAUhO,EAAEkV,OAAO5N,QACzB0N,EAAIhH,QAAUhO,EAAEkV,OAAO5N,YAxO1B,wCA8Oa8N,GAChB,IAAM7E,EAAiB,GAkBvB,OAjBmB8E,SAAbC,EAAaD,GAEjB,IAAK,IAAI/D,EAAI,EAAGA,EAAI+D,EAAYvQ,OAAQwM,IAAK,CAC3C,IAAMiE,EACJF,EAAY/D,aAAc,KACtB+D,EAAY/D,GAAG4D,OACfG,EAAY/D,GACdiE,EAAKJ,UAAYI,EAAKJ,SAASrQ,OAAS,EAC1CwQ,EAAUC,EAAKJ,UAEXI,EAAKC,QAAUD,EAAKE,SAA2B,MAAfF,EAAKjO,OACvCiJ,EAAKlG,KAAKkL,EAAKxT,KAKvBuT,CAAUF,GACH7E,IAjQJ,+BAqQH5R,KAAK4C,YAAYiH,QAAOA,GACxB7J,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,aACLC,SAAU,GACVG,MAAO,2BAzQN,M,oCAAMoO,IAAsB,8D,wBAAtBA,GAAsB,2D,MAAA,M,s5FDlBnC,gBACE,oBACE,oBAGS,oCAAY,EAAA/J,SAAA,MACnB,cAA+C,iGAAgB,OAC/D,kBACE,sCAIE,sCAAc,EAAA2J,WAAA,MAIhB,OACF,OACA,6BACE,iBACE,gBACF,OACF,OACF,OACA,sBACE,gBAA+C,SAAU,uBACzD,OACA,2CAKA,mBACE,yBAWA,kBACE,kBACE,wBACE,4BACwC,qCACxC,OACA,8BACE,wBAEE,+BAEF,OACF,OACF,OACF,OACF,OACA,kBACE,0BAiBF,OACA,kBACE,kBACE,2BACE,4BAAiG,qCACjG,OACA,8BACE,yBAUE,gBACE,gBACF,OACA,gBAA2B,0FAAa,OACxC,gBACE,SACF,OACF,OACF,OACF,OACF,OACF,OACA,kBACE,kBACE,wBACE,4BAC6B,qCAC7B,OACA,8BACE,oBAEyC,sCAAe,EAAAC,gBAFxD,OAGA,mBAAiC,SAA4C,OAC7E,2CAIF,OACF,OACF,OACF,OACA,kBACE,kBACE,wBACE,4BAC6B,qCAC7B,OACA,8BACE,6BACE,oBAA4B,wBAAE,OAC9B,oBAA4B,wBAAE,OAChC,OACF,OACF,OACF,OACF,OACA,0BAmBF,OACA,kBACE,qBAAmC,gCAAS,EAAArN,YACR,yBACpC,OACA,qBACQ,gCAAS,EAAAqN,gBAAc,yBAC/B,OACF,OACF,OACF,OAEF,Q,oBAxKa,mCAMH,4CAA6B,sCAA7B,CAA6B,cAA7B,CAA6B,eAec,6BAAwG,8CAOvH,yCAClB,8BAcS,uBAAU,WAGR,wBAAW,WAGb,yCAQK,8BAqBL,uBAAU,WAER,wBAAW,WAQxB,uDALA,kBAAe,cAAf,CAAe,6CAAf,CAAe,WAAf,CAAe,kGAab,iMAUS,uBAAU,WAGR,wBAAW,UAAX,CAAW,gBAIO,yGAYpB,uBAAU,WAGR,wBAAW,WAStB,4DAwBuB,4C,w9DErK3C,4B,yBACA,+B,kBAAyC,qBCUlC,IAAMc,GAAN,KAAMA,GAAN,WAIL,WACUjV,2BAAA,KAAAA,QAHV,KAAAnB,KAAO,GAFF,wDAUH5B,KAAK4B,KAAO5B,KAAK+C,MAAMqC,SAAS8M,SAASC,IAAI,YAV1C,M,oCAAM6F,IAA2B,Y,wBAA3BA,GAA2B,wIDXxC,qCACA,uC,MADmB,4BACC,sC,sHEAlB,QACE,eAAiB,kFACf,iBAAqB,QAAe,OACtC,OACF,O,mCAH8C,iDACrB,sBCMpB,IAAMC,GCFAC,GDEN,KAAMD,GAAN,WAML,aAAa,wBAJJ,KAAAE,MAA8C,GAE7C,KAAAC,WAAa,IAAI,IAJtB,4FAWM7U,GACTvD,KAAKoY,WAAWC,KAAK9U,OAZlB,M,oCAAM0U,K,wBAAAA,GAAgB,oRDT7B,eACE,gCAKF,Q,MALgB,kC,uOEMT,KAAMC,GAAN,WAKL,aAAa,wBALR,mE,oCAAMA,K,wBAAAA,GAAsB,uZ,GAAA,MCPnC,sBACE,gBACE,cACE,QACF,OACA,cACE,sBAEF,OACF,OACA,wBACE,0BAEA,yBACE,oCACA,uCACF,OAEA,iBACE,6BAGA,iBAAqB,aAAC,OACtB,6BAEF,OACF,OAEA,sBACE,qBAGF,OACF,Q,oBA9BM,8BAiBE,qCAAwB,oBAG0B,mCAAsB,oBAKvE,0BAEH,iC,syBCgBI,cACE,6BAEF,Q,kBAFmB,gGAAyC,kF,yBAQtD,iB,4BAAyB,gD,yBACzB,iB,4BAA2C,2C,sCAH/C,QACE,eAAwB,yFACtB,wBACA,wBACA,eAAM,QAAyB,OACjC,OAEF,O,0BALS,0CACA,qEACC,gC,sCAoBtB,wCAE4B,wEAAgC,O,qBAFhC,4CAAqC,8BAArC,CAAqC,8B,IC1DpDI,G,qCAAN,KAAMA,GAAN,WA0BL,WACU3V,EACAI,EACAH,EACA2V,EACA/W,EACAmN,EACAC,EACkBE,2BAPlB,KAAAnM,qBACA,KAAAI,QACA,KAAAH,cACA,KAAA2V,gBACA,KAAA/W,UACA,KAAAmN,mBACA,KAAAC,YACkB,KAAAE,MAhC5B,KAAAlI,KAAY,GAEZ,KAAAxD,GAAK,GACL,KAAAxB,KAAO,GACP,KAAAoN,aAAe,GAEf,KAAAwJ,SAAW,GACX,KAAAC,SAAW,CACT,CAACrV,GAAI,IAAK8F,KAAM,4BAChB,CAAC9F,GAAI,IAAK8F,KAAM,4BAChB,CAAC9F,GAAI,IAAK8F,KAAM,6BAIlB,KAAAwP,UACA,KAAAtS,aACA,KAAAuS,gBACA,KAAA1I,OAAS,KACT,KAAA2I,OAAStI,OAAOC,OAAO,GAAI,KAE3B,KAAA3L,aAAe,GACf,KAAAC,oBACA,KAAAC,gBAxBK,wDAuCH9E,KAAKoD,GAAKpD,KAAK+C,MAAMqC,SAAS8M,SAASC,IAAI,MAC3CnS,KAAK4B,KAAO5B,KAAK+C,MAAMqC,SAAS8M,SAASC,IAAI,QAC7CnS,KAAKgP,aAAehP,KAAK+C,MAAMqC,SAAS8M,SAASC,IAAI,gBACrDnS,KAAKmJ,sBA1CF,0CA8Cc,WACjBnJ,KAAKoG,aACLpG,KAAK2C,mBAAmBwG,kBAAkBnJ,KAAKoD,GAAIpD,KAAK4B,MAAM4E,WAAUE,YAEtE,GADA1G,EAAKoG,aACiB,MAAlBM,EAAOC,OAAgB,CACzB,IAAMkS,EAAkBnS,EAAOE,KAAK4N,WAC9BsE,EAAYD,EAAS3R,MAAKnG,YAAEA,MAA0B,QAAtBA,EAAG+U,kBACrCgD,IACFA,EAAU5D,eAAiB7L,EAAA,EAAYI,QAAUqP,EAAU5D,gBAE7D,IAAM6D,EAAYF,EAASvV,QAAOvC,YAAEA,MAA0B,QAAtBA,EAAG+U,kBAA0B9O,KAAIjG,YACvE,IAAMiY,EAAQhZ,EAAKiZ,UAAUlY,EAAG+U,gBAC1BoD,EAAUlZ,EAAKkZ,QAAQnY,EAAG+U,gBAC1BqD,EAAuBpY,EAAGmU,eAC1BD,EAAO5L,EAAA,EAAYI,QAAU1I,EAAGmU,eAChCA,EAAkB8D,GAASE,EAAWjE,EAAO5L,EAAA,EAAYC,MAAQ2L,EACjEmE,EAAY,aAAgBrY,EAAG+U,gBACrC,OAAO,OAAP,wBAAW/U,GAAE,CAAEmU,iBAAgB8D,QAAOE,UAASE,YAAWD,4BAE5DzS,EAAOE,KAAKkS,UAAYA,EACxBpS,EAAOE,KAAKmS,UAAYA,EACxB/Y,EAAK4G,KAAOF,EAAOE,SAEpBrF,YACDvB,EAAKoG,kBAtEJ,qCA4EHpG,KAAK6E,oBACL7E,KAAKwJ,YAAc,GACnBxJ,KAAK4E,aAAe,GACpB5E,KAAK8E,kBA/EF,uCAkFYmE,GACf,OAAOA,EAAMoJ,QAAQ,WAAY,IAAIA,QAAQ,UAAW,KAAKA,QAAQ,MAAO,KAAKA,QAAQ,mBAAoB,KAAKlM,SAnF/G,gCAuFKkT,GAER,MADe,eACD3P,QAAQ2P,IAAQ,IAzF3B,8BA4FGA,GACN,MAAO,mCAAmCC,KAAKD,KA7F5C,iCAgGMV,GACT3Y,KAAK2Y,aAAeA,IAjGjB,6BAqGH3Y,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,0BACLC,SAASA,IAADA,OAAM9I,KAAKoD,GAAX0F,YAAiB9I,KAAK4B,KAAtBkH,YAA8B9I,KAAKgP,kBAvG1C,wCA2GapI,GACQ,MAApBA,EAAKwC,YACPpJ,KAAKwJ,YAAc5C,EAAKuS,qBACxBnZ,KAAK4E,aAAe,GACpB5E,KAAK6E,oBACL7E,KAAK8E,kBAEL9E,KAAK6E,oBACL7E,KAAKwJ,YAAc5C,EAAKuS,qBACxBnZ,KAAK4E,aAAegC,EAAKkD,eACzB9J,KAAK8E,mBArHJ,oCA2HW1B,IAAJA,EAAIA,EAAL,GACTpD,KAAKuY,cAAcgB,eAAe,kBAAkBnW,KA5HjD,mCAgIHpD,KAAK4C,YAAYiH,WAhId,4CAqIHwJ,OAAOmG,WArIJ,M,oCAAMlB,IAA4B,6EAkC7B,O,wBAlCCA,GAA4B,g/BDnBzC,gBACE,oBACE,gBACE,gBAA0B,QAAe,OACzC,cACE,mBAAqE,4CAAoB,EAAAmB,WAAA,MAEvF,cACF,OACA,mBAAkB,gCAAS,EAAAC,gBAAmD,uBAAE,OAClF,OACF,OACA,wBAEA,iBACE,iBACE,uBAA6B,sCAAc,EAAAtB,WAAA,MAAgD,OAC7F,OAEA,kBACE,kBACE,cAAI,oCAAI,OACR,uBAKF,OACA,kBACE,cAAI,oCAAI,OAER,uBAEF,OAEA,kBACE,cAAI,oCAAI,OACR,uBAGF,OACF,OAEA,kBACE,eAEE,yBAKA,eACE,yBACA,kCAQF,OACF,OACF,OACF,OACF,OACF,OAWA,iD,MA5EW,uCAAwB,aAEH,6CAIX,qEASH,iCAAkB,uBAMhB,gCAAiB,cAAjB,CAAiB,kBAAjB,CAAiB,+CASjB,gCAAiB,cAAjB,CAAiB,kBAAjB,CAAiB,6CAMjB,gCAAiB,cAAjB,CAAiB,kBAAjB,CAAiB,0CAStB,wDAOW,2DAyB8B,sC,w9DEtEhD,QACI,mBAKJ,Q,kBAHQ,+DCCT,IAAMuB,GAAN,KAAMA,GAAN,WAUL,WACUhX,EACAI,EACA6W,EACAhX,2BAHA,KAAAD,qBACA,KAAAI,QACA,KAAA6W,YACA,KAAAhX,cAZV,KAAAgE,KAAY,GAEZ,KAAAxD,GAAK,GACL,KAAAxB,KAAO,GACP,KAAAoN,aAAe,GAEf,KAAA0J,UARK,wDAkBK,WACR1Y,KAAKoD,GAAKpD,KAAK+C,MAAMqC,SAAS8M,SAASC,IAAI,MAC3CnS,KAAK4B,KAAO5B,KAAK+C,MAAMqC,SAAS8M,SAASC,IAAI,QAC7CnS,KAAKgP,aAAehP,KAAK+C,MAAMqC,SAAS8M,SAASC,IAAI,gBAErDnS,KAAK2C,mBAAmBwG,kBAAkBnJ,KAAKoD,GAAIpD,KAAK4B,MAAM4E,WAAUE,YAChD,MAAlBA,EAAOC,SAETD,EAAOE,KAAK4C,YAAcxJ,EAAK4Z,UAAUC,+BAD7BxQ,EAAA,EAAYC,MAAQD,EAAA,EAAYI,QAAU/C,EAAOE,KAAK4C,aAElExJ,EAAK4G,KAAOF,EAAOE,KACnBkT,YAAW,WACT9Z,EAAK0Y,YACJ,SAEJnX,kBAhCA,mCAsCHvB,KAAK4C,YAAYiH,aAtCd,M,oCAAM8P,IAA6B,2C,wBAA7BA,GAA6B,qVDZ1C,gBACI,gBACI,gBAA8B,QAAe,OAC/C,mBAAkB,gCAAS,EAAAD,gBAAmC,uBAAE,OAElE,OAEA,gBACI,gCAOJ,OACJ,Q,MAdsC,6CAMhB,gC,gfEHhB,mCAAuB,kFAC4C,O,qBAA5C,0BAAmB,0B,sCAG1C,oBAAsD,2DAAwC,mCAAI,Q,sCAClG,oBAAsD,8DAAwC,mCAAI,Q,sCAWlG,wCAQE,sEACF,O,qBARE,oBAAiB,cAAjB,CAAiB,cAAjB,CAAiB,wCAAjB,CAAiB,uE,sCA4EX,eAAG,iFAAmC,wBAAG,Q,sCACzC,eAAuB,gFAAkC,uBAAE,Q,sCAC3D,eAAG,yGAAgF,uBAAE,Q,sCACrF,eAEG,+GACD,qCACF,Q,uBACA,eAA2E,6BAAG,Q,sCAlBlF,aACE,aAAI,kBAA4B,QAAiB,OAAO,OACxD,aAAI,QAA0C,OAC9C,aAAI,+CAAM,OACV,aAAI,QAAqB,OAIzB,iBACE,gBAAG,+EAAwB,qCAAK,OAChC,uBACA,uBACA,uBACA,uBAKA,uBACF,OACF,O,mCAnBkC,mCAC5B,8DAEA,uCAMsB,6BACmB,6BACR,8DAEhC,6EAIA,8D,sBAO2B,Q,KAAA,e,YAAA,uB,IC5F/BK,G,4EAAN,KAAMA,GAAN,iDA+BL,WACUC,EACArX,EACAC,EACAC,EACDrB,EACAuB,EACAD,EACCE,yCAERE,gBATQ8W,qBACA,EAAArX,qBACA,EAAAC,cACA,EAAAC,eACD,EAAArB,UACA,EAAAuB,QACA,EAAAD,kBACC,EAAAE,uBAtCV,EAAAG,UAAY,8BAEZ,EAAAC,IAAM,EAEN,EAAAoF,kBAAyB,GACzB,EAAAhF,iBAAmB,GAEnB,EAAAS,aAAe,CACbgW,WAAY,GACZC,QAAS,GACTC,kBAAmB,GACnBhW,mBAAoB,IAItB,EAAAL,SAAW,GACX,EAAAL,KAAmB,GACnB,EAAAC,iBAAwB,GACxB,EAAAC,eAAiB,uBACjB,EAAAyW,aAAoB,GACpB,EAAAzV,oBACA,EAAAD,sBACA,EAAAd,gBACQ,EAAAa,QACA,EAAA4V,WAcErX,EAvCL,wDAgDK,WACRhD,KAAK8D,SAAW,IAAmBwW,gBAAkB,IAAmBnV,kBAAkB,QADlF,MAGanF,KAAK+C,MAAMqC,SAASC,YAAlC5B,EAHC,EAGF,KAAO6B,EAHL,EAGG,KACXtF,KAAKsF,KAAOA,EACC,QAAT7B,IACFzD,KAAKyD,KAAOA,EACZzD,KAAK0D,iBAAmB,IAAmB+B,0BAG7C,IAAgBuB,KAAKzD,YACnBvD,EAAKoa,aAAa7W,EAAKH,IAAMG,EAAK2F,UA3DjC,mCAkEO,WACVlJ,KAAK8D,SAAW,IAAmBwW,gBAAkB,IAAmBnV,kBAAkB,QAC1FnF,KAAK6H,eACL7H,KAAK8H,YACL9H,KAAKyE,QACLzE,KAAK2E,oBACL,OAAAoD,EAAA,GAAM,GAAGvB,WAAU,WACjBxG,EAAK2E,yBAzEJ,qCAiFS,MACyB,IAAmBe,UAAU1F,KAAKmD,WAAhE+W,EADK,EACN,QAAUC,EADJ,EACE,kBACdna,KAAKka,QAAUA,GAAW,GAC1Bla,KAAKma,kBAAoBA,GAAqB,KApF3C,kCA2FHna,KAAKiE,aAAaiW,QAAUla,KAAKka,QACjCla,KAAKiE,aAAakW,kBAAoBna,KAAKma,oBA5FxC,oCAkGQ,IACJD,EAA8Bla,KAA/B,QAAUma,EAAqBna,KAAvB,kBACdA,KAAK2F,SAAS,CAACuU,UAASC,wBApGrB,kCA2GHna,KAAKka,QAAU,GACfla,KAAKma,kBAAoB,GACzBna,KAAKiE,aAAakW,kBAAoB,GACtCna,KAAKiE,aAAaiW,QAAU,KA9GzB,oCAqHQ,WACXla,KAAKiE,aAAaiW,QAAUla,KAAKiE,aAAaiW,QAAQtU,OACtD,IAAMC,EAAQ,OAAH,wBACN7F,KAAKiE,cAAY,CACpB6B,KAAM9F,KAAK+F,UACXC,MAAOhG,KAAKiG,WAqCdjG,KAAKoG,aAEL,IAAMC,EAAO,CAACrG,KAAKga,mBAAmBO,mBAAmB1U,IACzD,OAAAU,EAAA,GAASF,GAAMG,WACZC,YAvCcC,MAwCb1G,EAAKoG,aAvCe,OADPM,EAyCLD,EAAI,IAxCHE,QACT3G,EAAK4G,KAAOF,EAAOE,KACnB5G,EAAK8G,MAAQJ,EAAOZ,KAAK0U,YAET,QAAdxa,EAAKyD,MACLzD,EAAK0D,iBAAiBqD,OACtB/G,EAAK0D,iBAAiBqD,MAAMZ,OAAS,IAGrCnG,EAAK4G,KAAO5G,EAAK4G,KAAKI,KAAKzD,YACzB,IAAM0D,EAAcjH,EAAK0D,iBAAiBqD,MAAMG,MAC7CC,YAAEA,OAAKA,EAAG/D,KAAOG,EAAKH,MAMzB,OAJI6D,IACF1D,EAAK6D,UACL7D,EAAK8D,OAASJ,EAAYI,QAErB9D,KAETvD,EAAKwH,qBAIPxH,EAAK4G,KAAO,GACZ5G,EAAK8G,MAAQ,EACb9G,EAAKwB,QAAQiG,OAAO,QAASE,KAAKC,UAAUlB,QAiB7CgB,YACC1H,EAAKoG,aAdMsB,YACb1H,EAAKoG,aACLpG,EAAKwB,QAAQiG,OAAO,QAASE,KAAKC,UAAUF,IAa1CnG,CAAMmG,QAzKP,kCA+KKM,eAAD,MACDC,EAAOjI,KAAKkI,eACblI,KAAKkI,cAAclH,eACnBhB,KAAKkI,cAAclH,cAAcmH,YAEpCF,GAAUjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAKH,GAE7DC,GAASjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAMH,IAIjEI,qBAAqBpI,KAAKoD,IAC1BpD,KAAKoD,GAAKiF,uBAAsB,WAE9BrI,EAAKgI,MAAQA,QA7LZ,wCAmMChI,KAAK0D,iBAAiByG,eAAe,WAErCnK,KAAK4D,aADqC,IAAxCwG,OAAOpK,KAAK0D,iBAAiBsC,UAG/BhG,KAAK0D,iBAAiBqD,MAAMZ,QAAUnG,KAAK0D,iBAAiBsC,QAAkD,IAAzCoE,OAAOpK,KAAK0D,iBAAiBsC,WAvMnG,uCAgNYzC,GACf,IAAmBkX,aAAalX,EAAKgF,MACrCvI,KAAKwI,kBAAoBjF,EACzBvD,KAAKiE,aAAaE,mBAAqBZ,EAAKH,GAC5CpD,KAAKiE,aAAagW,WAAa,GAC1Bja,KAAKyE,MAIRzE,KAAK+F,UAAY,EACjB/F,KAAKyI,eAJLzI,KAAKyE,QACLzE,KAAKyI,WAAW,cAvNf,iCA8NMC,GACLA,EAAQgS,YACV1a,KAAKiE,aAAagW,WAAavR,EAAQiS,IACvC3a,KAAKiE,aAAaE,mBAAqB,KAEvCnE,KAAKiE,aAAaE,mBAAqBuE,EAAQiS,IAC/C3a,KAAKiE,aAAagW,WAAa,IAEjCja,KAAK+F,UAAY,EACjB/F,KAAKyI,eAvOF,2BA0OA7B,GACH5G,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,mBACLI,MAAO,2BACPH,SAASA,SAADA,OAAWlC,EAAKxD,GAAhB0F,YAAsB9I,KAAKwI,kBAAkBpF,GAA7C0F,iBA9OP,kCAmPH9I,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,mBACLI,MAAO,2BACPH,SACE,UACA9I,KAAKwI,kBAAkBpF,GACvB,WACApD,KAAKiE,aAAagW,WAClB,OACA,IAAIlR,MAAOC,cA5PZ,8BAgQGpC,cACN,GAAIA,EAAKiC,IACP,OAAO7I,KAAK4a,OAAOhU,EAAKiC,KAE1B,IAAMiC,EAAS,CACb1H,GAAIwD,EAAKxD,GACTyX,UAAWjU,EAAKiU,WAElB7a,KAAKqa,WAeLra,KAAKga,mBAAmBc,mBAAmBhQ,GAAQtE,WAdlC0E,YACflL,EAAKqa,WACc,MAAfnP,EAAIvE,QACFuE,EAAItE,OACNA,EAAKiC,IAAMqC,EAAItE,KACf5G,EAAK4a,OAAO1P,EAAItE,UAKPc,YACb1H,EAAKqa,WACLra,EAAKwB,QAAQiG,OAAO,QAASE,KAAKC,UAAUF,SArR3C,6BA0REmB,GACL2Q,KAAK3Q,KA3RF,+BA8RG,WACN7I,KAAK4C,YAAYiH,SACjB,OAAA9B,EAAA,GAAM,GAAGvB,WAAU,WACjBxG,EAAK4C,YAAYgG,QAAQ,CACvBK,MAAO,2BACPJ,IAAK,kCACLC,SAAU,UApSX,0BAySDlC,cACF5G,KAAK+a,gBAAkBnU,EACvB5G,KAAK2C,mBAAmBqY,YAAYhb,KAAK+a,gBAAgB3X,IAAIoD,WAAUyU,YAEnE,IAAIC,EADgB,MAAlBD,EAAOtU,QAGPuU,EADkB,MAAhBD,EAAOrU,KACF,mMAEA,yDAET5G,EAAK6C,aAAatB,MAAM,CACtBsK,QAAS,eACTC,UAAWoP,EACXnP,aAAc,eACdE,OAAQ,kBACC,IAAIjC,SAASC,YAClBjK,EAAK2C,mBAAmBuH,YAAYlK,EAAK+a,gBAAgB3X,IAAIoD,WAC1DE,YACuB,MAAlBA,EAAOC,QACTsD,GAAQA,GACRjK,EAAKyI,eAEiB,MAAlB/B,EAAOC,QACT3G,EAAKwB,QAAQD,MAAM,8CAErB0I,GAAQA,OAGX1I,YACC0I,GAAQA,GACRjK,EAAKwB,QAAQD,MAAMoG,KAAKC,UAAUrG,cAMjB,MAAlB0Z,EAAOtU,QAChB3G,EAAKwB,QAAQoK,QAAQ,uIA9UtB,mCAmVQhF,EAAM2D,GAAMA,WAEjBhJ,EAASmG,YACb1H,EAAKoG,aACLpG,EAAKwB,QAAQoK,QAAQjE,KAAKC,UAAUF,KAEhCoD,EAAM,+BACP9K,KAAK0D,iBAAiB+G,aAAW,CACpCC,WAAY9D,EAAKxD,GACjBgG,WAAY,IAER8E,EAAWhD,YAEf,GADAlL,EAAKoG,aACc,MAAf8E,EAAIvE,OAAgB,CAAC,IAEnBwE,EADG7F,EAAQtF,EAAT,KAGJmL,EADW,MAAT7F,EACM,uBACU,QAATA,EACD,0BACU,QAATA,EACD,2BAEA,yBAEVtF,EAAKgD,qBAAqBoI,wBAAwB,CAChDlC,KAAM,iCACNmC,WAAY,IAAiBC,WAAWH,GAAOM,QAC/CD,QAAS7D,KAAKC,UAAUkD,KAE1B9K,EAAK4G,KAAK2D,GAAOnD,UACjBpH,EAAK4G,KAAK2D,GAAOlD,OAAS6D,EAAItE,KAAKxD,GACnCpD,EAAK0D,iBAAiBqD,MAAM2E,KAAK,CAC/BtI,GAAIpD,EAAK4G,KAAK2D,GAAOnH,GACrBiE,OAAQ6D,EAAItE,KAAKxD,KAEnBpD,EAAK0D,iBAAiBkH,KAAO,EAC7B,IAAmBe,uBAAuB3L,EAAK0D,kBAC/C1D,EAAKwH,uBAIHxH,EAAKwB,QAAQD,MADI,MAAf2J,EAAIvE,OACa,6KAEAuE,EAAI1J,UAI7BxB,KAAKoG,aACa,MAAdpG,KAAKsF,MACPwF,EAAO5B,KAAOtC,EAAKqC,MACnB6B,EAAOxD,SAAW,IAClBwD,EAAOF,IAAM,IAAmBnF,yBAAyBmF,IACzD5K,KAAK8C,gBACFqL,sCAAsCrD,GACtCtE,UAAU0H,EAAS3M,KAEtBuJ,EAAO7B,MAAQrC,EAAKqC,MACpB6B,EAAO5G,SAAW0C,EAAK1C,SACvB4G,EAAOlJ,KAAO5B,KAAKsF,KACnBwF,EAAOF,IAAM,IAAmBnF,yBAAyBmF,IACzD5K,KAAK8C,gBACFsL,kCAAkCtD,GAClCtE,UAAU0H,EAAS3M,MAlZrB,yCAsZcqF,EAAW2D,cACtBhJ,EAASmG,YACb1H,EAAKwB,QAAQoK,QAAQjE,KAAKC,UAAUF,KAEhCwG,EAAWhD,YACf,GAAmB,MAAfA,EAAIvE,OAAgB,CAAC,IAEnBwE,EADG7F,EAAQtF,EAAT,KAGJmL,EADW,MAAT7F,EACM,uBACU,QAATA,EACD,0BACU,QAATA,EACD,2BAEA,yBAEVtF,EAAKgD,qBAAqBoI,wBAAwB,CAChDlC,KAAM,6CACNmC,WAAY,IAAiBC,WAAWH,GAAOM,QAC/CD,QAAS5E,EAAKS,SAEhBrH,EAAK4G,KAAK2D,GAAOnD,UACjBpH,EAAK0D,iBAAiBqD,MAAQ/G,EAAK0D,iBAAiBqD,MAAMzD,QACvDC,YAAIA,OAAKA,EAAKH,KAAOpD,EAAK4G,KAAK2D,GAAOnH,MAEzCpD,EAAK0D,iBAAiBkH,KAAO,EAC7B,IAAmBe,uBAAuB3L,EAAK0D,kBAC/C1D,EAAKwH,uBAELxH,EAAKwB,QAAQoK,QAAQV,EAAI1J,SAAW,6BAGtB,MAAdxB,KAAKsF,KACPtF,KAAK8C,gBACFuL,qBAAqBzH,EAAKS,QAC1Bb,UAAU0H,EAAS3M,GAEtBvB,KAAK8C,gBAAgBwL,iBAAiB1H,EAAKS,QACxCb,UAAU0H,EAAS3M,OA7brB,GAA0C,M,oCAApCwY,IAA2B,mF,wBAA3BA,GAA2B,iE,MAAA,K,4oEDrBxC,gBAEE,oBACE,gBACE,iBAAgC,QAA6B,OAC7D,yCAEF,OACA,cACE,0BACA,0BACF,OACF,OAEA,oBAEE,qBAGS,oCAAY,EAAAzM,SAAA,MACnB,mBACA,6CAUA,OAEA,+BACE,kBACE,gBACF,OACF,OACF,OACA,sBACE,sBACE,kBACE,kBAAwB,gDAAM,OAC9B,kBACE,oBACO,wDAAqB,iCAAgB,EAAA7E,WAAW,YAAhD,CAAqB,mCAAuD,EAAAjD,iBADnF,OAEF,OACA,kBAAiD,0CAAK,OACtD,kBACE,wBAAW,kEAA+B,mCAA8D,EAAAA,iBAEtG,wBACA,wBACA,wBACA,wBACA,wBACA,wBACF,OACF,OACA,qBACQ,gCAAS,EAAAiD,WAAW,aAAW,yBACvC,OACA,qBAA6D,gCAAS,EAAA+F,eAAa,wBAAE,OAEvF,OACF,OACA,sBACE,0BAIU,8DAA2B,sDAA3B,CAA2B,uCACoB,EAAA/F,eAD/C,CAA2B,sCAGP,EAAAA,gBAC5B,oBACA,cACE,iBAAoB,oCAAI,OACxB,iBAAoB,oCAAI,OACxB,iBAAoB,oCAAI,OACxB,iBAAoB,0BAAI,OAIxB,iBAA4B,wBAAE,OAChC,OACA,OACA,iBACA,yBAqBA,OACF,OACF,OAEA,2CACF,OACF,OACF,Q,+BAhHsC,sEACqC,wCAII,oCACG,iCAQrE,mCAML,0CAqBW,mCAII,4CAEE,0BACA,0BACA,0BACA,0BACA,0BACA,0BAU+B,wCAC3B,8BAAe,uBAAf,CAAe,uBAAf,CAAe,gCAAf,CAAe,gBAAf,CAAe,wBAAf,CAAe,kBAAf,CAAe,0BAAf,CAAe,wBAAf,CAAe,sCAqB9B,kC,86HEnFZ,mBAAuC,8DACmB,sDAC1D,O,qBAFkB,yBAAoB,0B,yBA0C1B,uB,uBAAiD,uBAAuB,iB,IC9BzE0S,G,mFAAN,KAAMA,GAAN,WAgBL,WACU3Z,EACAwY,EACAoB,EACAxY,EACA8L,2BAJA,KAAAlN,UACA,KAAAwY,qBACA,KAAAoB,aACA,KAAAxY,cACA,KAAA8L,KAnBV,KAAAtL,IAAM,EACN,KAAAxB,KAAO,MACP,KAAA8I,WAAa,GACb,KAAA2Q,aAAoB,GACpB,KAAAC,eAAiB,GACjB,KAAAhM,eAAsB,GACtB,KAAAiM,cAAqB,GACrB,KAAA3U,KAAY,GACZ,KAAAR,aACA,KAAAoV,SAAW,KAAiBC,UAC5B,KAAAC,eAAiB,IAZZ,wDA8BH1b,KAAKuR,YACLvR,KAAK2b,WACa,QAAd3b,KAAK4B,MACP5B,KAAK4b,QAAQ5b,KAAK0K,YAEpB1K,KAAK6b,iBAnCF,qCAsCS,IACLC,EAAU9b,KAAKob,WAAWhW,SAASC,YAApC,OACFyW,IACF9b,KAAKsP,eAAiB,CAACwM,GACvB9b,KAAKub,cAAgB,CAACO,MA1CrB,kCA8CM,WACT9b,KAAKob,WAAWtQ,OAAOtE,WAAWX,gBACzBzC,EAA0ByC,EAA3B,GAAKjE,EAAsBiE,EAAxB,KAAQmJ,EAAgBnJ,EAAlB,aACf7F,EAAK4B,KAAOA,EACZ5B,EAAK0K,WAAatH,EAClBpD,EAAKsb,eAAiBtM,EACtBhP,EAAKqb,aAAe,CAACjY,GAAI4L,QApDxB,iCAyDHhP,KAAK+b,WAAa/b,KAAK0O,GAAGiG,MAAM,CAC9BF,WAAY,CAACzU,KAAKwb,SAASQ,SAAU,CAAC,IAAWnH,WACjDoH,WAAY,CAAC,IAAK,CAAC,IAAWpH,WAC9B5L,MAAO,CAAC,GAAI,CAAC,IAAW4L,SAAU,IAAWC,UAAU,IAAK,iBAC5DtQ,iBAAkB,CAAC,GAAI,CAAC,IAAWqQ,WACnCgG,UAAW,CAAC,GAAI,CAAC,IAAWhG,eA9D3B,kCAkEK7M,eAAD,MACDC,EAAOjI,KAAKkI,eACblI,KAAKkI,cAAclH,eACnBhB,KAAKkI,cAAclH,cAAcmH,YAEpCF,GAAUjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAKH,GAE7DC,GAASjI,KAAKkI,cAAclH,cAAcmH,YAAc,GAAMH,IAIjEI,qBAAqBpI,KAAKoD,IAC1BpD,KAAKoD,GAAKiF,uBAAsB,WAE9BrI,EAAKgI,MAAQA,QAhFZ,iCAqFMU,GACT1I,KAAKub,cAAgB,CAAC7S,EAAQtF,MAtF3B,8BAyFGA,GAAGA,WAoBTpD,KAAKoG,aACLpG,KAAKga,mBAAmBkC,iBAAiB,CAAC9Y,OAAKoD,WApB9BE,YACf1G,EAAK4G,KAAOF,EAAOE,MAAQ,GAC3B5G,EAAKsP,eAAiB,CAACtP,EAAK4G,KAAKqT,YACjCja,EAAKub,cAAgB,CAACvb,EAAK4G,KAAKqT,YAChCja,EAAK+b,WAAWI,WAAW,CACzB1H,WAAYzU,EAAK4G,KAAK6N,WACtBwH,WAAYjc,EAAK4G,KAAKqV,WACtBhT,MAAOjJ,EAAK4G,KAAKqC,MACjBzE,iBAAkBxE,EAAK4G,KAAKpC,iBAC5BqW,UAAW7a,EAAK4G,KAAKiU,YAEvB7a,EAAKoG,gBAGQsB,YACb1H,EAAKoG,aACLpG,EAAKwB,QAAQiG,OAAO,QAASE,KAAKC,UAAUF,SA1G3C,+BAmHH1H,KAAK4C,YAAYiH,QAAOA,GACxB7J,KAAK4C,YAAYgG,QAAQ,CACvBC,IAAK,gBACLC,SAAU,GACVG,MAAO,+BAvHN,gCA4HKhB,cAER,IAAK,IAAM0S,KAAO3a,KAAK+b,WAAW3G,SAChCpV,KAAK+b,WAAW3G,SAASuF,GAAKtF,cAC9BrV,KAAK+b,WAAW3G,SAASuF,GAAKrF,yBAEhC,GAAItV,KAAK+b,WAAWK,MAAO,CACzB,GAAIpc,KAAKqb,aAAajY,KAAOpD,KAAKub,cAAc,GAE9C,YADAvb,KAAKwB,QAAQoK,QAAQ,gHAGvB,IAAK5L,KAAKub,cAAc,GACtB,OAAOvb,KAAKwB,QAAQoK,QAAQ,4EAE9B,IAAMd,EAAM,+BACP9K,KAAK+b,WAAWtb,OAAK,CACxBwZ,WAAYja,KAAKub,cAAc,GAC/Bc,UAAW,MAGTrc,KAAK0K,YAA4B,SAAd1K,KAAK4B,OAC1BkJ,EAAO1H,GAAKpD,KAAK0K,YAyBnB1K,KAAKoG,aACLpG,KAAKga,mBAAmBsC,cAAcxR,GAAQtE,WAxB7BE,YAEf,GADA1G,EAAKoG,aACiB,MAAlBM,EAAOC,OACT,GAAIsB,EACFjI,EAAK6J,cAQL,IAAK,IAAM8Q,KANX3a,EAAK+b,WAAWI,WAAW,CACzBlT,MAAO,GACPzE,iBAAkB,GAClBqW,UAAW,KAGK7a,EAAK+b,WAAW3G,SAChCpV,EAAK+b,WAAW3G,SAASuF,GAAK4B,iBAC9Bvc,EAAK+b,WAAW3G,SAASuF,GAAK6B,kBAC9Bxc,EAAK+b,WAAW3G,SAASuF,GAAKrF,4BAKxB,WACZtV,EAAKoG,mBAxKN,mCA0BH,OAAOpG,KAAK+b,WAAW5J,IAAI,SAAS1R,MAAM0F,WA1BvC,M,oCAAMgV,IAAwB,qD,wBAAxBA,GAAwB,8D,MAAA,K,m9DDjBrC,gBACE,qCACA,mBAAuC,gCAAS,EAAAsB,WAAUA,MACzD,wBACD,OACA,0BAGA,mBAAqC,gCAAS,EAAA5S,YAAsD,uBAAE,OACxG,OACA,oBACE,oBACS,oCAAY,EAAAyD,SAAA,MACnB,kBACE,uCAME,sCAAc,EAAA2J,WAAA,MAGhB,OACF,OACA,+BACE,kBACE,gBACF,OACF,OAEF,OACA,sBACE,sBACE,kBAAmB,SAAkC,OACrD,mBACE,wBACE,4BAAuC,oCAAI,OAC3C,8BACE,oBAA8E,sCAAe,EAAAwF,eAA7F,OACF,OACA,mBAAmD,SAAwB,OAC7E,OACA,wBACE,4BAAuC,oCAAI,OAC3C,8BACE,wBACE,+BAEF,OACF,OACF,OACA,wBACE,4BAAuC,oCAAI,OAC3C,8BACE,wBACE,wBACF,OACF,OACF,OACA,wBACE,4BAAuC,0BAAI,OAC3C,8BACE,oBAA8E,sCAAe,EAAAA,eAA7F,OACF,OACF,OACF,OACF,OACF,OACF,Q,MAnEoB,iCAAoB,yBAI9B,oCAKgC,mCACD,+BAIjC,4BAAiB,2DAAjB,CAAiB,sCAAjB,CAAiB,eAgBS,gEACrB,uCAAwB,aACZ,6EACL,uCAEK,yBACE,0BAGkC,yCAGpC,yBACE,0BAEF,yCAMA,yBACE,0BAOF,yBACE,4B,y6EE5DrB,mB,kBAEE,wBCQR,ICAaC,GDoBAC,GEWAC,GF/BPC,GAAiB,CACrB,CAAC5H,KAAM,OAAQ6H,UAAW,IAC1B,CAAC7H,KAAM,OAAQ6H,UAAW,IAC1B,CAAC7H,KAAM,UAAW6H,UAAW,IAC7B,CAAC7H,KAAM,WAAY6H,WCJRJ,GAAN,WAaL,WACU9C,2BAAA,KAAAA,YAbV,KAAAzW,UAAY,2BACZ,KAAAiO,QAAU,IAAUC,aAEpB,KAAA0L,QAAU,CACRC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,KAAM,EACNC,GAAI,GAEN,KAAAC,SAAW,KAAiBC,aAK1Btd,KAAKud,SAhBF,sD,kKAoBGC,O,SAAgB,IAAUC,gB,OAA1BD,E,OACNxd,KAAK6I,IAAM7I,KAAK4Z,UAAUC,+BACxBxQ,EAAA,EAAYqU,aAAe,yBACzBF,EACF,UAAYxd,KAAKqd,SAASM,MAC1B,iBAAmB3d,KAAKqd,SAASO,aACjC,sB,oDA1BC,K,uCAAMlB,IAAwB,a,wBAAxBA,GAAwB,iWFZrC,gBACE,gBACI,0BAKJ,OACF,Q,MANc,6B,mPCeZ,CAACzH,KAAM,qCAAsC6H,UAAW,IACxD,CAAC7H,KAAM,2CAA4C6H,UAAW,IAC9D,CAAC7H,KAAM,4CAA6C6H,UAAW,IAC/D,CAAC7H,KAAM,6CAA8C6H,UAAW,IAAgC,CAC9F7H,KAAM,KACN6H,UAAW,KACXlW,KAAM,CAACqC,MAAO,SASX,KAAM0T,GAAN,uC,qBAAMA,K,qDAAAA,KAA2B,SAH7B,CAAC,IAAakB,SAAShB,KACtB,O,iBEaL,KAAMD,GAAN,uC,qBAAMA,K,qDAAAA,KAAoB,SATtB,CACP,IACA,KACA,GACA,KACA,KACA,M,0BCrB6DkB,EAAOC,QAGhE,WAAe,aA8BrB,IAAIC,EAAyC,aAOzC7T,EAAiBmG,OAAO3P,UAAUwJ,eAOlC8T,EAAQC,MAAMvd,UAAUsd,MA4F5B,SAASE,EAAaC,EAAKC,EAAQC,GAMjC,IAHA,IAAIC,EACAC,EAEK7L,EAAI,EAAGxM,GALhBmY,EAAUL,EAAMQ,KAAKC,UAAW,IAKCvY,OAAQwM,EAAIxM,EAAQwM,IAGnD,IAAK4L,KAFLC,EAASF,EAAQ3L,GAGVyL,IAAOjU,EAAesU,KAAKD,EAAQD,KACtCF,EAAOE,GAAYC,EAAOD,IAclC,SAASI,KACTA,EAAMC,OAAS,QACfD,EAAME,OAASvO,OAyBfqO,EAAMG,OA7FN,SAAgB5V,EAAM6V,EAAape,EAAWqe,GAC5C,IAAIC,EAAmBjf,KAyBvB,MAvBoB,iBAATkJ,IACT8V,EAAUre,EACVA,EAAYoe,EACZA,EAAc7V,EACdA,EAAO,MAGkB,mBAAhB6V,IACTC,EAAUre,EACVA,EAAYoe,EACZA,EAAc,WACZ,OAAOE,EAAiBC,MAAMlf,KAAM0e,aAIxCP,GAAaA,EAAOY,EAAaE,EAAkBD,GAEnDD,EAAYpe,UA3Dd,SAAsBA,EAAWwe,GAC/B,IAAIzY,EAcJ,MAZ6B,mBAAlB4J,OAAO7I,OAChBf,EAAS4J,OAAO7I,OAAO9G,IAEvBqd,EAAYrd,UAAYA,EACxB+F,EAAS,IAAIsX,EACbA,EAAYrd,UAAY,MAGtBwe,GACFhB,GAAaA,EAAMzX,EAAQyY,GAGtBzY,EAfT,CA2DuCuY,EAAiBte,UAAWA,GACjEoe,EAAYpe,UAAUoe,YAAcA,EAEpCA,EAAYH,OAAS1V,GAAQ+V,EAAiBL,OAC9CG,EAAYF,OAASI,EAEdF,GAqET,IAEIK,EAFQT,EA6KRU,EA1JWD,EAAKN,QAAO,SAASQ,EAAQC,EAASC,GAQnDxf,KAAKsf,OAASA,EASdtf,KAAKuf,QAAUA,EACfvf,KAAKuf,QAAQD,OAASA,EAStBtf,KAAKwf,QAAUC,QAAQD,KACtB,CAaDE,KAAM,SAASC,KAYfC,WAAY,WAMV,OALK5f,KAAKwf,UACRxf,KAAKwf,WACLxf,KAAK6f,UAGA7f,KAAKuf,SAkBdO,cAAe,SAASH,GACtB,IAAIL,EAAStf,KAAKsf,OAEdS,EAASC,KAAKC,OAAOX,EAAO9e,KAAkB,GADpC8e,EAAO/e,SAAW,IACwBof,EAAM3X,OAE9D,OAAOgY,KAAKE,IAAI,EAAGH,IAgBrBI,UAAW,SAASR,GAClB,IAAIL,EAAStf,KAAKsf,OACd/e,EAAU+e,EAAO/e,QAErB,GAAe,MAAXA,EACF,OAAOA,EAGT,IAAI6f,EAAapgB,KAAK8f,cAAcH,GAChCU,EAASL,KAAKC,OAAOX,EAAO9e,KAAQ4f,EAAaT,EAAM3X,OAAU,GAErE,OAAOgY,KAAKE,IAAI,EAAGG,IAWrBR,OAAQ,SAASF,GACX3f,KAAKwf,UACPxf,KAAKsgB,SACLtgB,KAAK4N,QACL5N,KAAK0f,KAAKC,KAcd/R,MAAO,aAYP0S,OAAQ,eA+DNC,EAlDiBlB,EAAWP,OAAO,CAKrCY,KAAM,SAASC,GACb,IAAIhN,EAAG6N,EACHlB,EAAStf,KAAKsf,OACdc,EAAapgB,KAAK8f,cAAcH,GAChCU,EAASrgB,KAAKmgB,UAAUR,GACxBc,EAAUzgB,KAAKuf,QAAQmB,WAAW,MAKtC,IAHAD,EAAQE,UAAYrB,EAAOnf,WAC3BsgB,EAAQG,YAActB,EAAOlf,gBAExBuS,EAAI,EAAGA,EAAIgN,EAAM3X,MAAO2K,IAC3B,IAAK6N,EAAI,EAAGA,EAAIb,EAAM3X,MAAOwY,IACvBb,EAAMkB,OAAQL,EAAIb,EAAM3X,MAAS2K,IACnC8N,EAAQK,SAAUV,EAAazN,EAAK0N,EAASD,EAAaI,EAAKH,EAAQD,EAAYA,IAS3FxS,MAAO,WACL,IAAI0R,EAAStf,KAAKsf,OACdmB,EAAUzgB,KAAKuf,QAAQmB,WAAW,MAClClgB,EAAO8e,EAAO9e,KAElBigB,EAAQM,UAAY,EACpBN,EAAQO,UAAU,EAAG,EAAGxgB,EAAMA,GAC9BigB,EAAQE,UAAYrB,EAAOrf,WAC3BwgB,EAAQG,YAActB,EAAOpf,gBAC7BugB,EAAQK,SAAS,EAAG,EAAGtgB,EAAMA,IAM/B8f,OAAQ,WACN,IAAIf,EAAUvf,KAAKuf,QAEnBA,EAAQvX,MAAQuX,EAAQ0B,OAASjhB,KAAKsf,OAAO9e,QAoC7C0gB,EAlBY9B,EAAKN,OAAO,KAAM,CAUhCqC,MAAO,CACL,EAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GACxB,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAChE,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,MA8GhEC,EA5FkBhC,EAAKN,OAAO,KAAM,CAatCuC,OAAQ,CACN,EAAI,EAAI,GAAK,EAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,EAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,EAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GACzE,EAAI,EAAI,GAAK,GAAO,EAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,GAAI,EAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,GAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,GAAI,EAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,EAAI,GAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,GAAI,EAAI,IAAK,GAAO,GAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,GAAI,EAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,EAAI,GAAI,IAAK,GAAO,EAAI,GAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,EAAI,EAAI,IAAK,GAAO,GAAI,EAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,EAAI,GAAI,IAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,GAAI,EAAI,IAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,GAAI,EAAI,IAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,GAAI,EAAI,IAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,GAAI,EAAI,IAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GAAO,GAAI,EAAI,GAAK,GACzE,GAAI,EAAI,IAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,EAAI,GAAI,IAAK,GAAO,EAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,EAAI,GAAI,GAAK,GACzE,GAAI,EAAI,IAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,EAAI,GAAI,IAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,GAAI,EAAI,IAAK,GAAO,GAAI,EAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GACzE,GAAI,EAAI,IAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,GAAO,GAAI,GAAI,GAAK,IAW3EC,aAAc,CAEZ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAExD,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAExD,MAAQ,MAAQ,MAAQ,MAAQ,KAAQ,KAAQ,MAAQ,MAExD,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,IAAQ,KAAQ,MAW1DC,OAAQ,CACNC,EAAG,EACHC,EAAG,EACHC,EAAG,EACHC,EAAG,KAwEHC,EA1DSxC,EAAKN,OAAO,KAAM,CAU7B+C,SAAU,CACR,EAAM,EAAM,EAAM,EAAM,GAAM,GAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAC1F,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,EAAM,EAAM,GAAM,GAAM,GAAM,GAAM,IAC1F,IAAM,GAAM,GAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAC1F,GAAM,IAAM,EAAM,GAAM,GAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1F,GAAM,IAAM,GAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAC1F,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAC1F,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAC1F,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAC1F,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,GAAM,GAAM,GAC1F,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAC1F,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1F,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAC1F,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,EAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAC1F,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,EAC1F,GAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAC1F,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAW5FC,IAAK,CACH,IAAM,EAAM,EAAM,GAAM,EAAM,GAAM,GAAM,IAAM,EAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,GAC1F,EAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,EAAM,GAAM,IAC1F,EAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAC1F,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,EAAM,IAAM,GAAM,IAAM,IAAM,IAC1F,EAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAC1F,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,GAAM,GAC1F,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAC1F,IAAM,GAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAC1F,EAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAC1F,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAC1F,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAC1F,IAAM,GAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,GAAM,IAC1F,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAC1F,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAC1F,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAC1F,GAAM,IAAM,IAAM,IAAM,IAAM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","file":"x","sourcesContent":["import { Component, ElementRef, Input, NgModule } from '@angular/core';\nimport QRious from 'qrious';\n\nimport * as ɵngcc0 from '@angular/core';\nvar QRCodeComponent = (function () {\n    /**\n     * @param {?} elementRef\n     */\n    function QRCodeComponent(elementRef) {\n        this.elementRef = elementRef;\n        this.background = 'white';\n        this.backgroundAlpha = 1.0;\n        this.foreground = 'black';\n        this.foregroundAlpha = 1.0;\n        this.level = 'L';\n        this.mime = 'image/png';\n        this.padding = null;\n        this.size = 100;\n        this.value = '';\n        this.canvas = false;\n    }\n    /**\n     * @param {?} changes\n     * @return {?}\n     */\n    QRCodeComponent.prototype.ngOnChanges = function (changes) {\n        if ('background' in changes ||\n            'backgroundAlpha' in changes ||\n            'foreground' in changes ||\n            'foregroundAlpha' in changes ||\n            'level' in changes ||\n            'mime' in changes ||\n            'padding' in changes ||\n            'size' in changes ||\n            'value' in changes ||\n            'canvas' in changes) {\n            this.generate();\n        }\n    };\n    /**\n     * @return {?}\n     */\n    QRCodeComponent.prototype.generate = function () {\n        try {\n            var /** @type {?} */ el = this.elementRef.nativeElement;\n            el.innerHTML = '';\n            var /** @type {?} */ qr = new QRious({\n                background: this.background,\n                backgroundAlpha: this.backgroundAlpha,\n                foreground: this.foreground,\n                foregroundAlpha: this.foregroundAlpha,\n                level: this.level,\n                mime: this.mime,\n                padding: this.padding,\n                size: this.size,\n                value: this.value\n            });\n            if (this.canvas) {\n                el.appendChild(qr.canvas);\n            }\n            else {\n                el.appendChild(qr.image);\n            }\n        }\n        catch (e) {\n            console.error(\"Could not generate QR Code: \" + e.message);\n        }\n    };\nQRCodeComponent.ɵfac = function QRCodeComponent_Factory(t) { return new (t || QRCodeComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };\nQRCodeComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: QRCodeComponent, selectors: [[\"qr-code\"]], inputs: { background: \"background\", backgroundAlpha: \"backgroundAlpha\", foreground: \"foreground\", foregroundAlpha: \"foregroundAlpha\", level: \"level\", mime: \"mime\", padding: \"padding\", size: \"size\", value: \"value\", canvas: \"canvas\" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 0, vars: 0, template: function QRCodeComponent_Template(rf, ctx) { }, encapsulation: 2 });\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(QRCodeComponent, [{\n        type: Component,\n        args: [{\n                moduleId: 'module.id',\n                selector: 'qr-code',\n                template: \"\"\n            }]\n    }], function () { return [{ type: ɵngcc0.ElementRef }]; }, { background: [{\n            type: Input\n        }], backgroundAlpha: [{\n            type: Input\n        }], foreground: [{\n            type: Input\n        }], foregroundAlpha: [{\n            type: Input\n        }], level: [{\n            type: Input\n        }], mime: [{\n            type: Input\n        }], padding: [{\n            type: Input\n        }], size: [{\n            type: Input\n        }], value: [{\n            type: Input\n        }], canvas: [{\n            type: Input\n        }] }); })();\n    return QRCodeComponent;\n}());\n/**\n * @nocollapse\n */\nQRCodeComponent.ctorParameters = function () { return [\n    { type: ElementRef, },\n]; };\nQRCodeComponent.propDecorators = {\n    'background': [{ type: Input },],\n    'backgroundAlpha': [{ type: Input },],\n    'foreground': [{ type: Input },],\n    'foregroundAlpha': [{ type: Input },],\n    'level': [{ type: Input },],\n    'mime': [{ type: Input },],\n    'padding': [{ type: Input },],\n    'size': [{ type: Input },],\n    'value': [{ type: Input },],\n    'canvas': [{ type: Input },],\n};\nvar QRCodeModule = (function () {\n    function QRCodeModule() {\n    }\nQRCodeModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: QRCodeModule });\nQRCodeModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function QRCodeModule_Factory(t) { return new (t || QRCodeModule)(); } });\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(QRCodeModule, { declarations: [QRCodeComponent], exports: [QRCodeComponent] }); })();\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(QRCodeModule, [{\n        type: NgModule,\n        args: [{\n                exports: [QRCodeComponent],\n                declarations: [QRCodeComponent]\n            }]\n    }], function () { return []; }, null); })();\n    return QRCodeModule;\n}());\n/**\n * @nocollapse\n */\nQRCodeModule.ctorParameters = function () { return []; };\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { QRCodeComponent, QRCodeModule };\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhcjItcXJjb2RlLmpzIiwic291cmNlcyI6WyJhbmd1bGFyMi1xcmNvZGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQU07QUFDTjtBQUNBLEtBT0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Z0RBQUs7QUFDTDtBQUNBLEtBTUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRWxlbWVudFJlZiwgSW5wdXQsIE5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgUVJpb3VzIGZyb20gJ3FyaW91cyc7XG5cbnZhciBRUkNvZGVDb21wb25lbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gZWxlbWVudFJlZlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFFSQ29kZUNvbXBvbmVudChlbGVtZW50UmVmKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudFJlZiA9IGVsZW1lbnRSZWY7XG4gICAgICAgIHRoaXMuYmFja2dyb3VuZCA9ICd3aGl0ZSc7XG4gICAgICAgIHRoaXMuYmFja2dyb3VuZEFscGhhID0gMS4wO1xuICAgICAgICB0aGlzLmZvcmVncm91bmQgPSAnYmxhY2snO1xuICAgICAgICB0aGlzLmZvcmVncm91bmRBbHBoYSA9IDEuMDtcbiAgICAgICAgdGhpcy5sZXZlbCA9ICdMJztcbiAgICAgICAgdGhpcy5taW1lID0gJ2ltYWdlL3BuZyc7XG4gICAgICAgIHRoaXMucGFkZGluZyA9IG51bGw7XG4gICAgICAgIHRoaXMuc2l6ZSA9IDEwMDtcbiAgICAgICAgdGhpcy52YWx1ZSA9ICcnO1xuICAgICAgICB0aGlzLmNhbnZhcyA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez99IGNoYW5nZXNcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIFFSQ29kZUNvbXBvbmVudC5wcm90b3R5cGUubmdPbkNoYW5nZXMgPSBmdW5jdGlvbiAoY2hhbmdlcykge1xuICAgICAgICBpZiAoJ2JhY2tncm91bmQnIGluIGNoYW5nZXMgfHxcbiAgICAgICAgICAgICdiYWNrZ3JvdW5kQWxwaGEnIGluIGNoYW5nZXMgfHxcbiAgICAgICAgICAgICdmb3JlZ3JvdW5kJyBpbiBjaGFuZ2VzIHx8XG4gICAgICAgICAgICAnZm9yZWdyb3VuZEFscGhhJyBpbiBjaGFuZ2VzIHx8XG4gICAgICAgICAgICAnbGV2ZWwnIGluIGNoYW5nZXMgfHxcbiAgICAgICAgICAgICdtaW1lJyBpbiBjaGFuZ2VzIHx8XG4gICAgICAgICAgICAncGFkZGluZycgaW4gY2hhbmdlcyB8fFxuICAgICAgICAgICAgJ3NpemUnIGluIGNoYW5nZXMgfHxcbiAgICAgICAgICAgICd2YWx1ZScgaW4gY2hhbmdlcyB8fFxuICAgICAgICAgICAgJ2NhbnZhcycgaW4gY2hhbmdlcykge1xuICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIFFSQ29kZUNvbXBvbmVudC5wcm90b3R5cGUuZ2VuZXJhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBlbCA9IHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50O1xuICAgICAgICAgICAgZWwuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBxciA9IG5ldyBRUmlvdXMoe1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHRoaXMuYmFja2dyb3VuZCxcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQWxwaGE6IHRoaXMuYmFja2dyb3VuZEFscGhhLFxuICAgICAgICAgICAgICAgIGZvcmVncm91bmQ6IHRoaXMuZm9yZWdyb3VuZCxcbiAgICAgICAgICAgICAgICBmb3JlZ3JvdW5kQWxwaGE6IHRoaXMuZm9yZWdyb3VuZEFscGhhLFxuICAgICAgICAgICAgICAgIGxldmVsOiB0aGlzLmxldmVsLFxuICAgICAgICAgICAgICAgIG1pbWU6IHRoaXMubWltZSxcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiB0aGlzLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgc2l6ZTogdGhpcy5zaXplLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbnZhcykge1xuICAgICAgICAgICAgICAgIGVsLmFwcGVuZENoaWxkKHFyLmNhbnZhcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbC5hcHBlbmRDaGlsZChxci5pbWFnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZCBub3QgZ2VuZXJhdGUgUVIgQ29kZTogXCIgKyBlLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gUVJDb2RlQ29tcG9uZW50O1xufSgpKTtcblFSQ29kZUNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIG1vZHVsZUlkOiAnbW9kdWxlLmlkJyxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ3FyLWNvZGUnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBcIlwiXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKipcbiAqIEBub2NvbGxhcHNlXG4gKi9cblFSQ29kZUNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFtcbiAgICB7IHR5cGU6IEVsZW1lbnRSZWYsIH0sXG5dOyB9O1xuUVJDb2RlQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgICdiYWNrZ3JvdW5kJzogW3sgdHlwZTogSW5wdXQgfSxdLFxuICAgICdiYWNrZ3JvdW5kQWxwaGEnOiBbeyB0eXBlOiBJbnB1dCB9LF0sXG4gICAgJ2ZvcmVncm91bmQnOiBbeyB0eXBlOiBJbnB1dCB9LF0sXG4gICAgJ2ZvcmVncm91bmRBbHBoYSc6IFt7IHR5cGU6IElucHV0IH0sXSxcbiAgICAnbGV2ZWwnOiBbeyB0eXBlOiBJbnB1dCB9LF0sXG4gICAgJ21pbWUnOiBbeyB0eXBlOiBJbnB1dCB9LF0sXG4gICAgJ3BhZGRpbmcnOiBbeyB0eXBlOiBJbnB1dCB9LF0sXG4gICAgJ3NpemUnOiBbeyB0eXBlOiBJbnB1dCB9LF0sXG4gICAgJ3ZhbHVlJzogW3sgdHlwZTogSW5wdXQgfSxdLFxuICAgICdjYW52YXMnOiBbeyB0eXBlOiBJbnB1dCB9LF0sXG59O1xudmFyIFFSQ29kZU1vZHVsZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUVJDb2RlTW9kdWxlKCkge1xuICAgIH1cbiAgICByZXR1cm4gUVJDb2RlTW9kdWxlO1xufSgpKTtcblFSQ29kZU1vZHVsZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogTmdNb2R1bGUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgZXhwb3J0czogW1FSQ29kZUNvbXBvbmVudF0sXG4gICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zOiBbUVJDb2RlQ29tcG9uZW50XVxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqXG4gKiBAbm9jb2xsYXBzZVxuICovXG5RUkNvZGVNb2R1bGUuY3RvclBhcmFtZXRlcnMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBbXTsgfTtcblxuLyoqXG4gKiBHZW5lcmF0ZWQgYnVuZGxlIGluZGV4LiBEbyBub3QgZWRpdC5cbiAqL1xuXG5leHBvcnQgeyBRUkNvZGVDb21wb25lbnQsIFFSQ29kZU1vZHVsZSB9O1xuIl19","<div class=\"container\">\r\n  <section class=\"header\">\r\n    <div class=\"title\">\r\n      {{ selectedProfesson?.name }}\r\n      <qkc-change-profession (professionChange)=\"professionChange($event)\" *ngIf='changeProfession'\r\n                             [select]='selected' [hidden]='from===\"scp\"'></qkc-change-profession>\r\n    </div>\r\n    <div>\r\n      <button nz-button nzType=\"primary\" class=\"margin-btn\" (click)=\"goback()\" *ngIf=\"from==='scp'\">完成调用</button>\r\n      <button nz-dropdown nzTrigger=\"click\" [nzDropdownMenu]=\"menu\" nz-button *ngIf=\"from===''\"\r\n              nzType=\"primary\" class=\"margin-btn\">新增阅读\r\n      </button>\r\n      <nz-dropdown-menu #menu=\"nzDropdownMenu\">\r\n        <ul nz-menu>\r\n          <ng-container *ngFor=\"let item of materialMenus\">\r\n            <li nz-menu-item (click)=\"selectMenu(item)\">{{ item?.name }}</li>\r\n          </ng-container>\r\n        </ul>\r\n      </nz-dropdown-menu>\r\n    </div>\r\n  </section>\r\n\r\n  <section class=\"resource-container\" nz-row>\r\n    <section class=\"left-tree\"\r\n             nz-resizable\r\n             [style.width.px]=\"width\"\r\n             (nzResize)=\"onResize($event)\"\r\n    >\r\n      <div #treeContainer style='display:inline-block;overflow:hidden;margin-right: 30px;'>\r\n        <qkc-tree-knowledgegraph model=\"click\" [professionId]=\"selectedProfesson?.id\"\r\n                                 (nodeChange)=\"nodeChange($event)\" *ngIf='knowledgegraphTree'\r\n                                 [allNodes]='true'></qkc-tree-knowledgegraph>\r\n      </div>\r\n\r\n      <nz-resize-handle nzDirection=\"right\">\r\n        <div class=\"right-wrap\">\r\n          <i class=\"right\" nz-icon nzType=\"more\" nzTheme=\"outline\"></i>\r\n        </div>\r\n      </nz-resize-handle>\r\n    </section>\r\n    <section class=\"right-resource\">\r\n      <section class=\"search-container\">\r\n        <div class=\"list\">\r\n          <div class=\"list-title\">关键词搜索：</div>\r\n          <input nz-input placeholder=\"支持标题\"\r\n                 style='width: 200px'\r\n                 [(ngModel)]=\"condition\" (keyup.enter)='searchData(\"button\")' (ngModelChange)='storingData()'/>\r\n          <div class=\"list-title\" style='margin-left: 40px;'>资源类型：</div>\r\n          <nz-select nzShowSearch nzAllowClear nzPlaceHolder=\"请选择资源类型\" [(ngModel)]='coursewareType'\r\n                     (ngModelChange)='storingData()' style='width:200px;'\r\n                     nzMode=\"multiple\" style='width: 200px'>\r\n            <nz-option nzValue=\"101\" nzLabel=\"讲义\"></nz-option>\r\n            <nz-option nzValue=\"102\" nzLabel=\"资料\"></nz-option>\r\n            <nz-option nzValue=\"103\" nzLabel=\"视频\"></nz-option>\r\n          </nz-select>\r\n          <div class=\"list-title\" style='margin-left: 40px;'>学习目标：</div>\r\n          <nz-select [(ngModel)]=\"learningGoalCode\" class=\"list-input\" nzMode=\"multiple\" nzShowSearch\r\n                     (ngModelChange)='storingData()' style='width:200px;'>\r\n            <nz-option nzValue=\"1\" nzLabel=\"了解\"></nz-option>\r\n            <nz-option nzValue=\"2\" nzLabel=\"理解\"></nz-option>\r\n            <nz-option nzValue=\"3\" nzLabel=\"掌握\"></nz-option>\r\n            <nz-option nzValue=\"4\" nzLabel=\"应用\"></nz-option>\r\n            <nz-option nzValue=\"5\" nzLabel=\"分析\"></nz-option>\r\n            <nz-option nzValue=\"6\" nzLabel=\"创新\"></nz-option>\r\n          </nz-select>\r\n          <button nz-button nzType=\"primary\" style='margin-left: 40px;' (click)='searchData(\"button\")'>查询</button>\r\n          <button nz-button nzType=\"primary\" style='margin-left: 20px;' (click)=\"resetData()\" *ngIf='from !== \"scp\"'>\r\n            重置\r\n          </button>\r\n        </div>\r\n      </section>\r\n      <section class=\"table-container\" id='tableScroll' [class.no-scoll]='!data.length'>\r\n        <nz-table #ajaxTable [nzData]=\"data\" [nzFrontPagination]=\"false\"\r\n                  [nzScroll]='{x:\"1300px\",y : height+\"px\"}'\r\n                  [nzShowSizeChanger]=\"true\"\r\n                  [nzShowTotal]=\"totalTemplate\" [nzLoading]=\"isLoading\" [nzTotal]=\"total\"\r\n                  [(nzPageIndex)]=\"pageIndex\"\r\n                  [nzPageSizeOptions]='[15, 20, 30, 40, 50]'\r\n                  [(nzPageSize)]=\"pageSize\" (nzPageIndexChange)=\"searchData()\"\r\n                  (nzPageSizeChange)=\"searchData()\">\r\n          <thead class=\"source-header\">\r\n          <tr>\r\n            <th nzWidth='220px'>标题</th>\r\n            <th nzWidth='120px'>资源类型</th>\r\n            <th nzWidth='220px'>知识点</th>\r\n            <th nzWidth='120px'>学习目标</th>\r\n            <th nzWidth='120px'>创建者</th>\r\n            <th nzWidth='120px'>作者</th>\r\n            <!--            <th>单位</th>-->\r\n            <th nzWidth='120px'>更新时间</th>\r\n            <th [nzShowSort]='true' [nzSortOrder]='order' nzWidth='100px'\r\n                (nzSortOrderChange)='nzSortOtrderChange($event)'>使用次数\r\n            </th>\r\n            <th nzWidth='160px' nzRight>操作</th>\r\n          </tr>\r\n          </thead>\r\n          <tbody>\r\n          <tr *ngFor=\"let data of ajaxTable.data;let i = index\">\r\n            <td><span class='synopsis-text'>{{ data?.title }}</span></td>\r\n            <td>{{ getName(data?.type, 'MATERIAL_TYPE') }}</td>\r\n            <td style='cursor:pointer;'><span class='synopsis-text' nz-tooltip\r\n                                              [nzTooltipTitle]=\"data?.pointName\">{{data?.pointName}}</span></td>\r\n            <td>{{ getName(data?.learningGoalCode, 'LEARNING_TARGET') }}</td>\r\n            <td>{{ data?.createrName }}</td>\r\n            <td>{{ data?.authorName }}</td>\r\n            <!--            <td>{{ data?.authorUnit }}</td>-->\r\n            <td>{{ getDate(data?.lastModifiedTime)}}</td>\r\n            <td>{{ data?.useTime}}</td>\r\n            <td *ngIf=\"from==''\" nzRight>\r\n              <a (click)=\"preview(data)\">预览 </a>\r\n              <a (click)=\"edit(data)\">编辑 </a>\r\n              <a (click)=\"qcode(data)\">二维码 </a>\r\n              <a class=\"light-color\" (click)=\"del(data)\" *ngIf='delIF(data)'>删除</a>\r\n            </td>\r\n            <td *ngIf=\"from=='scp'\" nzRight>\r\n              <a (click)=\"preview(data)\">预览 </a>\r\n              <a (click)=\"callResource(data, i)\" *ngIf=\"!data.isCall && data.supportType && permitedCall\">调用</a>\r\n              <a\r\n                class=\"light-color\"\r\n                (click)=\"cancelCallResource(data, i)\"\r\n                *ngIf=\"data.isCall && !callResourceData.isStandard\">\r\n                取消调用\r\n              </a>\r\n              <a\r\n                class=\"light-color\"\r\n                (click)=\"cancelCallResource(data, i)\"\r\n                *ngIf=\"data.isCall && callResourceData.isStandard && data.taskType === '4'\">\r\n                取消调用\r\n              </a>\r\n              <a\r\n                *ngIf=\"data.isCall && callResourceData.isStandard && data.taskType !== '4'\"\r\n                style=\"color: #999;\">\r\n                已调用\r\n              </a>\r\n            </td>\r\n          </tr>\r\n          </tbody>\r\n        </nz-table>\r\n      </section>\r\n      <ng-template #totalTemplate let-total>共 {{ total }} 条记录</ng-template>\r\n    </section>\r\n  </section>\r\n</div>\r\n\r\n<nz-modal [(nzVisible)]=\"qrcodeVisible\" nzTitle=\"生成二维码\" (nzOnCancel)=\"qrcodeVisible=false\" [nzFooter]='null'>\r\n  <div style='display:flex;justify-content:center;margin-bottom:10px;font-size:18px;'>\r\n      {{qrName}}\r\n  </div>\r\n  <div style='display:flex;justify-content:center;'>\r\n    <qr-code [value]='qrcode' [size]='size' *ngIf='qrcode' id='qr-code'></qr-code>\r\n  </div>\r\n  <div style='display:flex;justify-content:center;'>\r\n    <button nz-button [nzType]=\"'primary'\" (click)=\"downloadQrcode()\" style='margin: 20px 0;'>下载二维码图片</button>\r\n  </div>\r\n</nz-modal>\r\n\r\n\r\n<app-resource-preview-modal [isPreviewpolyway]='isPreviewpolyway' [previewTitle]='previewTitle'\r\n                            [resourceUrl]='resourceUrl' *ngIf='previewStart'\r\n                            (closePreview)='closePreview()'></app-resource-preview-modal>\r\n","import {Component, ElementRef, Inject, LOCALE_ID, ViewChild} from '@angular/core';\r\nimport {NzMessageService} from 'ng-zorro-antd/message';\r\nimport {NzModalService} from 'ng-zorro-antd/modal';\r\nimport {MenuService} from 'core/services/menu.service';\r\nimport {MaterialLibraryService} from '@app/busi-services/material-library.service';\r\nimport {getName, MATERIAL_TYPE, STATISTICALRULES} from 'core/base/static-data';\r\nimport {NzTreeNodeOptions} from 'ng-zorro-antd';\r\nimport {CourseManageService} from 'src/app/busi-services/course-manage.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {NzResizeEvent} from 'ng-zorro-antd/resizable/public-api';\r\nimport {SessionStorageUtil} from 'core/utils/sessionstorage.util';\r\nimport {forkJoin, timer} from 'rxjs';\r\nimport {SearchTableComponent} from '@app/routes/course-manage/components';\r\nimport {ToolsUtil} from 'core/utils/tools.util';\r\nimport {ConfirmableFlat} from 'core/decorators';\r\nimport {LoadingControl} from 'core/base/common';\r\nimport {StatisticsLogService} from '@app/busi-services/statistics-log.service';\r\nimport {environment} from 'src/environments/environment';\r\n\r\n\r\n@Component({\r\n  selector: 'app-read-lib',\r\n  templateUrl: './read-lib.component.html',\r\n  styleUrls: ['./read-lib.component.less'],\r\n})\r\nexport class ReadLibComponent extends SearchTableComponent {\r\n  _PAGE_ID_ = 'MaterialReadLibraryComponent';\r\n  id = -1;\r\n  width;\r\n  selectedProfesson: any;\r\n  materialMenus = MATERIAL_TYPE.filter((item) => item.id !== '104');\r\n  knowledgePointId = '';\r\n  curSelectedItem: any;\r\n  // 调用相关参数\r\n  from: '' | 'scp' = '';\r\n  callResourceData: any = {};\r\n  callResourceId = 'MaterialCallResource';\r\n  // 允许调用\r\n  permitedCall = true;\r\n  type = '0';\r\n  fileType = '0';\r\n  task;\r\n  reward; // 是否记录日志\r\n  selected = '';\r\n  getTwoWords = ToolsUtil.getTwoWords;\r\n  getName = getName;\r\n  conditionObj = {\r\n    category: 100, // 200 习题 100 素材\r\n    knowledgeSubjectId: '', // 学科id\r\n    knowledgeModuleId: '', // 知识模块id\r\n    knowledgeUnitId: '', // 知识单元id\r\n    knowledgePointId: '', // 知识点id\r\n    condition: '', // 模糊查询条件\r\n    coursewareType: [], // 资源类型\r\n    learningGoalCode: [], // 学习目标\r\n  };\r\n  condition = ''; // 模糊查询条件\r\n  coursewareType = []; // 资源类型\r\n  learningGoalCode: any = []; // 学习目标\r\n  init = false; // 初始化\r\n  knowledgegraphTree = true; // 树\r\n  changeProfession = true; //  切换课程\r\n  resourceUrl: any; // 预览地址\r\n  previewTitle = '';\r\n  isPreviewpolyway = false; // 保利威\r\n  previewStart = false;\r\n  order = null;\r\n  qrcode = '';\r\n  qrName = '';\r\n  size = 200;\r\n  qrcodeVisible: any;\r\n  @ViewChild('treeContainer') treeContainer: ElementRef<any>;\r\n\r\n\r\n  constructor(\r\n    private materialLibService: MaterialLibraryService,\r\n    private menuService: MenuService,\r\n    private modalService: NzModalService,\r\n    public message: NzMessageService,\r\n    public courseMgService: CourseManageService,\r\n    public route: ActivatedRoute,\r\n    private statisticsLogService: StatisticsLogService,\r\n    @Inject(LOCALE_ID) public locale: string\r\n  ) {\r\n    super();\r\n  }\r\n\r\n\r\n  /*\r\n  * @Override\r\n  * @*/\r\n  initData() {\r\n    this.selected = SessionStorageUtil.getReadtree() || SessionStorageUtil.getPacketInfoItem('code');\r\n    const {from, task, reward} = this.route.snapshot.queryParams;\r\n    this.task = task;\r\n    this.reward = reward;\r\n    if (from === 'scp') {\r\n      this.from = from;\r\n      if (this.task === '101' || this.task === '102') {\r\n        this.conditionObj.coursewareType = [this.task];\r\n        this.coursewareType = [this.task];\r\n      } else {\r\n        this.conditionObj.coursewareType = ['101', '102', '103'];\r\n        this.coursewareType = ['101', '102', '103'];\r\n      }\r\n      this.storingData();\r\n      this.callResourceData = SessionStorageUtil.getScpResourceMaterial();\r\n    }\r\n  }\r\n\r\n\r\n  /*\r\n  * @Override\r\n  * @*/\r\n  collectParam() {\r\n    const {condition, learningGoalCode, coursewareType} = SessionStorageUtil.getSearch(this._PAGE_ID_);\r\n    this.condition = condition || '';\r\n    this.learningGoalCode = learningGoalCode || [];\r\n    this.coursewareType = coursewareType || [];\r\n  }\r\n\r\n  /*\r\n  * @Override\r\n  * @*/\r\n  sybcParam() {\r\n    this.conditionObj.condition = this.condition;\r\n    this.conditionObj.coursewareType = this.coursewareType;\r\n    this.conditionObj.learningGoalCode = this.learningGoalCode;\r\n  }\r\n\r\n  /*\r\n  * @Override\r\n  * @*/\r\n  storingData() {\r\n    const {condition, coursewareType, learningGoalCode} = this;\r\n    this.passData({condition, learningGoalCode, coursewareType});\r\n  }\r\n\r\n  /*\r\n* @Override\r\n* @*/\r\n  resetInit() {\r\n    this.condition = '';\r\n    this.coursewareType = [];\r\n    this.learningGoalCode = [];\r\n    this.conditionObj.coursewareType = [];\r\n    this.conditionObj.learningGoalCode = [];\r\n    this.conditionObj.condition = '';\r\n  }\r\n\r\n  /*\r\n  * @Override\r\n  * @*/\r\n  getDataList(): void {\r\n    this.conditionObj.condition = this.conditionObj.condition.trim();\r\n    const param: any = {\r\n      ...this.conditionObj,\r\n      page: this.pageIndex,\r\n      limit: this.pageSize,\r\n    };\r\n    if (this.order) {\r\n      param.sort = this.order === 'ascend' ? 'useTime|asc' : 'useTime|desc';\r\n    }\r\n    if (!this.conditionObj.coursewareType.length) {\r\n      param.coursewareType = ['101', '102', '103'];\r\n    }\r\n    const success = (result: any) => {\r\n      this.isLoading = false;\r\n      if (result.status === 200) {\r\n        if (result.data && result.data.records && result.data.records.length) {\r\n          this.data = result.data.records;\r\n          //   .sort((stringA, stringB) => {\r\n          //   if (this.order === 'ascend') {\r\n          //     if (stringB.useTime < stringA.useTime) {\r\n          //       return -1;\r\n          //     }\r\n          //     if (stringB.useTime > stringA.useTime) {\r\n          //       return 1;\r\n          //     }\r\n          //     return 0;\r\n          //   } else if (this.order === 'descend') {\r\n          //     if (stringA.useTime < stringB.useTime) {\r\n          //       return -1;\r\n          //     }\r\n          //     if (stringA.useTime > stringB.useTime) {\r\n          //       return 1;\r\n          //     }\r\n          //     return 0;\r\n          //   } else {\r\n          //     if (stringA.useTime < stringB.useTime) {\r\n          //       return 1;\r\n          //     }\r\n          //     if (stringA.useTime > stringB.useTime) {\r\n          //       return -1;\r\n          //     }\r\n          //     return 0;\r\n          //   }\r\n          // });\r\n          // .map((item, i) => {\r\n          //   if (i === 2) {\r\n          //     item.useTime = 2;\r\n          //   }\r\n          //   return item;\r\n          // });\r\n          this.total = result.data.total;\r\n          if (this.from === 'scp' && this.callResourceData.nodes) {\r\n            // 调用\r\n            this.data = this.data.map((item) => {\r\n              const hasCallItem = this.callResourceData.nodes.find(\r\n                (it) => it.id === item.id\r\n              );\r\n              if (hasCallItem) {\r\n                item.isCall = true;\r\n                item.taskId = hasCallItem.taskId;\r\n                item.taskType = hasCallItem.taskType;\r\n              } else {\r\n                item.taskType = '-1';\r\n              }\r\n              item.supportType = this.supportType(item.fileType);\r\n              return item;\r\n            });\r\n            this.setPermitedCall();\r\n          }\r\n        } else {\r\n          this.data = [];\r\n          this.total = 0;\r\n        }\r\n      } else {\r\n        this.data = [];\r\n        this.total = 0;\r\n        this.message.create('error', result.message);\r\n      }\r\n    };\r\n    const error = (err: any) => {\r\n      this.isLoading = false;\r\n      this.message.create('error', JSON.stringify(err));\r\n    };\r\n    this.isLoading = true;\r\n    const work = [this.materialLibService.resConditionQuery(param)];\r\n    forkJoin(work).subscribe(\r\n      (ret) => {\r\n        this.isLoading = false;\r\n        success(ret[0]);\r\n      },\r\n      (err) => {\r\n        this.isLoading = false;\r\n        error(err);\r\n      }\r\n    );\r\n  }\r\n\r\n  /*\r\n  * @Override\r\n  * @*/\r\n  ngOnAttach() {\r\n    this.selected = SessionStorageUtil.getReadtree() || SessionStorageUtil.getPacketInfoItem('code');\r\n    this.collectParam();\r\n    this.sybcParam();\r\n    this.init = false;\r\n    this.knowledgegraphTree = false;\r\n    this.changeProfession = false;\r\n    timer(0).subscribe(() => {\r\n      this.knowledgegraphTree = true;\r\n      this.changeProfession = true;\r\n    });\r\n  }\r\n\r\n\r\n  onResize({width, height}: NzResizeEvent): void {\r\n    const flag = this.treeContainer\r\n      && this.treeContainer.nativeElement\r\n      && this.treeContainer.nativeElement.offsetWidth;\r\n    if (\r\n      flag && ((this.treeContainer.nativeElement.offsetWidth + 50 < width))\r\n      ||\r\n      (flag && (this.treeContainer.nativeElement.offsetWidth + 10) > width)\r\n    ) {\r\n      return;\r\n    }\r\n    cancelAnimationFrame(this.id);\r\n    this.id = requestAnimationFrame(() => {\r\n      // tslint:disable-next-line:no-non-null-assertion\r\n      this.width = width!;\r\n    });\r\n  }\r\n\r\n  professionChange(item: any): void {\r\n    SessionStorageUtil.putReadtree(item.code);\r\n    this.selectedProfesson = item;\r\n    this.conditionObj.knowledgeSubjectId = item.id;\r\n    if (!this.init) {\r\n      this.init = true;\r\n      this.searchData('collect');\r\n    } else {\r\n      this.pageIndex = 1;\r\n      this.searchData();\r\n    }\r\n  }\r\n\r\n  nodeChange(nodeOpt: NzTreeNodeOptions) {\r\n    if (nodeOpt.kType === '1') {\r\n      this.conditionObj.knowledgeSubjectId = nodeOpt.id;\r\n      this.conditionObj.knowledgeModuleId = '';\r\n      this.conditionObj.knowledgeUnitId = '';\r\n      this.conditionObj.knowledgePointId = '';\r\n    } else if (nodeOpt.kType === '2') {\r\n      this.conditionObj.knowledgeSubjectId = '';\r\n      this.conditionObj.knowledgeModuleId = nodeOpt.id;\r\n      this.conditionObj.knowledgeUnitId = '';\r\n      this.conditionObj.knowledgePointId = '';\r\n    } else if (nodeOpt.kType === '3') {\r\n      this.conditionObj.knowledgeSubjectId = '';\r\n      this.conditionObj.knowledgeModuleId = '';\r\n      this.conditionObj.knowledgeUnitId = nodeOpt.id;\r\n      this.conditionObj.knowledgePointId = '';\r\n    } else if (nodeOpt.kType === '4') {\r\n      this.conditionObj.knowledgeSubjectId = '';\r\n      this.conditionObj.knowledgeModuleId = '';\r\n      this.conditionObj.knowledgeUnitId = '';\r\n      this.conditionObj.knowledgePointId = nodeOpt.id;\r\n      this.knowledgePointId = nodeOpt.id;\r\n    }\r\n    this.pageIndex = 1;\r\n    this.searchData();\r\n  }\r\n\r\n  selectMenu(item: any) {\r\n    if (!this.selectedProfesson) {\r\n      return this.message.error('还没有建立学科哦~');\r\n    }\r\n    const selectedProfessonId = this.selectedProfesson ? this.selectedProfesson.id : 0;\r\n    this.menuService.gotoUrl({\r\n      url: '/m/rm/material-details',\r\n      paramUrl: `/0/${item.id}/${selectedProfessonId}?knowledgeId=${this.conditionObj.knowledgePointId || ''}&t=${new Date().getTime()}`,\r\n      title: '新增' + item.name\r\n    });\r\n  }\r\n\r\n\r\n  edit(data: any) {\r\n    this.menuService.gotoUrl({\r\n      url: '/m/rm/material-details',\r\n      paramUrl: `/${data.id}/${data.type}/${this.selectedProfesson.id}`,\r\n    });\r\n  }\r\n\r\n  qcode(data) {\r\n    this.materialLibService.getResourceDetail(data.id, data.type).subscribe(result => {\r\n      if (result.status === 200) {\r\n        this.qrName = result.data.title;\r\n        if (data.sourceType === '2') {\r\n          this.qrcode = environment.ow365.substr(0, environment.ow365.length - 5)\r\n            + 'polywayId=' +\r\n            result.data.resourceUrl\r\n            + '&share=0&native=0&ow365=1';\r\n        } else {\r\n          this.qrcode = environment.ow365 + environment.OSS_URL +\r\n            (result.data.resourceUrl.indexOf('/') === '0' ?\r\n              result.data.resourceUrl : ( '/' + result.data.resourceUrl)) + '&share=0&native=0&ow365=1';\r\n        }\r\n        this.qrcodeVisible = true;\r\n        console.log(this.qrcode);\r\n      }\r\n    });\r\n  }\r\n\r\n  goback() {\r\n    this.menuService.goBack(false);\r\n    this.menuService.gotoUrl({\r\n      title: '课包建设',\r\n      url: `/m/course-manage/prepare-course`,\r\n      paramUrl: ``\r\n    });\r\n  }\r\n\r\n\r\n  preview(data: any) {\r\n    if ((data.title.indexOf('.') < 0) && data.sourceType === '2' && data.type === '103') {\r\n      this.isPreviewpolyway = false;\r\n      this.previewStart = false;\r\n      timer(0).subscribe(() => {\r\n        this.resourceUrl = data.fileType;\r\n        this.previewTitle = '';\r\n        this.isPreviewpolyway = true;\r\n        this.previewStart = true;\r\n      });\r\n    } else {\r\n      this.materialLibService.getResourceDetail(data.id, data.type).subscribe(result => {\r\n        if (result.status === 200) {\r\n          if (result.data.attachmentName.indexOf('.') < 0 && result.data.sourceType === '2' && data.type === '103') {\r\n            this.previewStart = false;\r\n            this.isPreviewpolyway = false;\r\n            timer(0).subscribe(() => {\r\n              this.resourceUrl = data.fileType;\r\n              this.previewTitle = '';\r\n              this.isPreviewpolyway = true;\r\n              this.previewStart = true;\r\n            });\r\n          } else {\r\n            this.previewStart = false;\r\n            this.isPreviewpolyway = false;\r\n            timer(0).subscribe(() => {\r\n              this.isPreviewpolyway = false;\r\n              this.resourceUrl = result.data.resourceUrl;\r\n              this.previewTitle = result.data.title;\r\n              this.previewStart = true;\r\n            });\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  closePreview() {\r\n    this.isPreviewpolyway = false;\r\n    this.resourceUrl = '';\r\n    this.previewTitle = '';\r\n    this.previewStart = false;\r\n  }\r\n\r\n\r\n  @ConfirmableFlat({\r\n    title: (args) => (`确定删除\"${args[0].title}\"的阅读资源？`),\r\n    content: '',\r\n    type: 'warning'\r\n  })\r\n  del(data: any, loadingControl?: LoadingControl) {\r\n    return new Promise((resolve) => {\r\n      this.materialLibService.delResource(data.id).subscribe(\r\n        (result) => {\r\n          if (result.status === 200) {\r\n            resolve(true);\r\n            this.searchData();\r\n          } else {\r\n            resolve(false);\r\n            if (result.status === 500) {\r\n              this.message.error('服务端业务异常');\r\n            }\r\n          }\r\n        },\r\n        (error) => {\r\n          resolve(false);\r\n          this.message.error(JSON.stringify(error));\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  setPermitedCall() {\r\n    if (this.callResourceData.hasOwnProperty('limit')) {\r\n      if (Number(this.callResourceData.limit) === 0) {\r\n        this.permitedCall = true;\r\n      } else if (\r\n        this.callResourceData.nodes.length >= this.callResourceData.limit || Number(this.callResourceData.limit) === -1\r\n      ) {\r\n        this.permitedCall = false;\r\n      } else {\r\n        this.permitedCall = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  supportType(fileType: string) {\r\n    if (!fileType) {\r\n      return true;\r\n    }\r\n    if (!this.callResourceData.supportFileType) {\r\n      return true;\r\n    }\r\n    const supportFileType: string = this.callResourceData.supportFileType;\r\n    return supportFileType.indexOf(fileType.toLowerCase()) !== -1;\r\n  }\r\n\r\n  callResource(data, index) {\r\n    // 调用\r\n    const error = (err) => {\r\n      this.isLoading = false;\r\n      this.message.warning(JSON.stringify(err));\r\n    };\r\n    const getParams = () => {\r\n      if (this.callResourceData.type === 'scp-section-handout') {\r\n        return {\r\n          ...this.callResourceData.sectionInfo,\r\n          resourceId: data.id,\r\n        };\r\n      }\r\n    };\r\n    const getSource$ = (params: any) => {\r\n      if (this.callResourceData.type === 'scp-section-handout') {\r\n        if (this.task === '1') {\r\n          return this.courseMgService.invoke_courseSectionFileTask(params);\r\n        } else if (this.task === '2') {\r\n          return this.courseMgService.levelInformationAddAndModify(params);\r\n        } else {\r\n          return this.courseMgService.invoke_courseSectionFile(params);\r\n        }\r\n      }\r\n    };\r\n    const paramResult: any = getParams();\r\n    if (this.task === '1') {\r\n      paramResult.sourceType = data.sourceType;\r\n      paramResult.name = data.title;\r\n      paramResult.taskType = '0';\r\n      paramResult.downloadType = '0';\r\n    } else if (this.task === '2') {\r\n      paramResult.title = data.title;\r\n    } else {\r\n      paramResult.sourceType = data.sourceType;\r\n      if (this.task === '101') {\r\n        paramResult.downloadType = '0';\r\n      } else {\r\n        paramResult.downloadType = '2';\r\n      }\r\n      paramResult.resourceId = data.id;\r\n      paramResult.type = this.task;\r\n      paramResult.category = data.category;\r\n      paramResult.title = data.title;\r\n    }\r\n    paramResult.seq = SessionStorageUtil.getScpResourceMaterial().seq;\r\n    const source$ = getSource$(paramResult);\r\n    this.isLoading = true;\r\n    source$.subscribe((res) => {\r\n      this.isLoading = false;\r\n      if (res.status === 201) {\r\n        const {task} = this;\r\n        let field = '';\r\n        if (task === '1') {\r\n          field = 'learnSet-task-action';\r\n        } else if (task === '101') {\r\n          field = 'learnSet-lecture-action';\r\n        } else if (task === '104') {\r\n          field = 'learnSet-material-action';\r\n        } else {\r\n          field = 'learnSet-record-action';\r\n        }\r\n        if (this.reward === '1') {\r\n          this.statisticsLogService.statisticsPacketInfoLog({\r\n            name: '关卡奖励设置阅读库调用',\r\n            actionCode: STATISTICALRULES.packetInfo['otherSet-levelthrough-action'].modify,\r\n            content: JSON.stringify(paramResult),\r\n          });\r\n        } else {\r\n          this.statisticsLogService.statisticsPacketInfoLog({\r\n            name: '阅读库调用',\r\n            actionCode: STATISTICALRULES.packetInfo[field].addCode,\r\n            content: JSON.stringify(paramResult),\r\n          });\r\n        }\r\n        if (res.data && res.data.id) {\r\n          this.data[index].isCall = true;\r\n          this.data[index].taskId = res.data.id;\r\n          this.data[index].taskType = res.data.taskType;\r\n          this.callResourceData.nodes.push({\r\n            id: this.data[index].id,\r\n            taskId: res.data.id,\r\n            taskType: res.data.taskType,\r\n          });\r\n          this.callResourceData.seq += 1;\r\n          SessionStorageUtil.putScpResourceMaterial(this.callResourceData);\r\n          this.setPermitedCall();\r\n        }\r\n      } else {\r\n        if (res.status === 500) {\r\n          this.message.error('服务器业务异常导致调用失败，可能标题太长，请保持35字符以内');\r\n        } else {\r\n          this.message.error(res.message);\r\n        }\r\n      }\r\n    }, error);\r\n  }\r\n\r\n  cancelCallResource(data, index) {\r\n    // 取消调用\r\n    this.modalService.warning({\r\n      nzTitle: '警告',\r\n      nzContent: this.task === '2' ? '确定取消调用吗？' : '删除该资源将会导致现有的记录丢失，确定删除吗？',\r\n      nzCancelText: '取消',\r\n      nzOkText: '确定',\r\n      nzOnOk: () => {\r\n        return new Promise((resolve) => {\r\n          const error = (err) => {\r\n            this.isLoading = false;\r\n            this.message.warning(JSON.stringify(err));\r\n            resolve(false);\r\n          };\r\n          const getSource$ = () => {\r\n            if (this.callResourceData.type === 'scp-section-handout') {\r\n              if (this.task === '1') {\r\n                return this.courseMgService.del_courseSectionFileTask(\r\n                  data.taskId\r\n                );\r\n              } else if (this.task === '2') {\r\n                return this.courseMgService.levelDataDeletion(\r\n                  data.taskId\r\n                );\r\n              } else {\r\n                return this.courseMgService.del_courseSectionFile(\r\n                  data.taskId\r\n                );\r\n              }\r\n            }\r\n          };\r\n          const success = (res) => {\r\n            this.isLoading = false;\r\n            if (res.status === 204) {\r\n              if (this.reward === '1') {\r\n                this.statisticsLogService.statisticsPacketInfoLog({\r\n                  name: '关卡奖励设置阅读库取消调用',\r\n                  actionCode: STATISTICALRULES.packetInfo['otherSet-levelthrough-action'].modify,\r\n                  content: data.taskId\r\n                });\r\n              } else {\r\n                const {task} = this;\r\n                let field = '';\r\n                if (task === '1') {\r\n                  field = 'learnSet-task-action';\r\n                } else if (task === '101') {\r\n                  field = 'learnSet-lecture-action';\r\n                } else if (task === '104') {\r\n                  field = 'learnSet-material-action';\r\n                } else {\r\n                  field = 'learnSet-record-action';\r\n                }\r\n                this.statisticsLogService.statisticsPacketInfoLog({\r\n                  name: '阅读库取消调用',\r\n                  actionCode: STATISTICALRULES.packetInfo[field].delCode,\r\n                  content: data.taskId\r\n                });\r\n              }\r\n              this.data[index].isCall = false;\r\n              this.callResourceData.nodes = this.callResourceData.nodes.filter(\r\n                (item) => item.id !== this.data[index].id\r\n              );\r\n              this.callResourceData.seq -= 1;\r\n              SessionStorageUtil.putScpResourceMaterial(this.callResourceData);\r\n              this.setPermitedCall();\r\n              resolve(true);\r\n            } else {\r\n              this.message.warning(res.message || '删除失败');\r\n              resolve(false);\r\n            }\r\n          };\r\n          this.isLoading = true;\r\n          getSource$().subscribe(success, error);\r\n        });\r\n      },\r\n    });\r\n  }\r\n\r\n  nzSortOtrderChange($event: string | 'ascend' | 'descend') {\r\n    this.order = $event;\r\n    this.getDataList();\r\n    // let pre = -1;\r\n    // let last = 1;\r\n    // if ($event === 'ascend') {\r\n    //   pre = -1;\r\n    //   last = 1;\r\n    // } else if ($event === 'descend') {\r\n    //   pre = 1;\r\n    //   last = -1;\r\n    // } else {\r\n    //   this.data = this.data.sort((stringB, stringA) => {\r\n    //     if (stringA.lastModifiedTime < stringB.lastModifiedTime) {\r\n    //       return -1;\r\n    //     }\r\n    //     if (stringA.lastModifiedTime > stringB.lastModifiedTime) {\r\n    //       return 1;\r\n    //     }\r\n    //     return 0;\r\n    //   });\r\n    //   return;\r\n    // }\r\n    // this.data = this.data.sort((stringB, stringA) => {\r\n    //   if (stringA.useTime < stringB.useTime) {\r\n    //     return pre;\r\n    //   }\r\n    //   if (stringA.useTime > stringB.useTime) {\r\n    //     return last;\r\n    //   }\r\n    //   return 0;\r\n    // });\r\n  }\r\n\r\n  delIF(data: any) {\r\n    return String(data.useTime) === '0';\r\n  }\r\n\r\n  downloadQrcode() {\r\n    const link = document.createElement('a');\r\n    link.setAttribute('href', (document.querySelector('#qr-code > img') as HTMLImageElement).src);\r\n    link.setAttribute('download', (this.qrName.indexOf('.') > -1 ? this.qrName.split('.')[0] : this.qrName) + '.png');\r\n    link.style.visibility = 'hidden';\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  }\r\n}\r\n","<div class=\"container\">\r\n  <section class=\"header\">\r\n    <div class=\"title\">\r\n      {{ selectedProfesson?.name }}\r\n      <qkc-change-profession (professionChange)=\"professionChange($event)\" [select]='selected'\r\n                             *ngIf='changeProfession' [hidden]='from===\"scp\"'></qkc-change-profession>\r\n    </div>\r\n    <div>\r\n      <button nz-button nzType=\"primary\" class=\"margin-btn\" (click)=\"goback()\" *ngIf=\"from==='scp'\">完成调用</button>\r\n      <button nz-button nzType=\"primary\" class=\"margin-btn\" (click)=\"goAddCase()\" *ngIf=\"from===''\">新增案例</button>\r\n    </div>\r\n  </section>\r\n\r\n  <section class=\"resource-container\" nz-row>\r\n    <section class=\"left-tree\" nz-resizable\r\n             [style.width.px]=\"width\"\r\n             (nzResize)=\"onResize($event)\">\r\n      <div #treeContainer style='display:inline-block;overflow:hidden;margin-right: 30px;'>\r\n        <qkc-tree-knowledgegraph model=\"click\" [professionId]=\"selectedProfesson?.id\" *ngIf='knowledgegraphTree'\r\n                                 (nodeChange)=\"nodeChange($event)\" [allNodes]='true'></qkc-tree-knowledgegraph>\r\n      </div>\r\n      <nz-resize-handle nzDirection=\"right\">\r\n        <div class=\"right-wrap\">\r\n          <i class=\"right\" nz-icon nzType=\"more\" nzTheme=\"outline\"></i>\r\n        </div>\r\n      </nz-resize-handle>\r\n    </section>\r\n    <section class=\"right-resource\">\r\n      <section class=\"search-container\">\r\n        <div class=\"list\">\r\n          <div class=\"list-title\">关键词搜索：</div>\r\n          <div class=\"list-input\">\r\n            <input nz-input placeholder=\"支持标题\"\r\n                   [(ngModel)]=\"condition\" (ngModelChange)='storingData();' (keyup.enter)='resetSearch()'/>\r\n          </div>\r\n        </div>\r\n        <div class=\"list\">\r\n          <div class=\"list-title\" style='margin-left:20px'>学习目标：</div>\r\n          <div class=\"list-input\">\r\n            <nz-select [(ngModel)]=\"learningGoalCode\" (ngModelChange)='storingData();' class=\"list-input\"\r\n                       nzMode=\"multiple\" style='width: 100%;max-width: 300px;'>\r\n              nzShowSearch\r\n              [nzMaxTagPlaceholder]=\"tagPlaceHolder\"\r\n              <nz-option nzValue=\"1\" nzLabel=\"了解\"></nz-option>\r\n              <nz-option nzValue=\"2\" nzLabel=\"理解\"></nz-option>\r\n              <nz-option nzValue=\"3\" nzLabel=\"掌握\"></nz-option>\r\n              <nz-option nzValue=\"4\" nzLabel=\"应用\"></nz-option>\r\n              <nz-option nzValue=\"5\" nzLabel=\"分析\"></nz-option>\r\n              <nz-option nzValue=\"6\" nzLabel=\"创新\"></nz-option>\r\n            </nz-select>\r\n          </div>\r\n        </div>\r\n        <button nz-button nzType=\"primary\" class=\"margin-btn\"\r\n                (click)=\"resetSearch()\">查询\r\n        </button>\r\n        <button nz-button nzType=\"primary\" style='margin-left:20px;' (click)=\"resetData()\">重置</button>\r\n      </section>\r\n      <section class=\"table-container\" id='tableScroll' [class.no-scoll]='!data.length'>\r\n        <nz-table #ajaxTable [nzData]=\"data\" [nzFrontPagination]=\"false\"\r\n                  [nzShowSizeChanger]=\"true\"\r\n                  [nzPageSizeOptions]='[15, 20, 30, 40, 50]'\r\n                  [nzScroll]='{x:\"1260px\",y : height+\"px\"}'\r\n                  [nzShowTotal]=\"totalTemplate\" [nzLoading]=\"isLoading\" [nzTotal]=\"total\"\r\n                  [(nzPageIndex)]=\"pageIndex\"\r\n                  [(nzPageSize)]=\"pageSize\" (nzPageIndexChange)=\"searchData()\"\r\n                  (nzPageSizeChange)=\"searchData()\">\r\n          <thead class=\"source-header\">\r\n          <tr>\r\n            <th nzWidth='220px'>标题</th>\r\n            <th nzWidth='120px'>学习目标</th>\r\n            <th nzWidth='220px'>知识点</th>\r\n            <!--            <th>资源类型</th>-->\r\n            <th nzWidth='120px'>创建者</th>\r\n            <th nzWidth='120px'>作者</th>\r\n            <!--            <th>单位</th>-->\r\n            <th nzWidth='120px'>更新时间</th>\r\n            <th (nzSortOrderChange)='nzSortOtrderChange($event)' [nzShowSort]='true' [nzSortOrder]='order'\r\n                nzWidth='100px'>使用次数\r\n            </th>\r\n            <th nzWidth='120px' nzRight>操作</th>\r\n          </tr>\r\n          </thead>\r\n          <tbody>\r\n          <tr *ngFor=\"let data of ajaxTable.data;let i = index;\">\r\n            <!--            <td><span style=\"color: red;\">{{ data?.newRes ? 'new' : '' }}</span></td>-->\r\n            <td><span class='synopsis-text'>{{ data?.title }}</span></td>\r\n            <td>{{ getName(data?.learningGoalCode, 'LEARNING_TARGET') }}</td>\r\n            <td style='cursor:pointer;' nzTooltipTrigger='click' nz-tooltip [nzTooltipTitle]=\"data?.pointName\"><span\r\n              class='synopsis-text'>{{data?.pointName}}</span></td>\r\n            <!--            <td>{{ getName(data?.type, 'MATERIAL_TYPE') }}</td>-->\r\n            <td>{{ data?.createrName }}</td>\r\n            <td>{{ data?.authorName }}</td>\r\n            <!--            <td>{{ data?.authorUnit }}</td>-->\r\n            <td>{{ getDate(data?.lastModifiedTime)}}</td>\r\n            <td>{{ data?.useTime}}</td>\r\n            <td *ngIf=\"from==''\" nzRight>\r\n              <a (click)=\"copy(data)\">复制 </a>\r\n              <a (click)=\"preview(data)\">预览 </a>\r\n              <a (click)=\"edit(data)\">编辑 </a>\r\n              <a class=\"light-color\" (click)=\"del(data)\" *ngIf='delIF(data)'>删除</a>\r\n            </td>\r\n            <td *ngIf=\"from=='scp'\" nzRight>\r\n              <a (click)=\"preview(data)\">预览 </a>\r\n              <a (click)=\"callResource(data, i)\" *ngIf=\"!data.isCall&&permitedCall\">调用</a>\r\n              <a class=\"light-color\"\r\n                 (click)=\"cancelCallResource(data, i)\"\r\n                 *ngIf=\"data.isCall && !callResourceData.isStandard\"\r\n              >取消调用</a>\r\n              <a *ngIf=\"data.isCall && callResourceData.isStandard\" style=\"color: #999;\">已调用</a>\r\n            </td>\r\n          </tr>\r\n          </tbody>\r\n        </nz-table>\r\n      </section>\r\n      <ng-template #totalTemplate let-total>共 {{ total }} 条记录</ng-template>\r\n    </section>\r\n  </section>\r\n</div>\r\n","import {Component, ElementRef, Inject, LOCALE_ID, ViewChild} from '@angular/core';\r\nimport {NzMessageService} from 'ng-zorro-antd/message';\r\nimport {MenuService} from 'core/services/menu.service';\r\nimport {MaterialLibraryService} from '../../../../busi-services/material-library.service';\r\nimport {getName, STATISTICALRULES} from 'core/base/static-data';\r\nimport {NzModalService, NzTreeNodeOptions} from 'ng-zorro-antd';\r\nimport {CourseManageService} from 'src/app/busi-services/course-manage.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {NzResizeEvent} from 'ng-zorro-antd/resizable/public-api';\r\nimport {SessionStorageUtil} from 'core/utils/sessionstorage.util';\r\nimport {forkJoin, timer} from 'rxjs';\r\nimport {SearchTableComponent} from '../../../course-manage/components';\r\nimport {ConfirmableFlat} from 'core/decorators';\r\nimport {StatisticsLogService} from '@app/busi-services/statistics-log.service';\r\n\r\n@Component({\r\n  selector: 'app-case-lib',\r\n  templateUrl: './case-lib.component.html',\r\n  styleUrls: ['./case-lib.component.less'],\r\n})\r\nexport class CaseLibComponent extends SearchTableComponent {\r\n  _PAGE_ID_ = 'MaterialCaseLibraryComponent';\r\n  id = -1;\r\n  width;\r\n  selectedProfesson: any;\r\n  knowledgePointId = '';\r\n  task;\r\n  conditionObj = {\r\n    category: 100, // 200 习题 100 素材\r\n    knowledgeSubjectId: '', // 学科id\r\n    knowledgeModuleId: '', // 知识模块id\r\n    knowledgeUnitId: '', // 知识单元id\r\n    knowledgePointId: '', // 知识点id\r\n    condition: '', // 模糊查询条件\r\n    coursewareType: ['104'], // 资源类型\r\n    learningGoalCode: [''], // 学习目标\r\n  };\r\n  condition: ''; // 模糊查询条件\r\n  learningGoalCode: any ['']; // 学习目标\r\n  // 调用相关参数\r\n  from: '' | 'scp' = '';\r\n  callResourceData: any = {};\r\n  callResourceId = 'MaterialCallResource';\r\n  selected = '';\r\n  knowledgegraphTree = true;\r\n  changeProfession = true;\r\n  init = false;\r\n  permitedCall = true;\r\n  getName = getName;\r\n  @ViewChild('treeContainer') treeContainer: ElementRef<any>;\r\n  order: string | 'ascend' | 'descend' = null;\r\n\r\n  constructor(\r\n    private menuService: MenuService,\r\n    private modalService: NzModalService,\r\n    public message: NzMessageService,\r\n    public route: ActivatedRoute,\r\n    private materialLibService: MaterialLibraryService,\r\n    public courseMgService: CourseManageService,\r\n    private statisticsLogService: StatisticsLogService,\r\n    @Inject(LOCALE_ID) public locale: string\r\n  ) {\r\n    super();\r\n  }\r\n\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  initData() {\r\n    this.selected = SessionStorageUtil.getCasetree() || SessionStorageUtil.getPacketInfoItem('code');\r\n    const {from, task} = this.route.snapshot.queryParams;\r\n    this.task = task;\r\n    if (from === 'scp') {\r\n      this.from = from;\r\n      this.callResourceData = SessionStorageUtil.getScpResourceMaterial();\r\n    }\r\n  }\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  ngOnAttach() {\r\n    this.selected = SessionStorageUtil.getCasetree() || SessionStorageUtil.getPacketInfoItem('code');\r\n    this.collectParam();\r\n    this.sybcParam();\r\n    this.init = false;\r\n    this.knowledgegraphTree = false;\r\n    this.changeProfession = false;\r\n    timer(0).subscribe(() => {\r\n      this.knowledgegraphTree = true;\r\n      this.changeProfession = true;\r\n    });\r\n  }\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  collectParam() {\r\n    const {condition, learningGoalCode} = SessionStorageUtil.getSearch(this._PAGE_ID_);\r\n    this.condition = condition || '';\r\n    this.learningGoalCode = learningGoalCode || [];\r\n  }\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  sybcParam() {\r\n    this.conditionObj.condition = this.condition;\r\n    this.conditionObj.learningGoalCode = this.learningGoalCode;\r\n  }\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  storingData() {\r\n    const {condition, learningGoalCode} = this;\r\n    this.passData({condition, learningGoalCode});\r\n  }\r\n\r\n\r\n  /*\r\n* @Override\r\n* @*/\r\n  resetInit() {\r\n    this.condition = '';\r\n    this.learningGoalCode = [];\r\n    this.conditionObj.learningGoalCode = [];\r\n    this.conditionObj.condition = '';\r\n  }\r\n\r\n  /*\r\n * @Override\r\n * @*/\r\n  searchData(reset: boolean = false): void {\r\n    if (reset) {\r\n      this.pageIndex = 1;\r\n      this.learningGoalCode = [];\r\n      this.condition = '';\r\n      this.conditionObj.learningGoalCode = [];\r\n      this.conditionObj.condition = '';\r\n      this.removeData();\r\n    }\r\n    this.getDataList();\r\n  }\r\n\r\n  collectSearch() {\r\n    this.collectParam();\r\n    this.sybcParam();\r\n    this.getDataList();\r\n  }\r\n\r\n  resetSearch() {\r\n    this.pageIndex = 1;\r\n    this.conditionObj.condition = this.condition;\r\n    this.conditionObj.learningGoalCode = this.learningGoalCode;\r\n    this.getDataList();\r\n  }\r\n\r\n  getDataList(): void {\r\n    this.conditionObj.condition = this.conditionObj.condition.trim();\r\n    const param: any = {\r\n      ...this.conditionObj,\r\n      page: this.pageIndex,\r\n      limit: this.pageSize,\r\n\r\n    };\r\n    if (this.order) {\r\n      param.sort = this.order === 'ascend' ? 'useTime|asc' : 'useTime|desc';\r\n    }\r\n    const success = (result: any) => {\r\n      this.isLoading = false;\r\n      if (result.status === 200) {\r\n        if (result.data && result.data.records && result.data.records.length) {\r\n          this.data = result.data.records;\r\n          //   .sort((stringA, stringB) => {\r\n          //   if (this.order === 'ascend') {\r\n          //     if (stringB.useTime < stringA.useTime) {\r\n          //       return -1;\r\n          //     }\r\n          //     if (stringB.useTime > stringA.useTime) {\r\n          //       return 1;\r\n          //     }\r\n          //     return 0;\r\n          //   } else if (this.order === 'descend') {\r\n          //     if (stringA.useTime < stringB.useTime) {\r\n          //       return -1;\r\n          //     }\r\n          //     if (stringA.useTime > stringB.useTime) {\r\n          //       return 1;\r\n          //     }\r\n          //     return 0;\r\n          //   } else {\r\n          //     if (stringA.useTime < stringB.useTime) {\r\n          //       return 1;\r\n          //     }\r\n          //     if (stringA.useTime > stringB.useTime) {\r\n          //       return -1;\r\n          //     }\r\n          //     return 0;\r\n          //   }\r\n          // });\r\n          // .map((item, i) => {\r\n          //   if (i === 1) {\r\n          //     item.useTime = 2;\r\n          //   }\r\n          //   return item;\r\n          // });\r\n          this.total = result.data.total;\r\n          if (\r\n            this.from === 'scp' &&\r\n            this.callResourceData.nodes &&\r\n            this.callResourceData.nodes.length > 0\r\n          ) {\r\n            // 调用\r\n            this.data = this.data.map((item) => {\r\n              const hasCallItem = this.callResourceData.nodes.find(\r\n                (it) => it.id === item.id\r\n              );\r\n              if (hasCallItem) {\r\n                item.isCall = true;\r\n                item.taskId = hasCallItem.taskId;\r\n              }\r\n              return item;\r\n            });\r\n            this.setPermitedCall();\r\n          }\r\n        } else {\r\n          this.data = [];\r\n          this.total = 0;\r\n        }\r\n      } else {\r\n        this.data = [];\r\n        this.total = 0;\r\n        this.message.create('error', result.message);\r\n      }\r\n    };\r\n\r\n    const error = (err: any) => {\r\n      this.isLoading = false;\r\n      this.message.create('error', JSON.stringify(err));\r\n    };\r\n\r\n    this.isLoading = true;\r\n\r\n    const work = [this.materialLibService.resConditionQuery(param)];\r\n    forkJoin(work).subscribe(\r\n      (ret) => {\r\n        this.isLoading = false;\r\n        success(ret[0]);\r\n      },\r\n      (err) => {\r\n        this.isLoading = false;\r\n        error(err);\r\n      }\r\n    );\r\n  }\r\n\r\n  onResize({width}: NzResizeEvent): void {\r\n    const flag = this.treeContainer\r\n      && this.treeContainer.nativeElement\r\n      && this.treeContainer.nativeElement.offsetWidth;\r\n    if (\r\n      flag && ((this.treeContainer.nativeElement.offsetWidth + 80 < width))\r\n      ||\r\n      (flag && (this.treeContainer.nativeElement.offsetWidth + 10) > width)\r\n    ) {\r\n      return;\r\n    }\r\n    cancelAnimationFrame(this.id);\r\n    this.id = requestAnimationFrame(() => {\r\n      // tslint:disable-next-line:no-non-null-assertion\r\n      this.width = width!;\r\n    });\r\n  }\r\n\r\n\r\n  setPermitedCall() {\r\n    if (this.callResourceData.hasOwnProperty('limit')) {\r\n      if (Number(this.callResourceData.limit) === 0) {\r\n        this.permitedCall = true;\r\n      } else if (\r\n        this.callResourceData.nodes.length >= this.callResourceData.limit || Number(this.callResourceData.limit) === -1\r\n      ) {\r\n        this.permitedCall = false;\r\n      } else {\r\n        this.permitedCall = true;\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  professionChange(item: any): void {\r\n    SessionStorageUtil.putCasetree(item.code);\r\n    this.selectedProfesson = item;\r\n    this.conditionObj.knowledgeSubjectId = item.id;\r\n    if (!this.init) {\r\n      this.init = true;\r\n      this.collectSearch();\r\n    } else {\r\n      this.pageIndex = 1;\r\n      this.searchData();\r\n    }\r\n  }\r\n\r\n\r\n  nodeChange(nodeOpt: NzTreeNodeOptions) {\r\n    if (nodeOpt.kType === '1') {\r\n      this.conditionObj.knowledgeSubjectId = nodeOpt.id;\r\n      this.conditionObj.knowledgeModuleId = '';\r\n      this.conditionObj.knowledgeUnitId = '';\r\n      this.conditionObj.knowledgePointId = '';\r\n    } else if (nodeOpt.kType === '2') {\r\n      this.conditionObj.knowledgeSubjectId = '';\r\n      this.conditionObj.knowledgeModuleId = nodeOpt.id;\r\n      this.conditionObj.knowledgeUnitId = '';\r\n      this.conditionObj.knowledgePointId = '';\r\n    } else if (nodeOpt.kType === '3') {\r\n      this.conditionObj.knowledgeSubjectId = '';\r\n      this.conditionObj.knowledgeModuleId = '';\r\n      this.conditionObj.knowledgeUnitId = nodeOpt.id;\r\n      this.conditionObj.knowledgePointId = '';\r\n    } else if (nodeOpt.kType === '4') {\r\n      this.conditionObj.knowledgeSubjectId = '';\r\n      this.conditionObj.knowledgeModuleId = '';\r\n      this.conditionObj.knowledgeUnitId = '';\r\n      this.conditionObj.knowledgePointId = nodeOpt.id;\r\n      this.knowledgePointId = nodeOpt.id;\r\n    }\r\n    this.pageIndex = 1;\r\n    this.searchData();\r\n  }\r\n\r\n  goAddCase() {\r\n    if (!this.selectedProfesson) {\r\n      return this.message.error('还没有建立学科哦~');\r\n    }\r\n    const selectedProfessonId = this.selectedProfesson\r\n      ? this.selectedProfesson.id\r\n      : 0;\r\n    this.menuService.gotoUrl({\r\n      url: '/m/rm/material-details',\r\n      paramUrl: `/0/104/${selectedProfessonId}?t=${new Date().getTime()}`,\r\n      title: '新增案例'\r\n    });\r\n  }\r\n\r\n\r\n  edit(data: any) {\r\n    this.menuService.gotoUrl({\r\n      url: '/m/rm/material-details',\r\n      paramUrl: `/${data.id}/${data.type}/${this.selectedProfesson.id}`,\r\n      title: '编辑案例'\r\n    });\r\n  }\r\n\r\n  preview(data: any) {\r\n    const url = '/m/rm/material-pre-case';\r\n    const tabTitle = `预览案例`;\r\n    this.menuService.gotoUrl({\r\n      url,\r\n      paramUrl: `/${data.id}/${data.type}/${this.selectedProfesson.id}`,\r\n      title: tabTitle,\r\n    });\r\n  }\r\n\r\n  @ConfirmableFlat({\r\n      title: '案例复制',\r\n      content: (args) => ('您确定复制' + args[0].title + '案例吗？'),\r\n      type: 'confirm'\r\n    }\r\n  )\r\n  copy(data) {\r\n    return new Promise((resolve) => {\r\n      this.materialLibService.copyResource(data.id).subscribe(\r\n        (result) => {\r\n          if (result.status === 201) {\r\n            this.searchData();\r\n            resolve(true);\r\n          } else {\r\n            if (result.status === 500) {\r\n              this.message.error('服务器业务异常');\r\n            }\r\n            resolve(false);\r\n          }\r\n        },\r\n        (error) => {\r\n          this.message.error(JSON.stringify(error));\r\n          resolve(false);\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  goback() {\r\n    this.menuService.goBack(false);\r\n    this.menuService.gotoUrl({\r\n      title: '课包建设',\r\n      url: `/m/course-manage/prepare-course`,\r\n      paramUrl: ``\r\n    });\r\n  }\r\n\r\n  @ConfirmableFlat({\r\n    title: (args) => (`确定删除\"${args[0].title}\"的案例资源？`),\r\n    content: '',\r\n    type: 'warning'\r\n  })\r\n  del(data: any): Promise<boolean> {\r\n    return new Promise((resolve) => {\r\n      this.materialLibService.delResource(data.id).subscribe(\r\n        (result) => {\r\n          if (result.status === 200) {\r\n            this.searchData();\r\n            resolve(true);\r\n          } else {\r\n            if (result.status === 500) {\r\n              this.message.error('服务器业务异常');\r\n            }\r\n            resolve(false);\r\n          }\r\n        },\r\n        (error) => {\r\n          this.message.error(JSON.stringify(error));\r\n          resolve(false);\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  delIF(data: any) {\r\n    return String(data.useTime) === '0';\r\n  }\r\n\r\n  callResource(data, index) {\r\n    // 调用\r\n    const error = (err) => {\r\n      this.isLoading = false;\r\n      this.message.warning(JSON.stringify(err));\r\n    };\r\n    const params: any = {\r\n      ...this.callResourceData.sectionInfo,\r\n      resourceId: data.id,\r\n      sourceType: 1,\r\n      isGrade: '1'\r\n    };\r\n    const success = (res) => {\r\n      this.isLoading = false;\r\n      if (res.status === 201) {\r\n        const {task} = this;\r\n        let field = '';\r\n        if (task === '1') {\r\n          field = 'learnSet-task-action';\r\n        } else if (task === '101') {\r\n          field = 'learnSet-lecture-action';\r\n        } else if (task === '104') {\r\n          field = 'learnSet-material-action';\r\n        } else {\r\n          field = 'learnSet-record-action';\r\n        }\r\n        this.statisticsLogService.statisticsPacketInfoLog({\r\n          name: '案例库调用',\r\n          actionCode: STATISTICALRULES.packetInfo[field].addCode,\r\n          content: JSON.stringify(params),\r\n        });\r\n        this.data[index].isCall = true;\r\n        this.data[index].taskId = res.data.id;\r\n        this.callResourceData.nodes.push({\r\n          id: this.data[index].id,\r\n          taskId: res.data.id,\r\n        });\r\n        this.callResourceData.seq += 1;\r\n        SessionStorageUtil.putScpResourceMaterial(this.callResourceData);\r\n        this.setPermitedCall();\r\n\r\n      } else {\r\n        if (res.status === 500) {\r\n          this.message.error('服务器业务异常导致调用失败，可能标题太长，请保持35字符以内');\r\n        } else {\r\n          this.message.error(res.message);\r\n        }\r\n      }\r\n    };\r\n    this.isLoading = true;\r\n    if (this.task === '1') {\r\n      params.name = data.title;\r\n      params.taskType = '1';\r\n      params.seq = SessionStorageUtil.getScpResourceMaterial().seq;\r\n      this.courseMgService\r\n        .quickCreate_courseSectionResourceTask(params)\r\n        .subscribe(success, error);\r\n    } else {\r\n      params.title = data.title;\r\n      params.category = data.category;\r\n      params.type = this.task;\r\n      params.seq = SessionStorageUtil.getScpResourceMaterial().seq;\r\n      this.courseMgService\r\n        .quickCreate_courseSectionResource(params)\r\n        .subscribe(success, error);\r\n    }\r\n  }\r\n\r\n  cancelCallResource(data, index) {\r\n    const error = (err) => {\r\n      this.isLoading = false;\r\n      this.message.warning(JSON.stringify(err));\r\n    };\r\n    const success = (res) => {\r\n      this.isLoading = false;\r\n      if (res.status === 204) {\r\n        const {task} = this;\r\n        let field = '';\r\n        if (task === '1') {\r\n          field = 'learnSet-task-action';\r\n        } else if (task === '101') {\r\n          field = 'learnSet-lecture-action';\r\n        } else if (task === '104') {\r\n          field = 'learnSet-material-action';\r\n        } else {\r\n          field = 'learnSet-record-action';\r\n        }\r\n        this.statisticsLogService.statisticsPacketInfoLog({\r\n          name: '案例库取消调用',\r\n          actionCode: STATISTICALRULES.packetInfo[field].delCode,\r\n          content: data.taskId,\r\n        });\r\n        this.data[index].isCall = false;\r\n        this.callResourceData.nodes = this.callResourceData.nodes.filter(\r\n          (item) => item.id !== this.data[index].id\r\n        );\r\n        this.callResourceData.seq -= 1;\r\n        SessionStorageUtil.putScpResourceMaterial(this.callResourceData);\r\n        this.setPermitedCall();\r\n      } else {\r\n        this.message.warning(JSON.stringify(res));\r\n      }\r\n    };\r\n    this.isLoading = true;\r\n    if (this.task === '1') {\r\n      this.courseMgService\r\n        .delInvoke_courseTask(data.taskId)\r\n        .subscribe(success, error);\r\n    } else {\r\n      this.courseMgService\r\n        .delInvoke_course(data.taskId)\r\n        .subscribe(success, error);\r\n    }\r\n  }\r\n\r\n  nzSortOtrderChange($event: string | 'ascend' | 'descend') {\r\n    this.order = $event;\r\n    this.getDataList();\r\n    // let pre = -1;\r\n    // let last = 1;\r\n    // if ($event === 'ascend') {\r\n    //   pre = -1;\r\n    //   last = 1;\r\n    // } else if ($event === 'descend') {\r\n    //   pre = 1;\r\n    //   last = -1;\r\n    // } else {\r\n    //   this.data = this.data.sort((stringB, stringA) => {\r\n    //     if (stringA.lastModifiedTime < stringB.lastModifiedTime) {\r\n    //       return -1;\r\n    //     }\r\n    //     if (stringA.lastModifiedTime > stringB.lastModifiedTime) {\r\n    //       return 1;\r\n    //     }\r\n    //     return 0;\r\n    //   });\r\n    //   return;\r\n    // }\r\n    // this.data = this.data.sort((stringB, stringA) => {\r\n    //   if (stringA.useTime < stringB.useTime) {\r\n    //     return pre;\r\n    //   }\r\n    //   if (stringA.useTime > stringB.useTime) {\r\n    //     return last;\r\n    //   }\r\n    //   return 0;\r\n    // });\r\n  }\r\n}\r\n","<div class=\"container\">\r\n  <section class=\"resource-container\">\r\n    <section class=\"left-tree\"\r\n             nz-resizable\r\n             [style.width.px]=\"width\"\r\n             (nzResize)=\"onResize($event)\">\r\n      <p style='margin-bottom:15px;font-size: 15px;'> 选择知识点(不支持跨学科知识点)</p>\r\n      <div #treeContainer style='display:inline-block;overflow:hidden;margin-right: 30px;'>\r\n        <qkc-tree-knowledgegraph\r\n          model=\"check\"\r\n          [professionId]=\"professionId\"\r\n          [defaultCheckedKeys]=\"defaultTreeKey\"\r\n          (nodeChange)=\"nodeChange($event)\"\r\n          [fullNode]='true'\r\n          [allNodes]='true'\r\n          #treeknowledge>\r\n        </qkc-tree-knowledgegraph>\r\n      </div>\r\n      <nz-resize-handle nzDirection=\"right\">\r\n        <div class=\"right-wrap\">\r\n          <i class=\"right\" nz-icon nzType=\"more\" nzTheme=\"outline\"></i>\r\n        </div>\r\n      </nz-resize-handle>\r\n    </section>\r\n    <section class=\"right-resource\">\r\n      <p class='right-title'>{{title}}</p>\r\n      <form nz-form [formGroup]=\"validateForm\" class=\"case-form\">\r\n        <nz-form-item>\r\n          <nz-form-label [nzSm]=\"3\" [nzXs]=\"24\" nzRequired style=\"text-align: left;max-width:100px;\"\r\n                         nzFor=\"title\">资源标题\r\n          </nz-form-label>\r\n          <nz-form-control [nzSm]=\"21\" [nzXs]=\"24\" [nzErrorTip]=\"titleTpl\">\r\n            <input nz-input formControlName=\"title\"\r\n                   id='title'\r\n                   placeholder=\"请输入标题...\"\r\n                   style=\"width: calc(100% - 80px);\"\r\n                   (keyup.enter)='submitForm()'\r\n                   (keydown)='stopPropagation($event)'\r\n            />\r\n            <span style=\"margin-left: 10px;\">{{validateForm.value.title.length}}/30</span>\r\n            <ng-template #titleTpl let-control>\r\n              <ng-container *ngIf=\"control.hasError('maxlength')\">资源标题不能超过30个字</ng-container>\r\n              <ng-container *ngIf=\"control.hasError('required')\">资源标题不能为空</ng-container>\r\n            </ng-template>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n        <div nz-row>\r\n          <div nz-col nzSpan=\"15\" >\r\n            <nz-form-item>\r\n              <nz-form-label [nzSm]=\"6\" [nzXs]=\"24\" nzRequired style=\"text-align: left; max-width: 100px;\"\r\n                             nzFor=\"title\">作者名称\r\n              </nz-form-label>\r\n              <nz-form-control [nzSm]=\"18\" [nzXs]=\"24\" [nzErrorTip]=\"titleTpl\" nzHasFeedback>\r\n                <input nz-input formControlName=\"authorName\"\r\n                       placeholder=\"请输入作者名称...\"\r\n                       style=\"width: calc(100% - 80px);\" (keyup.enter)='submitForm()'/>\r\n                <span style=\"margin-left: 10px;\">{{validateForm.value.authorName?.length}}/30</span>\r\n                <ng-template #titleTpl let-control>\r\n                  <ng-container *ngIf=\"control.hasError('maxlength')\">作者名称不能超过30个字</ng-container>\r\n                  <ng-container *ngIf=\"control.hasError('required')\">作者名称不能为空</ng-container>\r\n                </ng-template>\r\n              </nz-form-control>\r\n            </nz-form-item>\r\n          </div>\r\n        </div>\r\n        <div nz-row>\r\n          <div nz-col nzSpan=\"12\">\r\n            <nz-form-item>\r\n              <nz-form-label [nzSm]=\"6\" [nzXs]=\"24\" nzRequired style=\"text-align: left;max-width:100px;\"\r\n              >学习目标\r\n              </nz-form-label>\r\n              <nz-form-control [nzSm]=\"18\" [nzXs]=\"24\" nzErrorTip=\"请选择学习目标\">\r\n                <nz-select formControlName=\"learningGoalCode\" nzAllowClear\r\n                           nzPlaceHolder=\"请选择学习目标\">\r\n                  <nz-option *ngFor=\"let opt of learnTargetArr\"\r\n                             [nzValue]=\"opt.id\" [nzLabel]=\"opt.name\"></nz-option>\r\n                </nz-select>\r\n              </nz-form-control>\r\n            </nz-form-item>\r\n          </div>\r\n        </div>\r\n        <nz-form-item>\r\n          <nz-form-label [nzSm]=\"3\" [nzXs]=\"24\" nzRequired style=\"text-align: left;max-width:100px;\">案例背景\r\n          </nz-form-label>\r\n          <nz-form-control [nzSm]=\"21\" [nzXs]=\"24\" nzErrorTip=\"案例背景不能为空\"\r\n                           style='max-width: calc(100% - 150px);position: relative'>\r\n            <nz-spin [nzSpinning]=\"isBackgroundLoading\"  nzTip=\"文件上传中...\"\r\n                     [nzDelay]=\"0\">\r\n              <ckeditor [editor]=\"Editor\" placeholder=\"请输入案例背景内容\"\r\n                        [config]=\"backgroundConfig\" formControlName='background' id='editor0'></ckeditor>\r\n              <span\r\n                style='float:right'\r\n                [style.color]='(getContentLength(validateForm.value.background)<5000)?\"rgb(95, 95, 95)\":\"red\"'>{{getContentLength(validateForm.value.background)}}\r\n                /5000</span>\r\n            </nz-spin>\r\n            <i nz-icon nzType=\"drag\" [ngStyle]='{\"visibility\":dailDown0?\"visible\":\"hidden\"}' nzTheme=\"outline\"\r\n               class='move-handler'\r\n               id='moveHandler0'></i>\r\n          </nz-form-control>\r\n          <i nz-icon nzType=\"login\" id='editor-icon0' nzTheme=\"outline\" class='editor-icon'\r\n             style='vertical-align: top;'\r\n             (click)=\"nailDown(0)\" nz-tooltip nzTooltipTitle=\"钉住拖动\"\r\n             [ngStyle]='{\"visibility\":dailDown0?\"hidden\":\"visible\"}'></i>\r\n          <i nz-icon nzType=\"logout\" id='editor-icon-out0' nzTheme=\"outline\" class='editor-icon'\r\n             style='vertical-align: top;'\r\n             (click)=\"nailDown(0)\" nz-tooltip nzTooltipTitle=\"回到初始位置\"\r\n             [ngStyle]='{\"visibility\":dailDown0?\"visible\":\"hidden\"}'></i>\r\n        </nz-form-item>\r\n        <nz-form-item>\r\n          <nz-form-label [nzSm]=\"3\" [nzXs]=\"24\" style=\"text-align: left;max-width:100px;\">案例附件</nz-form-label>\r\n          <nz-form-control [nzSm]=\"21\" [nzXs]=\"24\"\r\n                           nzErrorTip=\"The input is not valid E-mail!\"\r\n                           nzExtra=\"仅限4个，支持扩展名：pdf 、doc 、docx 、xls 、xlsx 、ppt 、pptx 、png 、jpg 、jpeg 、mp4 、zip 、rar\">\r\n            <qkc-upload\r\n              listType=\"text\"\r\n              acceptType=\"pdf ,doc ,docx ,xls ,xlsx ,ppt ,pptx ,png ,jpg ,jpeg ,mp4 ,zip ,rar\"\r\n              limit=\"4\"\r\n              [multiple]='true'\r\n              (percentReport)='percentReport($event)'\r\n              formControlName=\"caseAttanmentArr\"\r\n            >\r\n              <button nz-button><i nz-icon nzType=\"upload\"></i><span>上传文件</span></button>\r\n            </qkc-upload>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n        <nz-form-item>\r\n          <nz-form-label [nzSm]=\"3\" [nzXs]=\"24\"\r\n                         style=\"text-align: left;max-width:100px;\">案例解析\r\n          </nz-form-label>\r\n          <nz-form-control [nzSm]=\"21\" [nzXs]=\"24\" style='max-width: calc(100% - 150px);position: relative'>\r\n            <nz-spin [nzSpinning]=\"isAnalysisLoading\"  nzTip=\"文件上传中...\"\r\n                     [nzDelay]=\"0\">\r\n              <ckeditor [editor]=\"Editor\" placeholder=\"请输入案例解析\"\r\n                        id='editor1'\r\n                        [config]=\"analysisConfig\" formControlName='analysis'></ckeditor>\r\n              <span\r\n                style='float:right'\r\n                [style.color]='(getContentLength(validateForm.value.analysis)<5000)?\"rgb(95, 95, 95)\":\"red\"'>{{getContentLength(validateForm.value.analysis)}}\r\n                /5000</span>\r\n            </nz-spin>\r\n            <i nz-icon nzType=\"drag\" [ngStyle]='{\"visibility\":dailDown1?\"visible\":\"hidden\"}' nzTheme=\"outline\"\r\n               class='move-handler'\r\n               id='moveHandler1'></i>\r\n          </nz-form-control>\r\n          <i nz-icon nzType=\"login\" id='editor-icon1' nzTheme=\"outline\" class='editor-icon'\r\n             style='vertical-align: top;'\r\n             (click)=\"nailDown(1)\" nz-tooltip nzTooltipTitle=\"钉住拖动\"\r\n             [ngStyle]='{\"visibility\":dailDown1?\"hidden\":\"visible\"}'></i>\r\n          <i nz-icon nzType=\"logout\" id='editor-icon-out1' nzTheme=\"outline\" class='editor-icon'\r\n             style='vertical-align: top;'\r\n             (click)=\"nailDown(1)\" nz-tooltip nzTooltipTitle=\"回到初始位置\"\r\n             [ngStyle]='{\"visibility\":dailDown1?\"visible\":\"hidden\"}'></i>\r\n        </nz-form-item>\r\n        <nz-form-item style='margin-top: 40px;'>\r\n          <nz-form-label [nzSm]=\"3\" [nzXs]=\"24\" style=\"text-align: left;max-width:100px;\">教学指导\r\n          </nz-form-label>\r\n          <nz-form-control [nzSm]=\"21\" [nzXs]=\"24\" style=\"max-width: calc(100% - 150px);position: relative\">\r\n            <nz-spin [nzSpinning]=\"isGuideLoading\"  nzTip=\"文件上传中...\"\r\n                     [nzDelay]=\"0\">\r\n              <ckeditor [editor]=\"Editor\" placeholder=\"请输入教学指导\"\r\n                        id='editor2'\r\n                        [config]=\"guideConfig\" formControlName='guide'></ckeditor>\r\n              <span\r\n                style='float:right'\r\n                [style.color]='(getContentLength(validateForm.value.guide)<5000)?\"rgb(95, 95, 95)\":\"red\"'>{{getContentLength(validateForm.value.guide)}}\r\n                /5000</span>\r\n            </nz-spin>\r\n            <i nz-icon nzType=\"drag\" nzTheme=\"outline\" [ngStyle]='{\"visibility\":dailDown2?\"visible\":\"hidden\"}'\r\n               class='move-handler'\r\n               id='moveHandler2'></i>\r\n          </nz-form-control>\r\n          <i nz-icon nzType=\"login\" id='editor-icon2' nzTheme=\"outline\" class='editor-icon'\r\n             style='vertical-align: top;'\r\n             (click)=\"nailDown(2)\" nz-tooltip nzTooltipTitle=\"钉住拖动\"\r\n             [ngStyle]='{\"visibility\":dailDown2?\"hidden\":\"visible\"}'></i>\r\n          <i nz-icon nzType=\"logout\" id='editor-icon-out2' nzTheme=\"outline\" class='editor-icon'\r\n             style='vertical-align: top;'\r\n             (click)=\"nailDown(2)\" nz-tooltip nzTooltipTitle=\"回到初始位置\"\r\n             [ngStyle]='{\"visibility\":dailDown2?\"visible\":\"hidden\"}'></i>\r\n        </nz-form-item>\r\n      </form>\r\n      <div class=\"submit-footer\">\r\n        <button nz-button nzType=\"default\"\r\n                style=\"margin-right: 20px;\" (click)=\"goBack()\">返回\r\n        </button>\r\n        <button nz-button nzType=\"primary\" (click)=\"submitForm()\" [disabled]='percent===100?null:true' [nzLoading]='saveLoading'>保存</button>\r\n      </div>\r\n    </section>\r\n  </section>\r\n</div>\r\n","import {AfterViewInit, Component, ElementRef, Inject, OnDestroy, OnInit, Renderer2, ViewChild} from '@angular/core';\r\nimport {NzMessageService} from 'ng-zorro-antd/message';\r\nimport {MenuService} from 'core/services/menu.service';\r\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {MaterialLibraryService} from '@app/busi-services/material-library.service';\r\nimport {EDITOR_CONFIG, getName, LEARNING_TARGET} from 'core/base/static-data';\r\nimport {ToolsUtil} from 'core/utils/tools.util';\r\nimport {NzResizeEvent} from 'ng-zorro-antd/resizable';\r\nimport {spaceValidator} from 'src/app/shared/validators/atr-validtors';\r\nimport {NzModalService, NzTreeNode} from 'ng-zorro-antd';\r\nimport {environment} from 'src/environments/environment';\r\nimport {UploadDir} from 'core/utils/uploadDir';\r\nimport ClassicEditor from '@xccjh/xccjh-ckeditor5-video-file-upload';\r\nimport {UploadOssService} from 'core/services/upload-oss.service';\r\nimport {WINDOW} from '@app/service/service.module';\r\nimport {timer} from 'rxjs';\r\nimport {DOCUMENT} from '@angular/common';\r\n\r\n\r\n// 案例\r\n@Component({\r\n  selector: 'app-material-case',\r\n  templateUrl: './material-case.component.html',\r\n  styleUrls: ['./material-case.component.less'],\r\n})\r\nexport class MaterialCaseComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  wid = -1;\r\n  width;\r\n  professionId = '';\r\n  knowledgePointIds: string[] = [];\r\n  title = '';\r\n  id = '';\r\n  coursewareType = '';\r\n  isEdit = false;\r\n  validateForm: FormGroup;\r\n  learnTargetArr = LEARNING_TARGET;\r\n  ktype = 1;\r\n  minType = 5;\r\n  defaultTreeKey = [];\r\n  dailDown0 = false;\r\n  dailDown1 = false;\r\n  dailDown2 = false;\r\n  dailDownMove: any = {\r\n    0: {\r\n      isDown: false,\r\n      leftCha: 0,\r\n      topCha: 0,\r\n      init: false,\r\n    },\r\n    1: {\r\n      isDown: false,\r\n      leftCha: 0,\r\n      topCha: 0,\r\n      init: false,\r\n    },\r\n    2: {\r\n      isDown: false,\r\n      leftCha: 0,\r\n      topCha: 0,\r\n      init: false,\r\n    },\r\n  };\r\n  Editor = ClassicEditor;\r\n  isBackgroundLoading = false;\r\n  isGuideLoading = false;\r\n  isAnalysisLoading = false;\r\n  backgroundConfig = Object.assign({}, EDITOR_CONFIG, this.getImgVideoReosolver('isBackgroundLoading'));\r\n  analysisConfig = Object.assign({}, EDITOR_CONFIG, this.getImgVideoReosolver('isAnalysisLoading'));\r\n  guideConfig = Object.assign({}, EDITOR_CONFIG, this.getImgVideoReosolver('isGuideLoading'));\r\n  current = 0;\r\n  dom: any = {};\r\n  domEdit: any = {};\r\n  domContainer: any = {};\r\n  domIcon: any = {};\r\n  domIconOut: any = {};\r\n  domMoveHandler: any = {};\r\n  percent = 100;\r\n  saveLoading = false;\r\n  orgCode = ToolsUtil.getOrgCode();\r\n  @ViewChild('treeContainer') treeContainer: ElementRef<any>;\r\n  @ViewChild('treeknowledge') treeknowledge;\r\n  @ViewChild('background', {static: true}) background: any;\r\n  @ViewChild('analysis', {static: true}) analysis: any;\r\n  @ViewChild('guide', {static: true}) guide: any;\r\n\r\n\r\n  constructor(\r\n    private message: NzMessageService,\r\n    private materialLibService: MaterialLibraryService,\r\n    private fb: FormBuilder,\r\n    private route: ActivatedRoute,\r\n    private menuService: MenuService,\r\n    private modalService: NzModalService,\r\n    private uploadOssService: UploadOssService,\r\n    private renderer2: Renderer2,\r\n    @Inject(WINDOW) public win: any,\r\n    @Inject(DOCUMENT) private doc: Document\r\n  ) {\r\n    this.win.that = this;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.initParam();\r\n    this.initializeData();\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    timer(1000).subscribe(() => {\r\n      this.win.addEventListener('mousemove', this.nailMove);\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.win.removeEventListener('mousemove', this.nailMove);\r\n    Object.keys(this.domMoveHandler).forEach(ee => {\r\n      this.domMoveHandler[ee].removeEventListener('mousemove', this.startMove);\r\n      this.domMoveHandler[ee].removeEventListener('mouseup', this.endMove);\r\n    });\r\n  }\r\n\r\n  initParam() {\r\n    const routerP = this.route.snapshot.paramMap;\r\n    this.id = routerP.get('id');\r\n    this.coursewareType = routerP.get('type');\r\n    this.professionId = routerP.get('professionId');\r\n  }\r\n\r\n  percentReport(percent) {\r\n    this.percent = percent;\r\n  }\r\n\r\n  initializeData() {\r\n    this.initializeForm({});\r\n    if (this.id === '0') {\r\n      this.isEdit = false;\r\n      this.title = `新增${getName(this.coursewareType, 'MATERIAL_TYPE')}`;\r\n    } else {\r\n      this.isEdit = true;\r\n      this.title = `编辑${getName(this.coursewareType, 'MATERIAL_TYPE')}`;\r\n      this.materialLibService.getResourceDetail(this.id, this.coursewareType).subscribe(result => {\r\n        if (result.status === 200) {\r\n          this.initializeForm(result.data);\r\n        }\r\n      }, error => {\r\n        this.message.warning(JSON.stringify(error));\r\n      });\r\n    }\r\n  }\r\n\r\n  getContentLength(title) {\r\n    return title.replace(/<[^>]+>/g, '').replace(/&nbsp;/g, 'a').replace(/\\s/g, 'a').replace(/[\\u0391-\\uFFE5]/g, 'a').length;\r\n  }\r\n\r\n\r\n  mouseDownLabel() {\r\n    if (!this.dailDownMove[this.current].init) {\r\n      this.dailDownMove[this.current].init = true;\r\n      this.domMoveHandler[this.current].addEventListener('mousedown', this.startMove);\r\n      this.domMoveHandler[this.current].addEventListener('mouseup', this.endMove);\r\n    }\r\n  }\r\n\r\n\r\n  endMove(e) {\r\n    const that = (this as any).that;\r\n    that.dailDownMove[that.current].isDown = false;\r\n  }\r\n\r\n  startMove(e) {\r\n    const that = (this as any).that;\r\n    const domEdit = that.domEdit[that.current] as HTMLDivElement;\r\n    if (!that['dailDown' + that.current]) {\r\n      return;\r\n    }\r\n    const event = e || that.win.event;\r\n    that.dailDownMove[that.current].leftCha =\r\n      event.clientX - domEdit.offsetLeft;\r\n    that.dailDownMove[that.current].topCha =\r\n      event.clientY - domEdit.offsetTop;\r\n    that.dailDownMove[that.current].isDown = true;\r\n  }\r\n\r\n\r\n  nailDown(i: any) {\r\n    this.current = i;\r\n    if (!this.dom[i]) {\r\n      this.dom[i] = this.doc.getElementById('editor' + i);\r\n      this.domEdit[i] = this.dom[i].querySelectorAll(' .ck-editor__top.ck-reset_all')[0] as HTMLDivElement;\r\n      this.domContainer[i] = this.dom[i].querySelectorAll('.ck.ck-editor__main')[0];\r\n      this.domIcon[i] = this.doc.getElementById('editor-icon' + i);\r\n      this.domIconOut[i] = this.doc.getElementById('editor-icon-out' + i);\r\n      this.domMoveHandler[i] = this.doc.getElementById('moveHandler' + i);\r\n      this.domEdit[i].that = this;\r\n      this.domMoveHandler[i].that = this;\r\n    }\r\n    this.mouseDownLabel();\r\n    this['dailDown' + i] = !this['dailDown' + i];\r\n    if (this['dailDown' + i]) {\r\n      this.fixStyles(i);\r\n    } else {\r\n      this.resetStyle(i);\r\n    }\r\n  }\r\n\r\n  fixStyles(i) {\r\n    this.renderer2.setStyle(this.domContainer[i], 'margin-top', this.domEdit[i].offsetHeight + 'px');\r\n    this.renderer2.setStyle(this.domEdit[i], 'border-bottom', '1px solid #ccc');\r\n    this.fixStyle(this.domIcon[i]);\r\n    this.fixStyle(this.domIconOut[i]);\r\n    this.fixStyle(this.domEdit[i]);\r\n    this.fixStyle(this.domMoveHandler[i]);\r\n  }\r\n\r\n  resetStyle(i) {\r\n    const {renderer2} = this;\r\n    renderer2.removeAttribute(this.domContainer[i], 'style');\r\n    renderer2.removeAttribute(this.domIconOut[i], 'style');\r\n    renderer2.removeAttribute(this.domIcon[i], 'style');\r\n    renderer2.removeAttribute(this.domEdit[i], 'style');\r\n    renderer2.removeAttribute(this.domMoveHandler[i], 'style');\r\n  }\r\n\r\n  nailMove(e) {\r\n    const that = (window as any).that;\r\n    const event = e || that.win.event;\r\n    Object.keys(that.dailDownMove).every((ee, ii) => {\r\n      if (that.dailDownMove[ee].isDown) {\r\n        const dom = that.doc.getElementById('editor' + ii);\r\n        const domEdit = dom.querySelectorAll(' .ck-editor__top.ck-reset_all')[0] as HTMLDivElement;\r\n        const domIcon = that.doc.getElementById('editor-icon' + ii);\r\n        const domIconOut = that.doc.getElementById('editor-icon-out' + ii);\r\n        const moveHandler = that.doc.getElementById('moveHandler' + ii);\r\n        [domIcon, domIconOut, domEdit, moveHandler].forEach((domItem, domIndex) => {\r\n          if (domIndex === 2) {\r\n            domItem.style.left =\r\n              event.clientX - that.dailDownMove[ee].leftCha + 'px';\r\n            domItem.style.top =\r\n              event.clientY - that.dailDownMove[ee].topCha + 'px';\r\n          } else if (domIndex === 3) {\r\n            domItem.style.left =\r\n              event.clientX -\r\n              that.dailDownMove[ee].leftCha +\r\n              (domEdit.offsetWidth / 2) -\r\n              (that.domMoveHandler[ee].offsetWidth / 2) +\r\n              'px';\r\n            domItem.style.top =\r\n              event.clientY - that.dailDownMove[ee].topCha - 17 + 'px';\r\n          } else {\r\n            domItem.style.left =\r\n              event.clientX -\r\n              that.dailDownMove[ee].leftCha +\r\n              domEdit.offsetWidth +\r\n              'px';\r\n            domItem.style.top =\r\n              event.clientY - that.dailDownMove[ee].topCha + 'px';\r\n          }\r\n        });\r\n        return;\r\n      } else {\r\n        return true;\r\n      }\r\n    });\r\n  }\r\n\r\n  fixStyle(dom) {\r\n    const width = dom.offsetWidth + 'px';\r\n    const top = dom.getBoundingClientRect().top + 'px';\r\n    const left = dom.getBoundingClientRect().left + 'px';\r\n    const {renderer2} = this;\r\n    renderer2.setStyle(dom, 'position', 'fixed');\r\n    renderer2.setStyle(dom, 'background', 'white');\r\n    renderer2.setStyle(dom, 'z-index', '999');\r\n    renderer2.setStyle(dom, 'width', width);\r\n    renderer2.setStyle(dom, 'top', top);\r\n    renderer2.setStyle(dom, 'left', left);\r\n    renderer2.setStyle(dom, 'transform', 'inherit');\r\n  }\r\n\r\n  getImgVideoReosolver(label) {\r\n    return {\r\n      videoUpload: this.getResolver(label),\r\n      imageUpload: this.getResolver(label)\r\n    };\r\n  }\r\n\r\n  getResolver(label) {\r\n    const that = this;\r\n    return (file) => {\r\n      that[label] = true;\r\n      return new Promise((resolve, reject) => {\r\n        const success = (url) => {\r\n          that[label] = false;\r\n          if (url) {\r\n            resolve({url: environment.OSS_URL + url});\r\n          } else {\r\n            that.message.warning('上传失败');\r\n          }\r\n        };\r\n        const error = (err) => {\r\n          that[label] = false;\r\n          that.message.warning('上传失败');\r\n          reject(err);\r\n        };\r\n        that.uploadOssService\r\n          .uploadOss(file, UploadDir.editor)\r\n          .subscribe(success, error);\r\n      });\r\n    };\r\n  }\r\n\r\n  onResize({width}: NzResizeEvent): void {\r\n    const flag = this.treeContainer\r\n      && this.treeContainer.nativeElement\r\n      && this.treeContainer.nativeElement.offsetWidth;\r\n    if (\r\n      flag && ((this.treeContainer.nativeElement.offsetWidth + 80 < width))\r\n      ||\r\n      (flag && (this.treeContainer.nativeElement.offsetWidth + 10) > width)\r\n    ) {\r\n      return;\r\n    }\r\n    cancelAnimationFrame(this.wid);\r\n    this.wid = requestAnimationFrame(() => {\r\n      // tslint:disable-next-line:no-non-null-assertion\r\n      this.width = width!;\r\n    });\r\n  }\r\n\r\n  initializeForm(data: any) {\r\n    const {coursewareType, isEdit} = this;\r\n    const {id, title, learningGoalCode, background, guide, analysis, attachment, authorName} = data;\r\n    this.validateForm = this.fb.group({\r\n      id: [isEdit ? id : ''],\r\n      points: [[]], // [知识点id]\r\n      type: [coursewareType], // 资源种类\r\n      coursewareType: [coursewareType], // 素材类型\r\n      title: [isEdit ? title : '', [Validators.required, spaceValidator(), Validators.maxLength(30)]], // 资源名称\r\n      learningGoalCode: [isEdit ? learningGoalCode : '', [Validators.required]], // 学习目标\r\n      background: [isEdit ? background : '', [Validators.required]], // 背景\r\n      guide: [isEdit ? guide : ''], // 教学指导\r\n      analysis: [isEdit ? analysis : ''], // 解析\r\n      caseAttanmentArr: [isEdit ? attachment.map(ele => ({\r\n        name: ele.attachmentName,\r\n        path: ele.attachmentPath,\r\n        title: ele.attachmentName\r\n      })) : []],\r\n      authorName: [isEdit ? authorName :\r\n        (this.orgCode === 'zksd' ? '考拉日记' : '恒企教育'), [Validators.required, spaceValidator(), Validators.maxLength(30)]],\r\n    });\r\n    if (isEdit && data.resourcePoints[0].knowledgePointId) {\r\n      this.knowledgePointIds = this.defaultTreeKey = data.resourcePoints.map(({knowledgePointId}) => knowledgePointId);\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    const {background, analysis, guide} = this.validateForm.value;\r\n    // tslint:disable-next-line:forin\r\n    for (const i in this.validateForm.controls) {\r\n      this.validateForm.controls[i].markAsDirty();\r\n      this.validateForm.controls[i].updateValueAndValidity();\r\n    }\r\n    if (this.validateForm.invalid) {\r\n      this.message.warning('请按规则填写所有必填项');\r\n      return;\r\n    }\r\n    if (this.getContentLength(background) > 5000) {\r\n      this.message.warning('案例背景已超出限制');\r\n      return;\r\n    }\r\n    if (this.getContentLength(analysis) > 5000) {\r\n      this.message.warning('案例解析已超出限制');\r\n      return;\r\n    }\r\n    if (this.getContentLength(guide) > 5000) {\r\n      this.message.warning('教学指导内容已超出限制');\r\n      return;\r\n    }\r\n    const postData = JSON.parse(JSON.stringify(this.validateForm.value));\r\n    // 回显和点击树有数据\r\n    if (this.knowledgePointIds.length) {\r\n      postData.pointType = 1;\r\n      postData.points = this.knowledgePointIds.map((ele: string) => ele);\r\n    } else {\r\n      postData.pointType = 2;\r\n      postData.points = [this.treeknowledge.nodes[0].id];\r\n    }\r\n    const caseAttach = postData.caseAttanmentArr.map(ele => ({\r\n      attachmentName: ele.name,\r\n      attachmentPath: ele.path,\r\n      aattachmentExt: ToolsUtil.getExt(ele.path),\r\n      attachmentType: 12\r\n    }));\r\n    postData.attachments = [...caseAttach];\r\n    delete postData.caseAttanmentArr;\r\n    if (this.minType === 5 && this.knowledgePointIds.length === 0) {\r\n      this.modalService.warning({\r\n        nzTitle: `未选择知识点资料将挂到课程，确定吗？`,\r\n        nzCancelText: '取消',\r\n        nzOkText: '确定',\r\n        nzOnOk: () => {\r\n          return this.savaRecourse(postData);\r\n        },\r\n      });\r\n    } else {\r\n      if (postData.pointType === 2) {\r\n        this.modalService.warning({\r\n          nzTitle: `选择的节点未包含知识点，资料将挂到课程，确定吗？`,\r\n          nzCancelText: '取消',\r\n          nzOkText: '确定',\r\n          nzOnOk: () => {\r\n            return this.savaRecourse(postData);\r\n          }\r\n        });\r\n      } else {\r\n        this.savaRecourse(postData);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  savaRecourse(postData): Promise<boolean> {\r\n    return new Promise((resolve) => {\r\n      this.saveLoading = true;\r\n      this.materialLibService.saveCase(postData).subscribe(result => {\r\n        this.saveLoading = false;\r\n        if (result.status === 201) {\r\n          resolve(true);\r\n          this.goBack();\r\n        } else {\r\n          if (result.status === 500) {\r\n            this.message.error('服务器业务异常');\r\n          }\r\n          resolve(false);\r\n        }\r\n      }, err => {\r\n        resolve(false);\r\n        this.saveLoading = false;\r\n        this.message.error(JSON.stringify(err));\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n  nodeChange(nodeOpt: any) {\r\n    this.knowledgePointIds = this.getCheckedLeafKey(nodeOpt);\r\n    const obj = {minType: 5};\r\n    this.getMinLavel(nodeOpt, obj);\r\n    this.minType = obj.minType;\r\n  }\r\n\r\n  getMinLavel(nodeOpt, obj) {\r\n    if (nodeOpt.length) {\r\n      nodeOpt.forEach((e) => {\r\n        if (e.origin && e.origin.children && e.origin.children.length) {\r\n          this.getMinLavel(e.children, obj);\r\n        }\r\n        if (obj.minType > e.origin.kType) {\r\n          obj.minType = e.origin.kType;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  getCheckedLeafKey(arr: any[]): string[] {\r\n    const keys: string[] = [];\r\n    const recurTree = (checkKeyArr: any[]) => {\r\n      // tslint:disable-next-line:prefer-for-of\r\n      for (let i = 0; i < checkKeyArr.length; i++) {\r\n        const node =\r\n          checkKeyArr[i] instanceof NzTreeNode\r\n            ? checkKeyArr[i].origin\r\n            : checkKeyArr[i];\r\n        if (node.children && node.children.length > 0) {\r\n          recurTree(node.children);\r\n        } else {\r\n          if (node.isLeaf && node.checked && (node.kType === '4')) {\r\n            keys.push(node.id);\r\n          }\r\n        }\r\n      }\r\n    };\r\n    recurTree(arr);\r\n    return keys;\r\n  }\r\n\r\n  goBack() {\r\n    this.menuService.goBack(false);\r\n    this.menuService.gotoUrl({\r\n      url: '/m/rm/case',\r\n      paramUrl: '',\r\n      title: '案例库'\r\n    });\r\n  }\r\n\r\n\r\n  stopPropagation(event) {\r\n    if (event.keyCode === 13) {\r\n      event.stopPropagation();\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","<div class=\"container\">\r\n  <section class=\"resource-container\">\r\n    <section class=\"left-tree\"\r\n             nz-resizable\r\n             [style.width.px]=\"width\"\r\n             (nzResize)=\"onResize($event)\">\r\n      <p style='margin-bottom:15px;font-size: 15px;'>选择知识点(不支持跨学科知识点)</p>\r\n      <div #treeContainer style='display:inline-block;overflow:hidden;margin-right: 30px;'>\r\n        <qkc-tree-knowledgegraph\r\n          model=\"check\"\r\n          [professionId]=\"professionId\"\r\n          [defaultCheckedKeys]=\"defaultTreeKey\"\r\n          (nodeChange)=\"nodeChange($event)\"\r\n          [fullNode]='true'\r\n          [allNodes]='true'\r\n          #treeknowledge>\r\n        </qkc-tree-knowledgegraph>\r\n      </div>\r\n      <nz-resize-handle nzDirection=\"right\">\r\n        <div class=\"right-wrap\">\r\n          <i class=\"right\" nz-icon nzType=\"more\" nzTheme=\"outline\"></i>\r\n        </div>\r\n      </nz-resize-handle>\r\n    </section>\r\n    <section class=\"right-resource\">\r\n      <p style='margin-bottom:15px;font-size: 18px;'>{{title}} <i nz-icon  nzType=\"question-circle\" nzTheme=\"outline\" nz-tooltip [nzTooltipTitle]=\"titleTip\" *ngIf='coursewareType===\"101\"' class='font-question' [nzTooltipOverlayStyle]='{\"max-width\": \"800px\"}'></i>\r\n      </p>\r\n      <ng-template #titleTip>\r\n        <div>1、建议优先WPS制作PPT；</div>\r\n        <div>2、尽量少用第三模板；</div>\r\n        <div>3、PPT的文件大小应控制在100M之内</div>\r\n      </ng-template>\r\n      <form class=\"case-form\" nz-form [formGroup]=\"validateForm\">\r\n        <div nz-row *ngIf='isEdit'>\r\n          <div nz-col nzSpan=\"15\">\r\n            <nz-form-item>\r\n              <nz-form-label [nzSm]=\"6\" [nzXs]=\"24\" style=\"text-align: left;\">创建人\r\n              </nz-form-label>\r\n              <nz-form-control [nzSm]=\"18\" [nzXs]=\"24\">\r\n                <input nz-input [(ngModel)]=\"createrName\" [ngModelOptions]=\"{standalone: true}\" [disabled]='true'/>\r\n              </nz-form-control>\r\n            </nz-form-item>\r\n          </div>\r\n        </div>\r\n        <div nz-row>\r\n          <div nz-col nzSpan=\"15\">\r\n            <nz-form-item>\r\n              <nz-form-label [nzSm]=\"6\" [nzXs]=\"24\" nzRequired style=\"text-align: left;\"\r\n                             nzFor=\"learningGoalCode\">学习目标\r\n              </nz-form-label>\r\n              <nz-form-control [nzSm]=\"18\" [nzXs]=\"24\" nzErrorTip=\"请选择学习目标\" nzHasFeedback>\r\n                <nz-select formControlName=\"learningGoalCode\" nzAllowClear\r\n                           nzPlaceHolder=\"请选择学习目标\">\r\n                  <nz-option *ngFor=\"let opt of learnTargetArr\"\r\n                             [nzValue]=\"opt.id\" [nzLabel]=\"opt.name\"></nz-option>\r\n                </nz-select>\r\n              </nz-form-control>\r\n            </nz-form-item>\r\n          </div>\r\n        </div>\r\n        <div nz-row>\r\n          <div nz-col nzSpan=\"15\" *ngIf=\"isEdit\">\r\n            <nz-form-item>\r\n              <nz-form-label [nzSm]=\"6\" [nzXs]=\"24\" nzRequired style=\"text-align: left;\"\r\n                             nzFor=\"title\">资源标题\r\n              </nz-form-label>\r\n              <nz-form-control [nzSm]=\"18\" [nzXs]=\"24\" [nzErrorTip]=\"titleTpl\" nzHasFeedback>\r\n                <input nz-input formControlName=\"title\"\r\n                       placeholder=\"请输入标题...\"\r\n                       style=\"width: calc(100% - 80px);\" (keyup.enter)='submitForm()'/>\r\n                <span style=\"margin-left: 10px;\">{{validateForm.value.title?.length}}/30</span>\r\n                <ng-template #titleTpl let-control>\r\n                  <ng-container *ngIf=\"control.hasError('maxlength')\">资源标题不能超过30个字</ng-container>\r\n                  <ng-container *ngIf=\"control.hasError('required')\">资源标题不能为空</ng-container>\r\n                </ng-template>\r\n              </nz-form-control>\r\n            </nz-form-item>\r\n          </div>\r\n        </div>\r\n        <div nz-row>\r\n          <div nz-col nzSpan=\"15\">\r\n            <nz-form-item nz-row nzSpan=\"15\">\r\n              <nz-form-label [nzSm]=\"6\" [nzXs]=\"24\" nzFor=\"uploadFileArr\" nzRequired style=\"text-align: left;\">添加文件\r\n              </nz-form-label>\r\n              <nz-form-control [nzSm]=\"18\" [nzXs]=\"24\" nzErrorTip=\"请上传文件\">\r\n                <qkc-upload\r\n                  style='width:100%;'\r\n                  [isDrag]=\"true\"\r\n                  [multiple]=\"true\"\r\n                  materialType='other'\r\n                  [maxSize]='coursewareType==\"101\"?100:undefined'\r\n                  [limit]=\"10\"\r\n                  type=\"{{ isEdit? 'other-edit':'other-add' }}\"\r\n                  [acceptType]=\"coursewareType=='103'?'mp4':'png,jpg,jpeg,ppt,pptx,doc,docx,pdf,xls,xlsx,rar,zip'\"\r\n                  formControlName=\"uploadFileArr\">\r\n                  <p class=\"ant-upload-drag-icon\">\r\n                    <i nz-icon nzType=\"inbox\"></i>\r\n                  </p>\r\n                  <p class=\"ant-upload-text\">点击或将文件拖曳到这里上传</p>\r\n                  <p class=\"ant-upload-hint\">\r\n                    支持扩展名: {{coursewareType == '103' ? 'mp4' : 'png、jpg、jpeg、ppt、pptx、doc、docx、pdf、xls、xlsx、rar、zip'}}\r\n                  </p>\r\n                </qkc-upload>\r\n              </nz-form-control>\r\n            </nz-form-item>\r\n          </div>\r\n        </div>\r\n        <div nz-row>\r\n          <div nz-col nzSpan=\"15\" >\r\n            <nz-form-item>\r\n              <nz-form-label [nzSm]=\"6\" [nzXs]=\"24\" nzRequired style=\"text-align: left;\"\r\n                             nzFor=\"title\">作者名称\r\n              </nz-form-label>\r\n              <nz-form-control [nzSm]=\"18\" [nzXs]=\"24\" [nzErrorTip]=\"titleTpl\" nzHasFeedback>\r\n                <input nz-input formControlName=\"authorName\"\r\n                       placeholder=\"请输入作者名称...\"\r\n                       style=\"width: calc(100% - 80px);\" (keyup.enter)='submitForm()'/>\r\n                <span style=\"margin-left: 10px;\">{{validateForm.value.authorName?.length}}/30</span>\r\n                <ng-template #titleTpl let-control>\r\n                  <ng-container *ngIf=\"control.hasError('maxlength')\">作者名称不能超过30个字</ng-container>\r\n                  <ng-container *ngIf=\"control.hasError('required')\">作者名称不能为空</ng-container>\r\n                </ng-template>\r\n              </nz-form-control>\r\n            </nz-form-item>\r\n          </div>\r\n        </div>\r\n        <div nz-row>\r\n          <div nz-col nzSpan=\"15\" >\r\n            <nz-form-item>\r\n              <nz-form-label [nzSm]=\"6\" [nzXs]=\"24\" nzRequired style=\"text-align: left;\"\r\n                             nzFor=\"title\">水印开关\r\n              </nz-form-label>\r\n              <nz-form-control [nzSm]=\"18\" [nzXs]=\"24\" nzHasFeedback>\r\n                <nz-radio-group formControlName=\"isWatermark\">\r\n                  <label nz-radio nzValue=\"1\">开启</label>\r\n                  <label nz-radio nzValue=\"0\">关闭</label>\r\n                </nz-radio-group>\r\n              </nz-form-control>\r\n            </nz-form-item>\r\n          </div>\r\n        </div>\r\n        <div nz-row *ngIf='validateForm.value.isWatermark===\"1\"'>\r\n          <div nz-col nzSpan=\"15\" >\r\n            <nz-form-item>\r\n              <nz-form-label [nzSm]=\"6\" [nzXs]=\"24\" nzRequired style=\"text-align: left;\"\r\n                             nzFor=\"title\">水印文字\r\n              </nz-form-label>\r\n              <nz-form-control [nzSm]=\"18\" [nzXs]=\"24\" [nzErrorTip]=\"titleTpl\" nzHasFeedback>\r\n                <input nz-input formControlName=\"watermarkText\"\r\n                       placeholder=\"请输入水印文字...\"\r\n                       style=\"width: calc(100% - 80px);\" (keyup.enter)='submitForm()'/>\r\n                <span style=\"margin-left: 10px;\">{{validateForm.value.watermarkText?.length}}/30</span>\r\n                <ng-template #titleTpl let-control>\r\n                  <ng-container *ngIf=\"control.hasError('maxlength')\">水印文字不能超过30个字</ng-container>\r\n                  <ng-container *ngIf=\"control.hasError('required')\">水印文字不能为空</ng-container>\r\n                </ng-template>\r\n              </nz-form-control>\r\n            </nz-form-item>\r\n          </div>\r\n        </div>\r\n      </form>\r\n      <div class=\"submit-footer\">\r\n        <button nz-button nzType=\"default\" (click)=\"goBack()\"\r\n                style=\"margin-right: 20px;\">返回\r\n        </button>\r\n        <button nz-button nzType=\"primary\" [nzLoading]=\"isSaveLoading\"\r\n                (click)=\"submitForm()\">保存\r\n        </button>\r\n      </div>\r\n    </section>\r\n  </section>\r\n\r\n</div>\r\n","import {Component, ElementRef, Input, OnInit, ViewChild} from '@angular/core';\r\nimport {NzMessageService} from 'ng-zorro-antd/message';\r\nimport {MenuService} from 'core/services/menu.service';\r\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {MaterialLibraryService} from '@app/busi-services/material-library.service';\r\nimport {getName, LEARNING_TARGET} from 'core/base/static-data';\r\nimport {NzResizeEvent} from 'ng-zorro-antd/resizable';\r\nimport {spaceValidator} from 'src/app/shared/validators/atr-validtors';\r\nimport {NzModalService, NzTreeNode} from 'ng-zorro-antd';\r\nimport {ToolsUtil} from 'core/utils/tools.util';\r\n\r\n//  文献 动画 讲义\r\n@Component({\r\n  selector: 'app-material-other',\r\n  templateUrl: './material-other.component.html',\r\n  styleUrls: ['./material-other.component.less']\r\n})\r\nexport class MaterialOtherComponent implements OnInit {\r\n  wid = -1;\r\n  width;\r\n  professionId = '';\r\n  knowledgePointIds: string[] = [];\r\n  title = '';\r\n  id = '';\r\n  coursewareType = '';\r\n  isEdit = false;\r\n  validateForm: FormGroup;\r\n  learnTargetArr = LEARNING_TARGET;\r\n  isSaveLoading = false;\r\n  defaultTreeKey = [];\r\n  minType = 5;\r\n  createrName = '';\r\n  code = '';\r\n  @ViewChild('treeContainer') treeContainer: ElementRef<any>;\r\n  @Input() type: string;\r\n  @ViewChild('treeknowledge') treeknowledge;\r\n  private orgCode = ToolsUtil.getOrgCode();\r\n\r\n\r\n  constructor(\r\n    private message: NzMessageService,\r\n    private materialLibService: MaterialLibraryService,\r\n    private menuService: MenuService,\r\n    private fb: FormBuilder,\r\n    private route: ActivatedRoute,\r\n    private modalService: NzModalService,\r\n  ) {\r\n  }\r\n\r\n\r\n  ngOnInit(): void {\r\n    this.initParam();\r\n    this.initializeData();\r\n  }\r\n\r\n  initializeData() {\r\n    if (this.id === '0') {\r\n      this.isEdit = false;\r\n      this.title = `新增${getName(this.coursewareType, 'MATERIAL_TYPE')}`;\r\n      this.initializeForm({});\r\n    } else {\r\n      this.isEdit = true;\r\n      this.title = `编辑${getName(this.coursewareType, 'MATERIAL_TYPE')}`;\r\n      this.initializeForm({});\r\n      this.materialLibService.getResourceDetail(this.id, this.coursewareType).subscribe(result => {\r\n        if (result.status === 200) {\r\n          this.createrName = result.data.createrName;\r\n          this.initializeForm(result.data);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  initParam() {\r\n    this.code = this.route.snapshot.queryParams.code;\r\n    const routerP = this.route.snapshot.paramMap;\r\n    this.id = routerP.get('id');\r\n    this.coursewareType = routerP.get('type');\r\n    this.professionId = routerP.get('professionId');\r\n  }\r\n\r\n  onResize({width}: NzResizeEvent): void {\r\n    const flag = this.treeContainer\r\n      && this.treeContainer.nativeElement\r\n      && this.treeContainer.nativeElement.offsetWidth;\r\n    if (\r\n      flag && ((this.treeContainer.nativeElement.offsetWidth + 80 < width))\r\n      ||\r\n      (flag && (this.treeContainer.nativeElement.offsetWidth + 10) > width)\r\n    ) {\r\n      return;\r\n    }\r\n    cancelAnimationFrame(this.wid);\r\n    this.wid = requestAnimationFrame(() => {\r\n      // tslint:disable-next-line:no-non-null-assertion\r\n      this.width = width!;\r\n    });\r\n  }\r\n\r\n  initializeForm(data: any) {\r\n    const {id, learningGoalCode, attachmentName, resourceUrl, title, authorName, watermarkText, isWatermark} = data;\r\n    this.validateForm = this.fb.group({\r\n      id: [this.isEdit ? id : ''],\r\n      points: [[]], // [{pointId:\"知识点id\"},{pointId:\"知识点id\"}]\r\n      title: this.isEdit ? [data.title, [Validators.required, spaceValidator(), Validators.maxLength(30)]] : ['', []], // 资源名称\r\n      type: [this.coursewareType], // 资源种类\r\n      coursewareType: [this.coursewareType], // 素材类型\r\n      learningGoalCode: [this.isEdit ? learningGoalCode : '', [Validators.required]], // 学习目标\r\n      uploadFileArr: [this.isEdit ? [{name: attachmentName, path: resourceUrl, title}] : []],\r\n      authorName: [this.isEdit ? authorName :\r\n        (this.orgCode === 'zksd' ? '考拉日记' : '恒企教育'), [Validators.required, spaceValidator(), Validators.maxLength(30)]],\r\n      watermarkText: [this.isEdit ? watermarkText :\r\n        (this.orgCode === 'zksd' ? '考拉日记' : '恒企教育'), [Validators.required, spaceValidator(), Validators.maxLength(30)]],\r\n      isWatermark: [this.isEdit ? isWatermark : '1', [Validators.required]]\r\n    });\r\n    if (this.isEdit && data.resourcePoints && data.resourcePoints[0] && data.resourcePoints[0].knowledgePointId) {\r\n      this.knowledgePointIds = this.defaultTreeKey = data.resourcePoints.map(({knowledgePointId}) => knowledgePointId);\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    if (this.validateForm.value.isWatermark !== '1') {\r\n      this.validateForm.get('watermarkText').clearValidators();\r\n    } else {\r\n      this.validateForm.get('watermarkText').setValidators([Validators.required, spaceValidator(), Validators.maxLength(30)]);\r\n    }\r\n    // tslint:disable-next-line:forin\r\n    for (const i in this.validateForm.controls) {\r\n      this.validateForm.controls[i].markAsDirty();\r\n      this.validateForm.controls[i].updateValueAndValidity();\r\n    }\r\n    if (this.validateForm.invalid) {\r\n      this.message.warning('请按规则填写完整');\r\n      return;\r\n    }\r\n    const postData = JSON.parse(JSON.stringify(this.validateForm.value));\r\n    postData.type = this.coursewareType;\r\n    postData.coursewareType = this.coursewareType;\r\n    // 回显和点击树有数据\r\n    if (this.knowledgePointIds.length) {\r\n      postData.pointType = 1;\r\n      postData.points = this.knowledgePointIds.map((ele: string) => ele);\r\n    } else {\r\n      postData.pointType = 2;\r\n      postData.points = [this.treeknowledge.nodes[0].id];\r\n    }\r\n    if (postData.uploadFileArr.length === 0) {\r\n      this.message.warning('请上传资源');\r\n      return;\r\n    }\r\n    let isUploadFail = false;\r\n    if (this.isEdit) {\r\n      postData.attachmentInfos = postData.uploadFileArr.map((ele: any) => {\r\n        if (!ele.path) {\r\n          isUploadFail = true;\r\n        }\r\n        return {\r\n          attachmentName: ele.name,\r\n          attachmentPath: ele.path,\r\n          title: postData.title\r\n        };\r\n      });\r\n    } else {\r\n      postData.attachmentInfos = [];\r\n      // tslint:disable-next-line:prefer-for-of\r\n      for (let i = 0; i < postData.uploadFileArr.length; i++) {\r\n        const ele = postData.uploadFileArr[i];\r\n        if (!ele.path) {\r\n          isUploadFail = true;\r\n        }\r\n        postData.attachmentInfos.push({\r\n          attachmentName: ele.name,\r\n          attachmentPath: ele.path,\r\n          title: ele.title\r\n        });\r\n        if (!ele.title) {\r\n          this.message.warning('资源标题不能为空');\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    if (isUploadFail) {\r\n      this.message.warning('请等待资源上传完成');\r\n      return;\r\n    }\r\n    delete postData.uploadFileArr;\r\n\r\n\r\n    if (this.minType === 5 && this.knowledgePointIds.length === 0) {\r\n      this.modalService.warning({\r\n        nzTitle: `未选择知识点资料将挂到课程，确定吗？`,\r\n        nzCancelText: '取消',\r\n        nzOkText: '确定',\r\n        nzOnOk: () => {\r\n          return this.savaRecourse(postData);\r\n        },\r\n      });\r\n    } else {\r\n      if (postData.pointType === 2) {\r\n        this.modalService.warning({\r\n          nzTitle: `选择的节点未包含知识点，资料将挂到课程，确定吗？`,\r\n          nzCancelText: '取消',\r\n          nzOkText: '确定',\r\n          nzOnOk: () => {\r\n            return this.savaRecourse(postData);\r\n          },\r\n        });\r\n      } else {\r\n        this.savaRecourse(postData);\r\n      }\r\n    }\r\n  }\r\n\r\n  savaRecourse(postData) {\r\n    return new Promise((resolve) => {\r\n      this.isSaveLoading = true;\r\n      this.materialLibService.saveCourseware(postData).subscribe(result => {\r\n        this.isSaveLoading = false;\r\n        if (result.status === 201) {\r\n          resolve(true);\r\n          this.goBack();\r\n        } else {\r\n          if (result.status === 500) {\r\n            this.message.error('服务端业务异常');\r\n          }\r\n          resolve(false);\r\n        }\r\n      }, () => {\r\n        resolve(false);\r\n        this.isSaveLoading = false;\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n  nodeChange(nodeOpt: any) {\r\n    this.knowledgePointIds = this.getCheckedLeafKey(nodeOpt);\r\n    const obj = {minType: 5};\r\n    this.getMinLavel(nodeOpt, obj);\r\n    this.minType = obj.minType;\r\n  }\r\n\r\n  getMinLavel(nodeOpt, obj) {\r\n    if (nodeOpt.length) {\r\n      nodeOpt.forEach((e) => {\r\n        if (e.origin && e.origin.children && e.origin.children.length) {\r\n          this.getMinLavel(e.children, obj);\r\n        }\r\n        if (obj.minType > e.origin.kType) {\r\n          obj.minType = e.origin.kType;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  getCheckedLeafKey(arr: any[]): string[] {\r\n    const keys: string[] = [];\r\n    const recurTree = (checkKeyArr: any[]) => {\r\n      // tslint:disable-next-line:prefer-for-of\r\n      for (let i = 0; i < checkKeyArr.length; i++) {\r\n        const node =\r\n          checkKeyArr[i] instanceof NzTreeNode\r\n            ? checkKeyArr[i].origin\r\n            : checkKeyArr[i];\r\n        if (node.children && node.children.length > 0) {\r\n          recurTree(node.children);\r\n        } else {\r\n          if (node.isLeaf && node.checked && (node.kType === '4')) {\r\n            keys.push(node.id);\r\n          }\r\n        }\r\n      }\r\n    };\r\n    recurTree(arr);\r\n    return keys;\r\n  }\r\n\r\n  goBack() {\r\n    this.menuService.goBack(false);\r\n    this.menuService.gotoUrl({\r\n      url: '/m/rm/read',\r\n      paramUrl: '',\r\n      title: '阅读库'\r\n    });\r\n  }\r\n}\r\n","<app-material-case *ngIf=\"type==='104'\"></app-material-case>\r\n<app-material-other *ngIf=\"type!=='104'\" [type]='type'></app-material-other>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\n\r\nimport { MaterialLibraryService } from '../../../../busi-services/material-library.service';\r\n\r\n\r\n@Component({\r\n  selector: 'app-material-lib-details',\r\n  templateUrl: './material-lib-details.component.html',\r\n  styleUrls: ['./material-lib-details.component.less'],\r\n})\r\nexport class MaterialLibDetailsComponent implements OnInit {\r\n\r\n  type = '';\r\n\r\n  constructor(\r\n    private route: ActivatedRoute\r\n  ) {}\r\n\r\n\r\n  ngOnInit(): void {\r\n    this.type = this.route.snapshot.paramMap.get('type');\r\n  }\r\n\r\n\r\n}\r\n","<ul nz-menu nzMode=\"inline\">\r\n  <ng-container *ngFor=\"let item of menus\">\r\n    <li nz-menu-item (click)=\"selectItem(item)\" [nzSelected]=\"defaultSelect==item.id\">\r\n      <span class=\"c_name\">{{ item.name }}</span>\r\n    </li>\r\n  </ng-container>\r\n</ul>\r\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\r\n\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'qkc-menu',\r\n  templateUrl: './qkc-menu.component.html',\r\n  styleUrls: ['./qkc-menu.component.less']\r\n})\r\nexport class QkcMenuComponent implements OnInit {\r\n\r\n  @Input() menus: {name: string, [key: string]: any}[] = [];\r\n  @Input() defaultSelect: string | number;\r\n  @Output() menuChange = new EventEmitter<any>();\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  selectItem(item: {name: string, [key: string]: any}) {\r\n    this.menuChange.emit(item);\r\n  }\r\n\r\n}\r\n","import { Component, OnInit, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'qkc-media-audio',\r\n  templateUrl: './qkc-media-audio.component.html',\r\n  styleUrls: ['./qkc-media-audio.component.less']\r\n})\r\nexport class QkcMediaAudioComponent implements OnInit {\r\n\r\n  @Input() title: string;\r\n  @Input() url: string;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","<vg-player class=\"container\">\r\n  <div class=\"header\">\r\n    <div>\r\n      {{title}}\r\n    </div>\r\n    <div>\r\n      <vg-volume vgFor=\"my-video\"></vg-volume>\r\n        <!-- <vg-mute class=\"item-size\"></vg-mute> -->\r\n    </div>\r\n  </div>\r\n  <vg-controls class=\"body\">\r\n    <vg-play-pause class=\"item-size\"></vg-play-pause>\r\n\r\n    <vg-scrub-bar class=\"item-size\" style=\"margin:0;\">\r\n      <vg-scrub-bar-current-time></vg-scrub-bar-current-time>\r\n      <vg-scrub-bar-buffering-time></vg-scrub-bar-buffering-time>\r\n    </vg-scrub-bar>\r\n\r\n    <div class=\"timer-container\">\r\n      <vg-time-display class=\"item-size\" vgFor=\"my-video\"\r\n        [vgProperty]=\"'current'\"\r\n        [vgFormat]=\"'mm:ss'\"></vg-time-display>\r\n      <div class=\"divider\">/</div>\r\n      <vg-time-display class=\"item-size\" vgFor=\"my-video\" [vgProperty]=\"'total'\"\r\n        [vgFormat]=\"'mm:ss'\"></vg-time-display>\r\n    </div>\r\n  </vg-controls>\r\n\r\n  <audio [vgMedia]=\"media\" #media id=\"my-video\" preload=\"auto\">\r\n    <source\r\n      [src]=\"url\"\r\n      type=\"audio/mp3\">\r\n  </audio>\r\n</vg-player>\r\n","<div class=\"container\" id=\"fullContainer\">\r\n  <nz-spin [nzSpinning]=\"isLoading\" [nzDelay]=\"0\" class=\"full-height\">\r\n    <div class=\"header\">\r\n      <div class=\"header-title\">{{data?.title}}</div>\r\n      <div>\r\n        <button nz-button nzType=\"link\" qkcFullscreen fullId=\"fullContainer\" (fullScreenChange)=\"fullChange($event)\"\r\n                style='float:right;'>\r\n          <i nz-icon [nzType]=\"isFullScreen ? 'fullscreen-exit' : 'fullscreen'\" nzTheme=\"outline\"></i>\r\n        </button>\r\n        <button nz-button (click)='backtolist()' style='float:right;margin-top: 3px;'>返回</button>\r\n      </div>\r\n    </div>\r\n    <nz-divider style='margin: 12px 0 24px;'></nz-divider>\r\n\r\n    <div class=\"body\">\r\n      <div class=\"left\">\r\n        <qkc-menu [menus]=\"typeList\" (menuChange)=\"menuChange($event)\" [ngStyle]=\"{width:'150px'}\"></qkc-menu>\r\n      </div>\r\n\r\n      <div class=\"middle\">\r\n        <div id=\"materialSection1\">\r\n          <h2>案例背景</h2>\r\n          <ckeditor [editor]=\"Editor\" class='edit-content' [disabled]=true\r\n                    [config]=\"config\" [ngModel]='data?.background'></ckeditor>\r\n<!--          <span-->\r\n<!--            style='float:right'>{{getContentLength(data?.background)}}/5000</span>-->\r\n<!--          <div [innerHtml]=\"data?.background | safeHtml\" style='wordBreak:break-all;'></div>-->\r\n        </div>\r\n        <div id=\"materialSection2\">\r\n          <h2>案例解析</h2>\r\n<!--          <div [innerHtml]=\"data?.analysis | safeHtml\" style='wordBreak:break-all;'></div>-->\r\n          <ckeditor [editor]=\"Editor\" class='edit-content' [disabled]=true\r\n                    [config]=\"config\" [ngModel]='data?.analysis'></ckeditor>\r\n        </div>\r\n\r\n        <div id=\"materialSection3\">\r\n          <h2>教学指导</h2>\r\n          <ckeditor [editor]=\"Editor\" class='edit-content' [disabled]=true\r\n                    [config]=\"config\" [ngModel]='data?.guide'></ckeditor>\r\n<!--          <div [innerHtml]=\"data?.guide | safeHtml\" style='wordBreak:break-all;'></div>-->\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"right\">\r\n        <div>\r\n\r\n          <div *ngIf=\"data?.audioInfo\">\r\n            <qkc-media-audio [title]=\"data?.audioInfo?.attachmentName\"\r\n                             [url]=\"data?.audioInfo?.attachmentPath\"></qkc-media-audio>\r\n          </div>\r\n\r\n          <div>\r\n            <nz-divider nzText=\"附件列表\"></nz-divider>\r\n            <ng-container *ngFor=\"let item of data?.caseAttch\">\r\n              <a class=\"attach-block\" (click)=\"previewAttachment(item)\">\r\n                <img *ngIf=\"item?.isPic\" [src]=\"item?.attachmentPath\" alt=\"thumbnail\">\r\n                <img *ngIf=\"!item?.isPic&&item?.thumbnail\" [src]=\"item?.thumbnail\" alt=\"thumbnail\">\r\n                <span>{{ item.attachmentName }}</span>\r\n              </a>\r\n              <!--              <i nz-icon nzType=\"arrow-down\" nzTheme=\"outline\"></i>-->\r\n            </ng-container>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </nz-spin>\r\n</div>\r\n\r\n\r\n<!--<qkc-attachment-show-modal-->\r\n<!--  [(isShow)]=\"isShow\"-->\r\n<!--  [filePreviewName]=\"data?.title\"-->\r\n<!--  [url]=\"curShowItem?.attachmentPath\">-->\r\n<!--</qkc-attachment-show-modal>-->\r\n\r\n\r\n\r\n<app-resource-preview-modal [isPreviewpolyway]='isPreviewpolyway' [previewTitle]='previewTitle'\r\n                            [resourceUrl]='resourceUrl' *ngIf='previewStart'\r\n                            (closePreview)='closePreview()'></app-resource-preview-modal>\r\n","import {Component, Inject, OnInit, Renderer2, ViewChild} from '@angular/core';\r\nimport {MaterialLibraryService} from '../../../../busi-services/material-library.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {environment} from 'src/environments/environment';\r\nimport {MenuService} from 'core/services/menu.service';\r\nimport {QkcScrollService} from 'core/directive';\r\nimport {getFileThumbUrl} from 'core/utils/common';\r\nimport {EDITOR_CONFIG} from 'core/base/static-data';\r\nimport {NzMessageService} from 'ng-zorro-antd';\r\nimport ClassicEditor from '@xccjh/xccjh-ckeditor5-video-file-upload';\r\nimport {UploadOssService} from 'core/services/upload-oss.service';\r\nimport {DOCUMENT} from '@angular/common';\r\n\r\n@Component({\r\n  selector: 'app-material-preview-case',\r\n  templateUrl: './material-preview-case.component.html',\r\n  styleUrls: ['./material-preview-case.component.less'],\r\n\r\n})\r\nexport class MaterialPreviewCaseComponent implements OnInit {\r\n\r\n  data: any = {};\r\n\r\n  id = '';\r\n  type = '';\r\n  professionId = '';\r\n\r\n  activeId = '';\r\n  typeList = [\r\n    {id: '1', name: '案例背景'},\r\n    {id: '2', name: '案例解析'},\r\n    {id: '3', name: '教学指导'}\r\n  ];\r\n\r\n  curShowItem: any;\r\n  isShow = false;\r\n  isLoading = false;\r\n  isFullScreen = false;\r\n  Editor = ClassicEditor;\r\n  config = Object.assign({}, EDITOR_CONFIG);\r\n  resourceUrl: any; // 预览地址\r\n  previewTitle = '';\r\n  isPreviewpolyway = false; // 保利威\r\n  previewStart = false;\r\n\r\n  constructor(\r\n    private materialLibService: MaterialLibraryService,\r\n    private route: ActivatedRoute,\r\n    private menuService: MenuService,\r\n    private scrollService: QkcScrollService,\r\n    private message: NzMessageService,\r\n    private uploadOssService: UploadOssService,\r\n    private renderer2: Renderer2,\r\n    @Inject(DOCUMENT) private doc: Document\r\n  ) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.id = this.route.snapshot.paramMap.get('id');\r\n    this.type = this.route.snapshot.paramMap.get('type');\r\n    this.professionId = this.route.snapshot.paramMap.get('professionId');\r\n    this.getResourceDetail();\r\n  }\r\n\r\n\r\n  getResourceDetail() {\r\n    this.isLoading = true;\r\n    this.materialLibService.getResourceDetail(this.id, this.type).subscribe(result => {\r\n      this.isLoading = false;\r\n      if (result.status === 200) {\r\n        const attchArr: any[] = result.data.attachment;\r\n        const audioInfo = attchArr.find(el => el.aattachmentExt === 'mp3');\r\n        if (audioInfo) {\r\n          audioInfo.attachmentPath = environment.OSS_URL + audioInfo.attachmentPath;\r\n        }\r\n        const caseAttch = attchArr.filter(el => el.aattachmentExt !== 'mp3').map(el => {\r\n          const isPic = this.isPicture(el.aattachmentExt);\r\n          const isVideo = this.isVideo(el.aattachmentExt);\r\n          const originAttachmentPath = el.attachmentPath;\r\n          const path = environment.OSS_URL + el.attachmentPath;\r\n          const attachmentPath = (isPic || isVideo) ? path : environment.ow365 + path;\r\n          const thumbnail = getFileThumbUrl(el.aattachmentExt);\r\n          return {...el, attachmentPath, isPic, isVideo, thumbnail, originAttachmentPath};\r\n        });\r\n        result.data.audioInfo = audioInfo;\r\n        result.data.caseAttch = caseAttch;\r\n        this.data = result.data;\r\n      }\r\n    }, error => {\r\n      this.isLoading = false;\r\n    });\r\n  }\r\n\r\n\r\n  closePreview() {\r\n    this.isPreviewpolyway = false;\r\n    this.resourceUrl = '';\r\n    this.previewTitle = '';\r\n    this.previewStart = false;\r\n  }\r\n\r\n  getContentLength(title) {\r\n    return title.replace(/<[^>]+>/g, '').replace(/&nbsp;/g, 'a').replace(/\\s/g, 'a').replace(/[\\u0391-\\uFFE5]/g, 'a').length;\r\n  }\r\n\r\n\r\n  isPicture(ext: string) {\r\n    const picExt = 'jpg,jpeg,png';\r\n    return picExt.indexOf(ext) > -1;\r\n  }\r\n\r\n  isVideo(ext: string) {\r\n    return /mp4|m2v|mkv|rmvb|wmv|avi|flv|mov/.test(ext);\r\n  }\r\n\r\n  fullChange(isFullScreen: boolean) {\r\n    this.isFullScreen = isFullScreen;\r\n  }\r\n\r\n  edit() {\r\n    this.menuService.gotoUrl({\r\n      url: '/m/sel/material-details',\r\n      paramUrl: `/${this.id}/${this.type}/${this.professionId}`\r\n    });\r\n  }\r\n\r\n  previewAttachment(data: any) {\r\n    if (data.sourceType === '2') {\r\n      this.resourceUrl = data.originAttachmentPath;\r\n      this.previewTitle = '';\r\n      this.isPreviewpolyway = true;\r\n      this.previewStart = true;\r\n    } else {\r\n      this.isPreviewpolyway = false;\r\n      this.resourceUrl = data.originAttachmentPath;\r\n      this.previewTitle = data.attachmentName;\r\n      this.previewStart = true;\r\n    }\r\n    // this.curShowItem = item;\r\n    // this.isShow = true;\r\n  }\r\n\r\n  menuChange({id}) {\r\n    this.scrollService.scrollToAnchor(`materialSection${id}`);\r\n  }\r\n\r\n  backtolist() {\r\n    this.menuService.goBack();\r\n  }\r\n\r\n\r\n  downloadAttachments() {\r\n    window.open();\r\n  }\r\n}\r\n","<div class=\"container\" id=\"fullContainer\">\r\n    <div class=\"header\">\r\n        <div style=\"font-size: 18px;\">{{data?.title}}</div>\r\n      <button nz-button (click)='backtolist()' style='float:right;'>返回</button>\r\n\r\n    </div>\r\n\r\n    <div class=\"body\">\r\n        <ng-container *ngIf=\"isShow\">\r\n            <iframe\r\n                allowfullscreen='true'\r\n                [src]=\"data?.resourceUrl\"\r\n                style=\"width: 100%;height:100%;border: none;min-height: 680px;\">\r\n            </iframe>\r\n        </ng-container>\r\n    </div>\r\n</div>\r\n\r\n","import {Component, OnInit} from '@angular/core';\r\nimport {DomSanitizer} from '@angular/platform-browser';\r\nimport {MaterialLibraryService} from '../../../../busi-services/material-library.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {environment} from 'src/environments/environment';\r\nimport {MenuService} from '../../../../../../core/services/menu.service';\r\n\r\n@Component({\r\n  selector: 'app-material-preview-other',\r\n  templateUrl: './material-preview-other.component.html',\r\n  styleUrls: ['./material-preview-other.component.less'],\r\n})\r\nexport class MaterialPreviewOtherComponent implements OnInit {\r\n\r\n  data: any = {};\r\n\r\n  id = '';\r\n  type = '';\r\n  professionId = '';\r\n\r\n  isShow = false;\r\n\r\n  constructor(\r\n    private materialLibService: MaterialLibraryService,\r\n    private route: ActivatedRoute,\r\n    private sanitizer: DomSanitizer,\r\n    private menuService: MenuService,\r\n  ) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.id = this.route.snapshot.paramMap.get('id');\r\n    this.type = this.route.snapshot.paramMap.get('type');\r\n    this.professionId = this.route.snapshot.paramMap.get('professionId');\r\n\r\n    this.materialLibService.getResourceDetail(this.id, this.type).subscribe(result => {\r\n      if (result.status === 200) {\r\n        const url = environment.ow365 + environment.OSS_URL + result.data.resourceUrl;\r\n        result.data.resourceUrl = this.sanitizer.bypassSecurityTrustResourceUrl(url);\r\n        this.data = result.data;\r\n        setTimeout(() => {\r\n          this.isShow = true;\r\n        }, 200);\r\n      }\r\n    }, error => {\r\n\r\n    });\r\n  }\r\n\r\n  backtolist() {\r\n    this.menuService.goBack();\r\n  }\r\n\r\n}\r\n","<div class=\"container\">\r\n\r\n  <section class=\"header\">\r\n    <div class=\"title\">\r\n      <span style=\"max-width: 400px;\">{{ selectedProfesson?.name }}</span>\r\n      <qkc-change-profession (professionChange)=\"professionChange($event)\" *ngIf='changeProfession'\r\n                             [select]='selected' [hidden]='from===\"scp\"'></qkc-change-profession>\r\n    </div>\r\n    <div>\r\n      <button nz-button nzType=\"primary\" class=\"margin-btn\" (click)=\"goback()\" *ngIf=\"from==='scp'\">完成调用</button>\r\n      <button nz-button nzType=\"primary\" class=\"margin-btn\" (click)=\"goAddPage()\" *ngIf=\"from===''\">新增实训</button>\r\n    </div>\r\n  </section>\r\n\r\n  <section class=\"resource-container\" nz-row>\r\n\r\n    <section class=\"left-tree\"\r\n             nz-resizable\r\n             [style.width.px]=\"width\"\r\n             (nzResize)=\"onResize($event)\">\r\n      <div #treeContainer style='display:inline-block;overflow:hidden;margin-right: 30px;'>\r\n      <qkc-tree-knowledgegraph\r\n        [fullNode]='true'\r\n        [allNodes]='true'\r\n        *ngIf='knowledgegraphTree'\r\n        model=\"custom\"\r\n        [practice]='true'\r\n        [selectedProfesson]='selectedProfesson'\r\n        [professionId]=\"selectedProfesson?.id\"\r\n        (nodeChange)=\"nodeChange($event)\" #tree>\r\n      </qkc-tree-knowledgegraph>\r\n      </div>\r\n\r\n      <nz-resize-handle nzDirection=\"right\">\r\n        <div class=\"right-wrap\">\r\n          <i class=\"right\" nz-icon nzType=\"more\" nzTheme=\"outline\"></i>\r\n        </div>\r\n      </nz-resize-handle>\r\n    </section>\r\n    <section class=\"right-resource\">\r\n      <section class=\"search-container\">\r\n        <div class=\"list\">\r\n          <div class=\"list-title\">关键词搜索：</div>\r\n          <div class=\"list-input\">\r\n            <input nz-input placeholder=\"支持实训标题/账期ID\"\r\n                   [(ngModel)]=\"keyword\" (keyup.enter)='searchData(\"button\")' (ngModelChange)='storingData()'/>\r\n          </div>\r\n          <div class=\"list-title\" style='margin-left:20px'>学习目标：</div>\r\n          <div class=\"list-input\">\r\n            <nz-select [(ngModel)]=\"learningGoalCodes\" nzMode=\"multiple\" nzAllowClear nzShowSearch (ngModelChange)='storingData()'\r\n                       style='min-width:150px;'>\r\n              <nz-option [nzValue]=\"1\" nzLabel=\"了解\"></nz-option>\r\n              <nz-option [nzValue]=\"2\" nzLabel=\"理解\"></nz-option>\r\n              <nz-option [nzValue]=\"3\" nzLabel=\"掌握\"></nz-option>\r\n              <nz-option [nzValue]=\"4\" nzLabel=\"应用\"></nz-option>\r\n              <nz-option [nzValue]=\"5\" nzLabel=\"分析\"></nz-option>\r\n              <nz-option [nzValue]=\"6\" nzLabel=\"创新\"></nz-option>\r\n            </nz-select>\r\n          </div>\r\n          <button nz-button nzType=\"primary\" class=\"margin-btn\"\r\n                  (click)=\"searchData('button')\">查询\r\n          </button>\r\n          <button nz-button nzType=\"primary\" style='margin-left:20px;' (click)=\"resetData()\">重置</button>\r\n\r\n        </div>\r\n      </section>\r\n      <section class=\"table-container\" id='tableScroll' [class.no-scoll]='!data.length'>\r\n        <nz-table #ajaxTable [nzData]=\"data\" [nzFrontPagination]=\"false\"\r\n                  [nzShowSizeChanger]=\"true\"\r\n                  [nzPageSizeOptions]='[15, 20, 30, 40, 50]'\r\n                  [nzShowTotal]=\"totalTemplate\" [nzLoading]=\"isLoading\" [nzTotal]=\"total\"\r\n                  [(nzPageIndex)]=\"pageIndex\"\r\n                  [(nzPageSize)]=\"pageSize\" (nzPageIndexChange)=\"searchData()\"\r\n                  [nzScroll]='{x:\"905px\",y : height+\"px\"}'\r\n                  (nzPageSizeChange)=\"searchData()\">\r\n          <thead class=\"source-header\">\r\n          <tr>\r\n            <th nzWidth='220px'>实训标题</th>\r\n            <th nzWidth='120px'>学习目标</th>\r\n            <th nzWidth='200px'>实习系统</th>\r\n            <th nzWidth='200px'>账期ID</th>\r\n            <!--            <th nzWidth='90px'>公司</th>-->\r\n            <!--            <th nzWidth='90px'>作者</th>-->\r\n            <!--            <th nzWidth='90px'>更新时间</th>-->\r\n            <th nzWidth='140px' nzRight>操作</th>\r\n          </tr>\r\n          </thead>\r\n          <tbody>\r\n          <tr *ngFor=\"let data of ajaxTable.data;let i = index;\">\r\n            <td><span class='synopsis-text'>{{ data?.title }}</span></td>\r\n            <td>{{ learningCode[data?.learningGoalCode] }}</td>\r\n            <td>恒企实习系统</td>\r\n            <td>{{ data?.accountId }}</td>\r\n            <!--            <td>{{data?.companyName}}</td>-->\r\n            <!--            <td>{{ data?.authorName }}</td>-->\r\n            <!--            <td>{{ data?.lastModifiedTime | date:'yyyy-MM-dd HH:mm:ss':'GMT+08:00' }}</td>-->\r\n            <td nzRight>\r\n              <a (click)=\"preview(data)\">查看详情 </a>\r\n              <a (click)=\"edit(data)\" *ngIf=\"!from\">编辑 </a>\r\n              <a class=\"light-color\" (click)=\"del(data)\" *ngIf=\"!from\">删除</a>\r\n              <a (click)=\"callResource(data, i)\" *ngIf=\"from=='scp'&&!data.isCall&&permitedCall\">调用</a>\r\n              <a class=\"light-color\"\r\n                 *ngIf=\"from=='scp'&&data.isCall && !callResourceData.isStandard\"\r\n                 (click)=\"cancelCallResource(data, i)\">\r\n                取消调用\r\n              </a>\r\n              <a *ngIf=\"data.isCall && callResourceData.isStandard\" style=\"color: #999;\">已调用</a>\r\n            </td>\r\n          </tr>\r\n          </tbody>\r\n        </nz-table>\r\n      </section>\r\n\r\n      <ng-template #totalTemplate let-total>共 {{ total }} 条记录</ng-template>\r\n    </section>\r\n  </section>\r\n</div>\r\n","import {Component, ElementRef, ViewChild} from '@angular/core';\r\nimport {NzMessageService} from 'ng-zorro-antd/message';\r\nimport {NzModalService} from 'ng-zorro-antd/modal';\r\nimport {MenuService} from 'core/services/menu.service';\r\nimport {NzTreeNodeOptions} from 'ng-zorro-antd';\r\nimport {TrainManageService} from 'src/app/busi-services/train-manage.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {LEARNING_TARGET, STATISTICALRULES} from 'core/base/static-data';\r\nimport {CourseManageService} from 'src/app/busi-services/course-manage.service';\r\nimport {MaterialLibraryService} from 'src/app/busi-services/material-library.service';\r\nimport {SessionStorageUtil} from 'core/utils/sessionstorage.util';\r\nimport {NzResizeEvent} from 'ng-zorro-antd/resizable';\r\nimport {forkJoin, timer} from 'rxjs';\r\nimport {SearchTableComponent} from '../../course-manage/components';\r\nimport {StatisticsLogService} from '@app/busi-services/statistics-log.service';\r\n\r\n@Component({\r\n  selector: 'app-train-course-library',\r\n  templateUrl: './train-library-course.component.html',\r\n  styleUrls: ['./train-library-course.component.less'],\r\n})\r\nexport class TrainLibraryCourseComponent extends SearchTableComponent {\r\n  _PAGE_ID_ = 'TrainLibraryCourseComponent';\r\n  task;\r\n  id = -1;\r\n  width;\r\n  selectedProfesson: any = {};\r\n  knowledgePointId = '';\r\n  curSelectedItem: any;\r\n  conditionObj = {\r\n    industryId: '', // 行业ID\r\n    keyword: '', // 模糊查询条件\r\n    learningGoalCodes: [], // 学习目标\r\n    knowledgeSubjectId: ''\r\n  };\r\n  keyword: '';\r\n  learningGoalCodes: [];\r\n  selected = '';\r\n  from: '' | 'scp' = '';\r\n  callResourceData: any = {};\r\n  callResourceId = 'MaterialCallResource';\r\n  learningCode: any = {};\r\n  changeProfession = true;\r\n  knowledgegraphTree = true;\r\n  permitedCall = true;\r\n  private init = false;\r\n  private loading = false;\r\n  private title: any;\r\n  private status: any;\r\n  @ViewChild('treeContainer') treeContainer: ElementRef<any>;\r\n\r\n\r\n  constructor(\r\n    private trainManageService: TrainManageService,\r\n    private materialLibService: MaterialLibraryService,\r\n    private menuService: MenuService,\r\n    private modalService: NzModalService,\r\n    public message: NzMessageService,\r\n    public route: ActivatedRoute,\r\n    public courseMgService: CourseManageService,\r\n    private statisticsLogService: StatisticsLogService,\r\n  ) {\r\n    super();\r\n  }\r\n\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  initData() {\r\n    this.selected = SessionStorageUtil.getTrainTree() || SessionStorageUtil.getPacketInfoItem('code');\r\n    // 调用相关\r\n    const {from, task} = this.route.snapshot.queryParams;\r\n    this.task = task;\r\n    if (from === 'scp') {\r\n      this.from = from;\r\n      this.callResourceData = SessionStorageUtil.getScpResourceMaterial();\r\n    }\r\n\r\n    LEARNING_TARGET.map((item) => {\r\n      this.learningCode[item.id] = item.name;\r\n    });\r\n  }\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  ngOnAttach() {\r\n    this.selected = SessionStorageUtil.getTrainTree() || SessionStorageUtil.getPacketInfoItem('code');\r\n    this.collectParam();\r\n    this.sybcParam();\r\n    this.init = false;\r\n    this.changeProfession = false;\r\n    timer(0).subscribe(() => {\r\n      this.changeProfession = true;\r\n    });\r\n  }\r\n\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  collectParam() {\r\n    const {keyword, learningGoalCodes} = SessionStorageUtil.getSearch(this._PAGE_ID_);\r\n    this.keyword = keyword || '';\r\n    this.learningGoalCodes = learningGoalCodes || [];\r\n  }\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  sybcParam() {\r\n    this.conditionObj.keyword = this.keyword;\r\n    this.conditionObj.learningGoalCodes = this.learningGoalCodes;\r\n  }\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  storingData() {\r\n    const {keyword, learningGoalCodes} = this;\r\n    this.passData({keyword, learningGoalCodes});\r\n  }\r\n\r\n  /*\r\n  * @Override\r\n  * @*/\r\n  resetInit() {\r\n    this.keyword = '';\r\n    this.learningGoalCodes = [];\r\n    this.conditionObj.learningGoalCodes = [];\r\n    this.conditionObj.keyword = '';\r\n  }\r\n\r\n\r\n  /*\r\n   * @Override\r\n   * @*/\r\n  getDataList(): void {\r\n    this.conditionObj.keyword = this.conditionObj.keyword.trim();\r\n    const param = {\r\n      ...this.conditionObj,\r\n      page: this.pageIndex,\r\n      limit: this.pageSize,\r\n    };\r\n    const success = (result: any) => {\r\n      if (result.status === 200) {\r\n        this.data = result.data;\r\n        this.total = result.page.totalResult;\r\n        if (\r\n          this.from === 'scp' &&\r\n          this.callResourceData.nodes &&\r\n          this.callResourceData.nodes.length > 0\r\n        ) {\r\n          // 调用\r\n          this.data = this.data.map((item) => {\r\n            const hasCallItem = this.callResourceData.nodes.find(\r\n              (it) => it.id === item.id\r\n            );\r\n            if (hasCallItem) {\r\n              item.isCall = true;\r\n              item.taskId = hasCallItem.taskId;\r\n            }\r\n            return item;\r\n          });\r\n          this.setPermitedCall();\r\n\r\n        }\r\n      } else {\r\n        this.data = [];\r\n        this.total = 0;\r\n        this.message.create('error', JSON.stringify(result));\r\n      }\r\n    };\r\n\r\n    const error = (err: any) => {\r\n      this.isLoading = false;\r\n      this.message.create('error', JSON.stringify(err));\r\n    };\r\n\r\n    this.isLoading = true;\r\n\r\n    const work = [this.trainManageService.queryPracticalPage(param)];\r\n    forkJoin(work).subscribe(\r\n      (ret) => {\r\n        this.isLoading = false;\r\n        success(ret[0]);\r\n      },\r\n      (err) => {\r\n        this.isLoading = false;\r\n        error(err);\r\n      }\r\n    );\r\n  }\r\n\r\n\r\n  onResize({width, height}: NzResizeEvent): void {\r\n    const flag = this.treeContainer\r\n      && this.treeContainer.nativeElement\r\n      && this.treeContainer.nativeElement.offsetWidth;\r\n    if (\r\n      flag && ((this.treeContainer.nativeElement.offsetWidth + 80 < width))\r\n      ||\r\n      (flag && (this.treeContainer.nativeElement.offsetWidth + 10) > width)\r\n    ) {\r\n      return;\r\n    }\r\n    cancelAnimationFrame(this.id);\r\n    this.id = requestAnimationFrame(() => {\r\n      // tslint:disable-next-line:no-non-null-assertion\r\n      this.width = width!;\r\n    });\r\n  }\r\n\r\n\r\n  setPermitedCall() {\r\n    if (this.callResourceData.hasOwnProperty('limit')) {\r\n      if (Number(this.callResourceData.limit) === 0) {\r\n        this.permitedCall = true;\r\n      } else if (\r\n        this.callResourceData.nodes.length >= this.callResourceData.limit || Number(this.callResourceData.limit) === -1\r\n      ) {\r\n        this.permitedCall = false;\r\n      } else {\r\n        this.permitedCall = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  professionChange(item: any): void {\r\n    SessionStorageUtil.putTrainTree(item.code);\r\n    this.selectedProfesson = item;\r\n    this.conditionObj.knowledgeSubjectId = item.id;\r\n    this.conditionObj.industryId = '';\r\n    if (!this.init) {\r\n      this.init = true;\r\n      this.searchData('collect');\r\n    } else {\r\n      this.pageIndex = 1;\r\n      this.searchData();\r\n    }\r\n  }\r\n\r\n  nodeChange(nodeOpt: NzTreeNodeOptions) {\r\n    if (nodeOpt.parentNode) {\r\n      this.conditionObj.industryId = nodeOpt.key;\r\n      this.conditionObj.knowledgeSubjectId = '';\r\n    } else {\r\n      this.conditionObj.knowledgeSubjectId = nodeOpt.key;\r\n      this.conditionObj.industryId = '';\r\n    }\r\n    this.pageIndex = 1;\r\n    this.searchData();\r\n  }\r\n\r\n  edit(data: any) {\r\n    this.menuService.gotoUrl({\r\n      url: '/m/rm/save-train',\r\n      title: '编辑实训',\r\n      paramUrl: `/edit/${data.id}/${this.selectedProfesson.id}?select=0`,\r\n    });\r\n  }\r\n\r\n  goAddPage() {\r\n    this.menuService.gotoUrl({\r\n      url: '/m/rm/save-train',\r\n      title: '新增实训',\r\n      paramUrl:\r\n        '/add/0/' +\r\n        this.selectedProfesson.id +\r\n        '?select=' +\r\n        this.conditionObj.industryId +\r\n        '&t=' +\r\n        new Date().getTime(),\r\n    });\r\n  }\r\n\r\n  preview(data: any) {\r\n    if (data.url) {\r\n      return this.goPage(data.url);\r\n    }\r\n    const params = {\r\n      id: data.id,\r\n      accountId: data.accountId,\r\n    };\r\n    this.loading = true;\r\n    const success = (res: any) => {\r\n      this.loading = false;\r\n      if (res.status === 200) {\r\n        if (res.data) {\r\n          data.url = res.data;\r\n          this.goPage(res.data);\r\n        }\r\n      }\r\n    };\r\n\r\n    const error = (err: any) => {\r\n      this.loading = false;\r\n      this.message.create('error', JSON.stringify(err));\r\n    };\r\n    this.trainManageService.getPracticalDetail(params).subscribe(success, error);\r\n  }\r\n\r\n  goPage(url) {\r\n    open(url);\r\n  }\r\n\r\n  goback() {\r\n    this.menuService.goBack();\r\n    timer(0).subscribe(() => {\r\n      this.menuService.gotoUrl({\r\n        title: '课包建设',\r\n        url: `/m/course-manage/prepare-course`,\r\n        paramUrl: ``\r\n      });\r\n    });\r\n  }\r\n\r\n  del(data: any) {\r\n    this.curSelectedItem = data;\r\n    this.materialLibService.preDelCheck(this.curSelectedItem.id).subscribe(resPre => {\r\n      if (resPre.status === 200) {\r\n        let text;\r\n        if (resPre.data === '1') {\r\n          text = '该账期正在被使用，删除后课包中的实训任务将同步删除，确定删除吗？';\r\n        } else {\r\n          text = '确定删除该账期吗？';\r\n        }\r\n        this.modalService.error({\r\n          nzTitle: '删除',\r\n          nzContent: text,\r\n          nzCancelText: '取消',\r\n          nzOnOk: () => {\r\n            return new Promise((resolve) => {\r\n              this.materialLibService.delResource(this.curSelectedItem.id).subscribe(\r\n                (result) => {\r\n                  if (result.status === 200) {\r\n                    resolve(true);\r\n                    this.searchData();\r\n                  } else {\r\n                    if (result.status === 500) {\r\n                      this.message.error('服务端业务异常');\r\n                    }\r\n                    resolve(false);\r\n                  }\r\n                },\r\n                (error) => {\r\n                  resolve(false);\r\n                  this.message.error(JSON.stringify(error));\r\n                }\r\n              );\r\n            });\r\n          },\r\n        });\r\n      } else if (resPre.status === 500) {\r\n        this.message.warning('检查账期任务调用情况服务端出错，请稍后再试');\r\n      }\r\n    });\r\n  }\r\n\r\n  callResource(data, index) {\r\n    // 调用\r\n    const error = (err) => {\r\n      this.isLoading = false;\r\n      this.message.warning(JSON.stringify(err));\r\n    };\r\n    const params: any = {\r\n      ...this.callResourceData.sectionInfo,\r\n      resourceId: data.id,\r\n      sourceType: 1,\r\n    };\r\n    const success = (res) => {\r\n      this.isLoading = false;\r\n      if (res.status === 201) {\r\n        const {task} = this;\r\n        let field = '';\r\n        if (task === '1') {\r\n          field = 'learnSet-task-action';\r\n        } else if (task === '101') {\r\n          field = 'learnSet-lecture-action';\r\n        } else if (task === '104') {\r\n          field = 'learnSet-material-action';\r\n        } else {\r\n          field = 'learnSet-record-action';\r\n        }\r\n        this.statisticsLogService.statisticsPacketInfoLog({\r\n          name: '实训库调用',\r\n          actionCode: STATISTICALRULES.packetInfo[field].addCode,\r\n          content: JSON.stringify(params),\r\n        });\r\n        this.data[index].isCall = true;\r\n        this.data[index].taskId = res.data.id;\r\n        this.callResourceData.nodes.push({\r\n          id: this.data[index].id,\r\n          taskId: res.data.id,\r\n        });\r\n        this.callResourceData.seq += 1;\r\n        SessionStorageUtil.putScpResourceMaterial(this.callResourceData);\r\n        this.setPermitedCall();\r\n\r\n      } else {\r\n        if (res.status === 500) {\r\n          this.message.error('服务器业务异常导致调用失败，可能标题太长，请保持35字符以内');\r\n        } else {\r\n          this.message.error(res.message);\r\n        }\r\n      }\r\n    };\r\n    this.isLoading = true;\r\n    if (this.task === '1') {\r\n      params.name = data.title;\r\n      params.taskType = '3';\r\n      params.seq = SessionStorageUtil.getScpResourceMaterial().seq;\r\n      this.courseMgService\r\n        .quickCreate_courseSectionResourceTask(params)\r\n        .subscribe(success, error);\r\n    } else {\r\n      params.title = data.title;\r\n      params.category = data.category;\r\n      params.type = this.task;\r\n      params.seq = SessionStorageUtil.getScpResourceMaterial().seq;\r\n      this.courseMgService\r\n        .quickCreate_courseSectionResource(params)\r\n        .subscribe(success, error);\r\n    }\r\n  }\r\n\r\n  cancelCallResource(data: any, index: number) {\r\n    const error = (err: any) => {\r\n      this.message.warning(JSON.stringify(err));\r\n    };\r\n    const success = (res: any) => {\r\n      if (res.status === 204) {\r\n        const {task} = this;\r\n        let field = '';\r\n        if (task === '1') {\r\n          field = 'learnSet-task-action';\r\n        } else if (task === '101') {\r\n          field = 'learnSet-lecture-action';\r\n        } else if (task === '104') {\r\n          field = 'learnSet-material-action';\r\n        } else {\r\n          field = 'learnSet-record-action';\r\n        }\r\n        this.statisticsLogService.statisticsPacketInfoLog({\r\n          name: '实训库取消调用',\r\n          actionCode: STATISTICALRULES.packetInfo[field].addCode,\r\n          content: data.taskId,\r\n        });\r\n        this.data[index].isCall = false;\r\n        this.callResourceData.nodes = this.callResourceData.nodes.filter(\r\n          (item) => item.id !== this.data[index].id\r\n        );\r\n        this.callResourceData.seq -= 1;\r\n        SessionStorageUtil.putScpResourceMaterial(this.callResourceData);\r\n        this.setPermitedCall();\r\n      } else {\r\n        this.message.warning(res.message || '未知错误');\r\n      }\r\n    };\r\n    if (this.task === '1') {\r\n      this.courseMgService\r\n        .delInvoke_courseTask(data.taskId)\r\n        .subscribe(success, error);\r\n    } else {\r\n      this.courseMgService.delInvoke_course(data.taskId)\r\n        .subscribe(success, error);\r\n    }\r\n  }\r\n}\r\n","<div class='header-container'>\r\n  实训设置\r\n  <button nz-button [nzType]=\"'primary'\" (click)=\"onContine(true)\" [nzLoading]='isLoading' style='float: right;margin:14px 10px 0 0; '\r\n  >保存\r\n  </button>\r\n  <button nz-button [nzType]=\"'primary'\" (click)=\"onContine()\" style='float: right;margin:14px 10px 0 0;'\r\n          *ngIf='this.type===\"add\"' [nzLoading]='isLoading'>保存并继续添加\r\n  </button>\r\n  <button nz-button class=\"margin-btn\" (click)=\"goBack()\"  style='float: right;margin:14px 10px 0 0;'>返回</button>\r\n</div>\r\n<section class=\"resource-container\">\r\n  <section class=\"left-tree\" nz-resizable [style.width.px]=\"width\"\r\n           (nzResize)=\"onResize($event)\" [hidden]=\"this.type === 'edit'\">\r\n    <div #treeContainer style='display:inline-block;overflow:hidden;margin-right: 30px;'>\r\n      <qkc-tree-knowledgegraph\r\n        model=\"custom\"\r\n        [practice]='true'\r\n        [professionId]=\"curProfessor?.id\"\r\n        [defaultCheckedKeys]='defaultTreeKey'\r\n        [allNodes]='true'\r\n        (nodeChange)=\"nodeChange($event)\"\r\n        #tree\r\n      >\r\n      </qkc-tree-knowledgegraph>\r\n    </div>\r\n    <nz-resize-handle nzDirection=\"right\">\r\n      <div class=\"right-wrap\">\r\n        <i class=\"right\" nz-icon nzType=\"more\" nzTheme=\"outline\"></i>\r\n      </div>\r\n    </nz-resize-handle>\r\n\r\n  </section>\r\n  <section class=\"right-resource\" [ngStyle]=\"this.type === 'edit'?{border:'none','padding-left':'10px'}:{}\">\r\n    <nz-spin [nzSpinning]=\"isLoading\" [nzDelay]=\"0\">\r\n      <div class=\"title\">{{type === 'add' ? '新增' : '编辑'}}实训</div>\r\n      <form nz-form [formGroup]=\"modalForms\" class=\"search-container\">\r\n        <nz-form-item>\r\n          <nz-form-label [nzSpan]=\"3\" nzRequired>实训标题</nz-form-label>\r\n          <nz-form-control [nzSpan]=\"15\" nzHasFeedback nzErrorTip=\"标题不能为空，并且不能超过30个字符\">\r\n            <input nz-input type=\"text\" formControlName=\"title\" placeholder=\"请输入标题......\" (keyup.enter)=\"onContine()\"/>\r\n          </nz-form-control>\r\n          <span style=\"line-height: 40px;margin-left: 10px;\">{{titleContent || 0}}/30</span>\r\n        </nz-form-item>\r\n        <nz-form-item>\r\n          <nz-form-label [nzSpan]=\"3\" nzRequired>学习目标</nz-form-label>\r\n          <nz-form-control [nzSpan]=\"15\" nzHasFeedback nzErrorTip=\"学习目标不能为空\">\r\n            <nz-select style=\"width: 100%\" nzPlaceHolder=\"请选择\" formControlName=\"learningGoalCode\">\r\n              <nz-option *ngFor=\"let option of learningTarget\" [nzLabel]=\"option.name\" [nzValue]=\"option.id\">\r\n              </nz-option>\r\n            </nz-select>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n        <nz-form-item>\r\n          <nz-form-label [nzSpan]=\"3\" nzRequired>实习系统</nz-form-label>\r\n          <nz-form-control [nzSpan]=\"15\" nzHasFeedback nzErrorTip=\"实习系统不能为空\">\r\n            <nz-select style=\"width: 100%\" nzPlaceHolder=\"请选择实习系统\" formControlName=\"authorUnit\">\r\n              <nz-option nzLabel=\"恒企实习系统\" nzValue=\"1\"></nz-option>\r\n            </nz-select>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n        <nz-form-item>\r\n          <nz-form-label [nzSpan]=\"3\" nzRequired>账期ID</nz-form-label>\r\n          <nz-form-control [nzSpan]=\"15\" nzHasFeedback nzErrorTip=\"账期ID不能为空\">\r\n            <input nz-input type=\"text\" formControlName=\"accountId\" placeholder=\"请输入账期ID\" (keyup.enter)=\"onContine()\">\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n      </form>\r\n    </nz-spin>\r\n  </section>\r\n</section>\r\n","import {Component, ElementRef, OnInit, ViewChild} from '@angular/core';\r\nimport {NzMessageService} from 'ng-zorro-antd/message';\r\nimport {NzTreeNodeOptions} from 'ng-zorro-antd';\r\nimport {TrainManageService} from 'src/app/busi-services/train-manage.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {MenuService} from 'core/services/menu.service';\r\nimport {NzResizeEvent} from 'ng-zorro-antd/resizable';\r\nimport {LEARNING_TARGET} from 'core/base/static-data';\r\nimport {FormBuilder, Validators, FormGroup} from '@angular/forms';\r\nimport {LocalStorageUtil} from 'core/utils/localstorage.util';\r\nimport {spaceValidator} from 'src/app/shared/validators/atr-validtors';\r\n\r\n@Component({\r\n  selector: 'app-save-train-course',\r\n  templateUrl: './save-train-course.component.html',\r\n  styleUrls: ['./save-train-course.component.less'],\r\n})\r\nexport class SaveTrainCourseComponent implements OnInit {\r\n  width;\r\n  id = -1;\r\n  type = 'add';\r\n  resourceId = '';\r\n  curProfessor: any = {};\r\n  curProfessorId = '';\r\n  defaultTreeKey: any = [];\r\n  checkTreeNode: any = [];\r\n  data: any = {};\r\n  isLoading = false;\r\n  userInfo = LocalStorageUtil.getUser();\r\n  learningTarget = LEARNING_TARGET;\r\n  modalForms: FormGroup;\r\n  @ViewChild('treeContainer') treeContainer: ElementRef<any>;\r\n\r\n  constructor(\r\n    private message: NzMessageService,\r\n    private trainManageService: TrainManageService,\r\n    private routerinfo: ActivatedRoute,\r\n    private menuService: MenuService,\r\n    private fb: FormBuilder\r\n  ) {\r\n  }\r\n\r\n  get titleContent() {\r\n    return this.modalForms.get('title').value.length;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.initParam();\r\n    this.initForm();\r\n    if (this.type !== 'add') {\r\n      this.getData(this.resourceId);\r\n    }\r\n    this.echoTreeData();\r\n  }\r\n\r\n  echoTreeData() {\r\n    const {select} = this.routerinfo.snapshot.queryParams;\r\n    if (select) {\r\n      this.defaultTreeKey = [select];\r\n      this.checkTreeNode = [select];\r\n    }\r\n  }\r\n\r\n  initParam() {\r\n    this.routerinfo.params.subscribe((param) => {\r\n      const {id, type, professionId} = param;\r\n      this.type = type;\r\n      this.resourceId = id;\r\n      this.curProfessorId = professionId;\r\n      this.curProfessor = {id: professionId};\r\n    });\r\n  }\r\n\r\n  initForm() {\r\n    this.modalForms = this.fb.group({\r\n      authorName: [this.userInfo.nickName, [Validators.required]],\r\n      authorUnit: ['1', [Validators.required]],\r\n      title: ['', [Validators.required, Validators.maxLength(30), spaceValidator()]],\r\n      learningGoalCode: ['', [Validators.required]],\r\n      accountId: ['', [Validators.required]],\r\n    });\r\n  }\r\n\r\n  onResize({width}: NzResizeEvent): void {\r\n    const flag = this.treeContainer\r\n      && this.treeContainer.nativeElement\r\n      && this.treeContainer.nativeElement.offsetWidth;\r\n    if (\r\n      flag && ((this.treeContainer.nativeElement.offsetWidth + 80 < width))\r\n      ||\r\n      (flag && (this.treeContainer.nativeElement.offsetWidth + 10) > width)\r\n    ) {\r\n      return;\r\n    }\r\n    cancelAnimationFrame(this.id);\r\n    this.id = requestAnimationFrame(() => {\r\n      // tslint:disable-next-line:no-non-null-assertion\r\n      this.width = width!;\r\n    });\r\n  }\r\n\r\n\r\n  nodeChange(nodeOpt: NzTreeNodeOptions) {\r\n    this.checkTreeNode = [nodeOpt.id];\r\n  }\r\n\r\n  getData(id): void {\r\n    const success = (result: any) => {\r\n      this.data = result.data || {};\r\n      this.defaultTreeKey = [this.data.industryId];\r\n      this.checkTreeNode = [this.data.industryId];\r\n      this.modalForms.patchValue({\r\n        authorName: this.data.authorName, // 作者\r\n        authorUnit: this.data.authorUnit, // 单位\r\n        title: this.data.title, // title\r\n        learningGoalCode: this.data.learningGoalCode,\r\n        accountId: this.data.accountId, // 系统\r\n      });\r\n      this.isLoading = false;\r\n    };\r\n\r\n    const error = (err: any) => {\r\n      this.isLoading = false;\r\n      this.message.create('error', JSON.stringify(err));\r\n    };\r\n\r\n    this.isLoading = true;\r\n    this.trainManageService.getPracticalById({id}).subscribe(success, error);\r\n  }\r\n\r\n\r\n  goBack() {\r\n    this.menuService.goBack(false);\r\n    this.menuService.gotoUrl({\r\n      url: '/m/rm/setting',\r\n      paramUrl: '',\r\n      title: '实训设置'\r\n    });\r\n  }\r\n\r\n\r\n  onContine(flag?) {\r\n    // tslint:disable-next-line:forin\r\n    for (const key in this.modalForms.controls) {\r\n      this.modalForms.controls[key].markAsDirty();\r\n      this.modalForms.controls[key].updateValueAndValidity();\r\n    }\r\n    if (this.modalForms.valid) {\r\n      if (this.curProfessor.id === this.checkTreeNode[0]) {\r\n        this.message.warning('请选择行业新增实训，目前您选择了课程');\r\n        return;\r\n      }\r\n      if (!this.checkTreeNode[0]) {\r\n        return this.message.warning('请选择行业再进行实训设置');\r\n      }\r\n      const params: any = {\r\n        ...this.modalForms.value,\r\n        industryId: this.checkTreeNode[0],\r\n        companyId: '0'\r\n      };\r\n\r\n      if (this.resourceId && this.type === 'edit') {\r\n        params.id = this.resourceId;\r\n      }\r\n      const success = (result: any) => {\r\n        this.isLoading = false;\r\n        if (result.status === 201) {\r\n          if (flag) {\r\n            this.goBack();\r\n          } else {\r\n            this.modalForms.patchValue({\r\n              title: '', // title\r\n              learningGoalCode: '',\r\n              accountId: '', // 系统\r\n            });\r\n            // tslint:disable-next-line:forin\r\n            for (const key in this.modalForms.controls) {\r\n              this.modalForms.controls[key].markAsPristine();\r\n              this.modalForms.controls[key].markAsUntouched();\r\n              this.modalForms.controls[key].updateValueAndValidity();\r\n            }\r\n          }\r\n        }\r\n      };\r\n      const error = () => {\r\n        this.isLoading = false;\r\n      };\r\n      this.isLoading = true;\r\n      this.trainManageService.savePractical(params).subscribe(success, error);\r\n    }\r\n  }\r\n}\r\n","<div class=\"container\" id=\"fullContainer\">\r\n  <div class=\"body\">\r\n      <iframe *ngIf='url'\r\n        allowfullscreen='true'\r\n        [src]=\"url\"\r\n        style=\"width: 100%;height:100%;border: none;min-height: 680px;\">\r\n      </iframe>\r\n  </div>\r\n</div>\r\n","import {NgModule} from '@angular/core';\r\nimport {RouterModule, Routes} from '@angular/router';\r\nimport {ReadLibComponent} from './material-library/read-lib/read-lib.component';\r\nimport {CaseLibComponent} from './material-library/case-lib/case-lib.component';\r\nimport {MaterialLibDetailsComponent} from './material-library/material-lib-details/material-lib-details.component';\r\nimport {MaterialPreviewCaseComponent} from './material-library/material-preview-case/material-preview-case.component';\r\nimport {MaterialPreviewOtherComponent} from './material-library/material-preview-other/material-preview-other.component';\r\nimport {NoFoundComponent} from '../../../../layout/404/404.component';\r\nimport {TrainLibraryCourseComponent} from './train-library-course/train-library-course.component';\r\nimport {SaveTrainCourseComponent} from './train-library-course/save-train-course/save-train-course.component';\r\nimport {ExerciseLibraryComponent} from './exercise-library/exercise-library.component';\r\n\r\nconst routes: Routes = [\r\n  {path: 'read', component: ReadLibComponent},\r\n  {path: 'case', component: CaseLibComponent},\r\n  {path: 'setting', component: TrainLibraryCourseComponent},\r\n  {path: 'exercise', component: ExerciseLibraryComponent},\r\n  {path: 'save-train/:type/:id/:professionId', component: SaveTrainCourseComponent},\r\n  {path: 'material-details/:id/:type/:professionId', component: MaterialLibDetailsComponent},\r\n  {path: 'material-pre-case/:id/:type/:professionId', component: MaterialPreviewCaseComponent},\r\n  {path: 'material-pre-other/:id/:type/:professionId', component: MaterialPreviewOtherComponent}, {\r\n    path: '**',\r\n    component: NoFoundComponent,\r\n    data: {title: '404'}\r\n  },\r\n\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class ResourceManageRoutingModule {\r\n}\r\n","import {Component} from '@angular/core';\r\nimport {DomSanitizer} from '@angular/platform-browser';\r\nimport {LocalStorageUtil} from 'core/utils/localstorage.util';\r\nimport {environment} from 'src/environments/environment';\r\nimport {ToolsUtil} from 'core/utils/tools.util';\r\nimport {timer} from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-exercise-library',\r\n  templateUrl: './exercise-library.component.html',\r\n  styleUrls: ['./exercise-library.component.less'],\r\n})\r\nexport class ExerciseLibraryComponent {\r\n  _PAGE_ID_ = 'ExerciseLibraryComponent';\r\n  orgCode = ToolsUtil.getOrgCode();\r\n  url;\r\n  codeMap = {\r\n    cjsd: 1,\r\n    zksd: 2,\r\n    zxjy: 3,\r\n    hgls: 4,\r\n    qm: 5\r\n  };\r\n  tokenObj = LocalStorageUtil.getTkToken();\r\n\r\n  constructor(\r\n    private sanitizer: DomSanitizer,\r\n  ) {\r\n    this.getUrl();\r\n  }\r\n\r\n  async getUrl() {\r\n    const codeUid = await ToolsUtil.getProdIdSync();\r\n    this.url = this.sanitizer.bypassSecurityTrustResourceUrl(\r\n      environment.questionBank + '/#/questionList?proId='\r\n      + codeUid +\r\n      '&token=' + this.tokenObj.token +\r\n      '&refreshToken=' + this.tokenObj.refreshToken +\r\n      '&show_layout=false');\r\n  }\r\n\r\n}\r\n","import {NgModule} from '@angular/core';\r\nimport {SharedModule} from 'src/app/shared/shared.module';\r\nimport {ResourceManageRoutingModule} from './resource-manage-routing.module';\r\nimport {QkcMediaModule, QkcMenuModule} from 'components-qkc';\r\nimport {CKEditorModule} from '@ckeditor/ckeditor5-angular';\r\n\r\nimport {MaterialLibDetailsComponent} from './material-library/material-lib-details/material-lib-details.component';\r\nimport {MaterialCaseComponent} from './material-library/material-case/material-case.component';\r\nimport {MaterialOtherComponent} from './material-library/material-other/material-other.component';\r\nimport {MaterialPreviewCaseComponent} from './material-library/material-preview-case/material-preview-case.component';\r\nimport {MaterialPreviewOtherComponent} from './material-library/material-preview-other/material-preview-other.component';\r\nimport {ReadLibComponent} from './material-library/read-lib/read-lib.component';\r\nimport {CaseLibComponent} from './material-library/case-lib/case-lib.component';\r\nimport {TrainLibraryCourseComponent} from './train-library-course/train-library-course.component';\r\nimport {SaveTrainCourseComponent} from './train-library-course/save-train-course/save-train-course.component';\r\nimport {ExerciseLibraryComponent} from '@app/routes/resource-manage/exercise-library/exercise-library.component';\r\n\r\nimport {QRCodeModule} from 'angular2-qrcode';\r\n\r\nconst COMPONENTS = [\r\n  MaterialLibDetailsComponent,\r\n  MaterialCaseComponent,\r\n  MaterialOtherComponent,\r\n  MaterialPreviewCaseComponent,\r\n  MaterialPreviewOtherComponent,\r\n  ReadLibComponent,\r\n  CaseLibComponent,\r\n  TrainLibraryCourseComponent,\r\n  SaveTrainCourseComponent,\r\n  ExerciseLibraryComponent\r\n];\r\n\r\n@NgModule({\r\n  declarations: [...COMPONENTS],\r\n  imports: [\r\n    SharedModule,\r\n    QkcMenuModule,\r\n    ResourceManageRoutingModule,\r\n    QkcMediaModule,\r\n    CKEditorModule,\r\n    QRCodeModule\r\n  ]\r\n})\r\nexport class ResourceManageModule {\r\n}\r\n","/*\n * QRious v4.0.2\n * Copyright (C) 2017 Alasdair Mercer\n * Copyright (C) 2010 Tom Zerucha\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.QRious = factory());\n}(this, (function () { 'use strict';\n\n  /*\n   * Copyright (C) 2017 Alasdair Mercer, !ninja\n   *\n   * Permission is hereby granted, free of charge, to any person obtaining a copy\n   * of this software and associated documentation files (the \"Software\"), to deal\n   * in the Software without restriction, including without limitation the rights\n   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n   * copies of the Software, and to permit persons to whom the Software is\n   * furnished to do so, subject to the following conditions:\n   *\n   * The above copyright notice and this permission notice shall be included in all\n   * copies or substantial portions of the Software.\n   *\n   * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n   * SOFTWARE.\n   */\n\n  /**\n   * A bare-bones constructor for surrogate prototype swapping.\n   *\n   * @private\n   * @constructor\n   */\n  var Constructor = /* istanbul ignore next */ function() {};\n  /**\n   * A reference to <code>Object.prototype.hasOwnProperty</code>.\n   *\n   * @private\n   * @type {Function}\n   */\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  /**\n   * A reference to <code>Array.prototype.slice</code>.\n   *\n   * @private\n   * @type {Function}\n   */\n  var slice = Array.prototype.slice;\n\n  /**\n   * Creates an object which inherits the given <code>prototype</code>.\n   *\n   * Optionally, the created object can be extended further with the specified <code>properties</code>.\n   *\n   * @param {Object} prototype - the prototype to be inherited by the created object\n   * @param {Object} [properties] - the optional properties to be extended by the created object\n   * @return {Object} The newly created object.\n   * @private\n   */\n  function createObject(prototype, properties) {\n    var result;\n    /* istanbul ignore next */\n    if (typeof Object.create === 'function') {\n      result = Object.create(prototype);\n    } else {\n      Constructor.prototype = prototype;\n      result = new Constructor();\n      Constructor.prototype = null;\n    }\n\n    if (properties) {\n      extendObject(true, result, properties);\n    }\n\n    return result;\n  }\n\n  /**\n   * Extends the constructor to which this method is associated with the <code>prototype</code> and/or\n   * <code>statics</code> provided.\n   *\n   * If <code>name</code> is provided, it will be used as the class name and can be accessed via a special\n   * <code>class_</code> property on the child constructor, otherwise the class name of the super constructor will be used\n   * instead. The class name may also be used string representation for instances of the child constructor (via\n   * <code>toString</code>), but this is not applicable to the <i>lite</i> version of Nevis.\n   *\n   * If <code>constructor</code> is provided, it will be used as the constructor for the child, otherwise a simple\n   * constructor which only calls the super constructor will be used instead.\n   *\n   * The super constructor can be accessed via a special <code>super_</code> property on the child constructor.\n   *\n   * @param {string} [name=this.class_] - the class name to be used for the child constructor\n   * @param {Function} [constructor] - the constructor for the child\n   * @param {Object} [prototype] - the prototype properties to be defined for the child\n   * @param {Object} [statics] - the static properties to be defined for the child\n   * @return {Function} The child <code>constructor</code> provided or the one created if none was given.\n   * @public\n   */\n  function extend(name, constructor, prototype, statics) {\n    var superConstructor = this;\n\n    if (typeof name !== 'string') {\n      statics = prototype;\n      prototype = constructor;\n      constructor = name;\n      name = null;\n    }\n\n    if (typeof constructor !== 'function') {\n      statics = prototype;\n      prototype = constructor;\n      constructor = function() {\n        return superConstructor.apply(this, arguments);\n      };\n    }\n\n    extendObject(false, constructor, superConstructor, statics);\n\n    constructor.prototype = createObject(superConstructor.prototype, prototype);\n    constructor.prototype.constructor = constructor;\n\n    constructor.class_ = name || superConstructor.class_;\n    constructor.super_ = superConstructor;\n\n    return constructor;\n  }\n\n  /**\n   * Extends the specified <code>target</code> object with the properties in each of the <code>sources</code> provided.\n   *\n   * if any source is <code>null</code> it will be ignored.\n   *\n   * @param {boolean} own - <code>true</code> to only copy <b>own</b> properties from <code>sources</code> onto\n   * <code>target</code>; otherwise <code>false</code>\n   * @param {Object} target - the target object which should be extended\n   * @param {...Object} [sources] - the source objects whose properties are to be copied onto <code>target</code>\n   * @return {void}\n   * @private\n   */\n  function extendObject(own, target, sources) {\n    sources = slice.call(arguments, 2);\n\n    var property;\n    var source;\n\n    for (var i = 0, length = sources.length; i < length; i++) {\n      source = sources[i];\n\n      for (property in source) {\n        if (!own || hasOwnProperty.call(source, property)) {\n          target[property] = source[property];\n        }\n      }\n    }\n  }\n\n  var extend_1 = extend;\n\n  /**\n   * The base class from which all others should extend.\n   *\n   * @public\n   * @constructor\n   */\n  function Nevis() {}\n  Nevis.class_ = 'Nevis';\n  Nevis.super_ = Object;\n\n  /**\n   * Extends the constructor to which this method is associated with the <code>prototype</code> and/or\n   * <code>statics</code> provided.\n   *\n   * If <code>name</code> is provided, it will be used as the class name and can be accessed via a special\n   * <code>class_</code> property on the child constructor, otherwise the class name of the super constructor will be used\n   * instead. The class name may also be used string representation for instances of the child constructor (via\n   * <code>toString</code>), but this is not applicable to the <i>lite</i> version of Nevis.\n   *\n   * If <code>constructor</code> is provided, it will be used as the constructor for the child, otherwise a simple\n   * constructor which only calls the super constructor will be used instead.\n   *\n   * The super constructor can be accessed via a special <code>super_</code> property on the child constructor.\n   *\n   * @param {string} [name=this.class_] - the class name to be used for the child constructor\n   * @param {Function} [constructor] - the constructor for the child\n   * @param {Object} [prototype] - the prototype properties to be defined for the child\n   * @param {Object} [statics] - the static properties to be defined for the child\n   * @return {Function} The child <code>constructor</code> provided or the one created if none was given.\n   * @public\n   * @static\n   * @memberof Nevis\n   */\n  Nevis.extend = extend_1;\n\n  var nevis = Nevis;\n\n  var lite = nevis;\n\n  /**\n   * Responsible for rendering a QR code {@link Frame} on a specific type of element.\n   *\n   * A renderer may be dependant on the rendering of another element, so the ordering of their execution is important.\n   *\n   * The rendering of a element can be deferred by disabling the renderer initially, however, any attempt get the element\n   * from the renderer will result in it being immediately enabled and the element being rendered.\n   *\n   * @param {QRious} qrious - the {@link QRious} instance to be used\n   * @param {*} element - the element onto which the QR code is to be rendered\n   * @param {boolean} [enabled] - <code>true</code> this {@link Renderer} is enabled; otherwise <code>false</code>.\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var Renderer = lite.extend(function(qrious, element, enabled) {\n    /**\n     * The {@link QRious} instance.\n     *\n     * @protected\n     * @type {QRious}\n     * @memberof Renderer#\n     */\n    this.qrious = qrious;\n\n    /**\n     * The element onto which this {@link Renderer} is rendering the QR code.\n     *\n     * @protected\n     * @type {*}\n     * @memberof Renderer#\n     */\n    this.element = element;\n    this.element.qrious = qrious;\n\n    /**\n     * Whether this {@link Renderer} is enabled.\n     *\n     * @protected\n     * @type {boolean}\n     * @memberof Renderer#\n     */\n    this.enabled = Boolean(enabled);\n  }, {\n\n    /**\n     * Draws the specified QR code <code>frame</code> on the underlying element.\n     *\n     * Implementations of {@link Renderer} <b>must</b> override this method with their own specific logic.\n     *\n     * @param {Frame} frame - the {@link Frame} to be drawn\n     * @return {void}\n     * @protected\n     * @abstract\n     * @memberof Renderer#\n     */\n    draw: function(frame) {},\n\n    /**\n     * Returns the element onto which this {@link Renderer} is rendering the QR code.\n     *\n     * If this method is called while this {@link Renderer} is disabled, it will be immediately enabled and rendered\n     * before the element is returned.\n     *\n     * @return {*} The element.\n     * @public\n     * @memberof Renderer#\n     */\n    getElement: function() {\n      if (!this.enabled) {\n        this.enabled = true;\n        this.render();\n      }\n\n      return this.element;\n    },\n\n    /**\n     * Calculates the size (in pixel units) to represent an individual module within the QR code based on the\n     * <code>frame</code> provided.\n     *\n     * Any configured padding will be excluded from the returned size.\n     *\n     * The returned value will be at least one, even in cases where the size of the QR code does not fit its contents.\n     * This is done so that the inevitable clipping is handled more gracefully since this way at least something is\n     * displayed instead of just a blank space filled by the background color.\n     *\n     * @param {Frame} frame - the {@link Frame} from which the module size is to be derived\n     * @return {number} The pixel size for each module in the QR code which will be no less than one.\n     * @protected\n     * @memberof Renderer#\n     */\n    getModuleSize: function(frame) {\n      var qrious = this.qrious;\n      var padding = qrious.padding || 0;\n      var pixels = Math.floor((qrious.size - (padding * 2)) / frame.width);\n\n      return Math.max(1, pixels);\n    },\n\n    /**\n     * Calculates the offset/padding (in pixel units) to be inserted before the QR code based on the <code>frame</code>\n     * provided.\n     *\n     * The returned value will be zero if there is no available offset or if the size of the QR code does not fit its\n     * contents. It will never be a negative value. This is done so that the inevitable clipping appears more naturally\n     * and it is not clipped from all directions.\n     *\n     * @param {Frame} frame - the {@link Frame} from which the offset is to be derived\n     * @return {number} The pixel offset for the QR code which will be no less than zero.\n     * @protected\n     * @memberof Renderer#\n     */\n    getOffset: function(frame) {\n      var qrious = this.qrious;\n      var padding = qrious.padding;\n\n      if (padding != null) {\n        return padding;\n      }\n\n      var moduleSize = this.getModuleSize(frame);\n      var offset = Math.floor((qrious.size - (moduleSize * frame.width)) / 2);\n\n      return Math.max(0, offset);\n    },\n\n    /**\n     * Renders a QR code on the underlying element based on the <code>frame</code> provided.\n     *\n     * @param {Frame} frame - the {@link Frame} to be rendered\n     * @return {void}\n     * @public\n     * @memberof Renderer#\n     */\n    render: function(frame) {\n      if (this.enabled) {\n        this.resize();\n        this.reset();\n        this.draw(frame);\n      }\n    },\n\n    /**\n     * Resets the underlying element, effectively clearing any previously rendered QR code.\n     *\n     * Implementations of {@link Renderer} <b>must</b> override this method with their own specific logic.\n     *\n     * @return {void}\n     * @protected\n     * @abstract\n     * @memberof Renderer#\n     */\n    reset: function() {},\n\n    /**\n     * Ensures that the size of the underlying element matches that defined on the associated {@link QRious} instance.\n     *\n     * Implementations of {@link Renderer} <b>must</b> override this method with their own specific logic.\n     *\n     * @return {void}\n     * @protected\n     * @abstract\n     * @memberof Renderer#\n     */\n    resize: function() {}\n\n  });\n\n  var Renderer_1 = Renderer;\n\n  /**\n   * An implementation of {@link Renderer} for working with <code>canvas</code> elements.\n   *\n   * @public\n   * @class\n   * @extends Renderer\n   */\n  var CanvasRenderer = Renderer_1.extend({\n\n    /**\n     * @override\n     */\n    draw: function(frame) {\n      var i, j;\n      var qrious = this.qrious;\n      var moduleSize = this.getModuleSize(frame);\n      var offset = this.getOffset(frame);\n      var context = this.element.getContext('2d');\n\n      context.fillStyle = qrious.foreground;\n      context.globalAlpha = qrious.foregroundAlpha;\n\n      for (i = 0; i < frame.width; i++) {\n        for (j = 0; j < frame.width; j++) {\n          if (frame.buffer[(j * frame.width) + i]) {\n            context.fillRect((moduleSize * i) + offset, (moduleSize * j) + offset, moduleSize, moduleSize);\n          }\n        }\n      }\n    },\n\n    /**\n     * @override\n     */\n    reset: function() {\n      var qrious = this.qrious;\n      var context = this.element.getContext('2d');\n      var size = qrious.size;\n\n      context.lineWidth = 1;\n      context.clearRect(0, 0, size, size);\n      context.fillStyle = qrious.background;\n      context.globalAlpha = qrious.backgroundAlpha;\n      context.fillRect(0, 0, size, size);\n    },\n\n    /**\n     * @override\n     */\n    resize: function() {\n      var element = this.element;\n\n      element.width = element.height = this.qrious.size;\n    }\n\n  });\n\n  var CanvasRenderer_1 = CanvasRenderer;\n\n  /* eslint no-multi-spaces: \"off\" */\n\n\n\n  /**\n   * Contains alignment pattern information.\n   *\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var Alignment = lite.extend(null, {\n\n    /**\n     * The alignment pattern block.\n     *\n     * @public\n     * @static\n     * @type {number[]}\n     * @memberof Alignment\n     */\n    BLOCK: [\n      0,  11, 15, 19, 23, 27, 31,\n      16, 18, 20, 22, 24, 26, 28, 20, 22, 24, 24, 26, 28, 28, 22, 24, 24,\n      26, 26, 28, 28, 24, 24, 26, 26, 26, 28, 28, 24, 26, 26, 26, 28, 28\n    ]\n\n  });\n\n  var Alignment_1 = Alignment;\n\n  /* eslint no-multi-spaces: \"off\" */\n\n\n\n  /**\n   * Contains error correction information.\n   *\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var ErrorCorrection = lite.extend(null, {\n\n    /**\n     * The error correction blocks.\n     *\n     * There are four elements per version. The first two indicate the number of blocks, then the data width, and finally\n     * the ECC width.\n     *\n     * @public\n     * @static\n     * @type {number[]}\n     * @memberof ErrorCorrection\n     */\n    BLOCKS: [\n      1,  0,  19,  7,     1,  0,  16,  10,    1,  0,  13,  13,    1,  0,  9,   17,\n      1,  0,  34,  10,    1,  0,  28,  16,    1,  0,  22,  22,    1,  0,  16,  28,\n      1,  0,  55,  15,    1,  0,  44,  26,    2,  0,  17,  18,    2,  0,  13,  22,\n      1,  0,  80,  20,    2,  0,  32,  18,    2,  0,  24,  26,    4,  0,  9,   16,\n      1,  0,  108, 26,    2,  0,  43,  24,    2,  2,  15,  18,    2,  2,  11,  22,\n      2,  0,  68,  18,    4,  0,  27,  16,    4,  0,  19,  24,    4,  0,  15,  28,\n      2,  0,  78,  20,    4,  0,  31,  18,    2,  4,  14,  18,    4,  1,  13,  26,\n      2,  0,  97,  24,    2,  2,  38,  22,    4,  2,  18,  22,    4,  2,  14,  26,\n      2,  0,  116, 30,    3,  2,  36,  22,    4,  4,  16,  20,    4,  4,  12,  24,\n      2,  2,  68,  18,    4,  1,  43,  26,    6,  2,  19,  24,    6,  2,  15,  28,\n      4,  0,  81,  20,    1,  4,  50,  30,    4,  4,  22,  28,    3,  8,  12,  24,\n      2,  2,  92,  24,    6,  2,  36,  22,    4,  6,  20,  26,    7,  4,  14,  28,\n      4,  0,  107, 26,    8,  1,  37,  22,    8,  4,  20,  24,    12, 4,  11,  22,\n      3,  1,  115, 30,    4,  5,  40,  24,    11, 5,  16,  20,    11, 5,  12,  24,\n      5,  1,  87,  22,    5,  5,  41,  24,    5,  7,  24,  30,    11, 7,  12,  24,\n      5,  1,  98,  24,    7,  3,  45,  28,    15, 2,  19,  24,    3,  13, 15,  30,\n      1,  5,  107, 28,    10, 1,  46,  28,    1,  15, 22,  28,    2,  17, 14,  28,\n      5,  1,  120, 30,    9,  4,  43,  26,    17, 1,  22,  28,    2,  19, 14,  28,\n      3,  4,  113, 28,    3,  11, 44,  26,    17, 4,  21,  26,    9,  16, 13,  26,\n      3,  5,  107, 28,    3,  13, 41,  26,    15, 5,  24,  30,    15, 10, 15,  28,\n      4,  4,  116, 28,    17, 0,  42,  26,    17, 6,  22,  28,    19, 6,  16,  30,\n      2,  7,  111, 28,    17, 0,  46,  28,    7,  16, 24,  30,    34, 0,  13,  24,\n      4,  5,  121, 30,    4,  14, 47,  28,    11, 14, 24,  30,    16, 14, 15,  30,\n      6,  4,  117, 30,    6,  14, 45,  28,    11, 16, 24,  30,    30, 2,  16,  30,\n      8,  4,  106, 26,    8,  13, 47,  28,    7,  22, 24,  30,    22, 13, 15,  30,\n      10, 2,  114, 28,    19, 4,  46,  28,    28, 6,  22,  28,    33, 4,  16,  30,\n      8,  4,  122, 30,    22, 3,  45,  28,    8,  26, 23,  30,    12, 28, 15,  30,\n      3,  10, 117, 30,    3,  23, 45,  28,    4,  31, 24,  30,    11, 31, 15,  30,\n      7,  7,  116, 30,    21, 7,  45,  28,    1,  37, 23,  30,    19, 26, 15,  30,\n      5,  10, 115, 30,    19, 10, 47,  28,    15, 25, 24,  30,    23, 25, 15,  30,\n      13, 3,  115, 30,    2,  29, 46,  28,    42, 1,  24,  30,    23, 28, 15,  30,\n      17, 0,  115, 30,    10, 23, 46,  28,    10, 35, 24,  30,    19, 35, 15,  30,\n      17, 1,  115, 30,    14, 21, 46,  28,    29, 19, 24,  30,    11, 46, 15,  30,\n      13, 6,  115, 30,    14, 23, 46,  28,    44, 7,  24,  30,    59, 1,  16,  30,\n      12, 7,  121, 30,    12, 26, 47,  28,    39, 14, 24,  30,    22, 41, 15,  30,\n      6,  14, 121, 30,    6,  34, 47,  28,    46, 10, 24,  30,    2,  64, 15,  30,\n      17, 4,  122, 30,    29, 14, 46,  28,    49, 10, 24,  30,    24, 46, 15,  30,\n      4,  18, 122, 30,    13, 32, 46,  28,    48, 14, 24,  30,    42, 32, 15,  30,\n      20, 4,  117, 30,    40, 7,  47,  28,    43, 22, 24,  30,    10, 67, 15,  30,\n      19, 6,  118, 30,    18, 31, 47,  28,    34, 34, 24,  30,    20, 61, 15,  30\n    ],\n\n    /**\n     * The final format bits with mask (level << 3 | mask).\n     *\n     * @public\n     * @static\n     * @type {number[]}\n     * @memberof ErrorCorrection\n     */\n    FINAL_FORMAT: [\n      // L\n      0x77c4, 0x72f3, 0x7daa, 0x789d, 0x662f, 0x6318, 0x6c41, 0x6976,\n      // M\n      0x5412, 0x5125, 0x5e7c, 0x5b4b, 0x45f9, 0x40ce, 0x4f97, 0x4aa0,\n      // Q\n      0x355f, 0x3068, 0x3f31, 0x3a06, 0x24b4, 0x2183, 0x2eda, 0x2bed,\n      // H\n      0x1689, 0x13be, 0x1ce7, 0x19d0, 0x0762, 0x0255, 0x0d0c, 0x083b\n    ],\n\n    /**\n     * A map of human-readable ECC levels.\n     *\n     * @public\n     * @static\n     * @type {Object.<string, number>}\n     * @memberof ErrorCorrection\n     */\n    LEVELS: {\n      L: 1,\n      M: 2,\n      Q: 3,\n      H: 4\n    }\n\n  });\n\n  var ErrorCorrection_1 = ErrorCorrection;\n\n  /**\n   * Contains Galois field information.\n   *\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var Galois = lite.extend(null, {\n\n    /**\n     * The Galois field exponent table.\n     *\n     * @public\n     * @static\n     * @type {number[]}\n     * @memberof Galois\n     */\n    EXPONENT: [\n      0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1d, 0x3a, 0x74, 0xe8, 0xcd, 0x87, 0x13, 0x26,\n      0x4c, 0x98, 0x2d, 0x5a, 0xb4, 0x75, 0xea, 0xc9, 0x8f, 0x03, 0x06, 0x0c, 0x18, 0x30, 0x60, 0xc0,\n      0x9d, 0x27, 0x4e, 0x9c, 0x25, 0x4a, 0x94, 0x35, 0x6a, 0xd4, 0xb5, 0x77, 0xee, 0xc1, 0x9f, 0x23,\n      0x46, 0x8c, 0x05, 0x0a, 0x14, 0x28, 0x50, 0xa0, 0x5d, 0xba, 0x69, 0xd2, 0xb9, 0x6f, 0xde, 0xa1,\n      0x5f, 0xbe, 0x61, 0xc2, 0x99, 0x2f, 0x5e, 0xbc, 0x65, 0xca, 0x89, 0x0f, 0x1e, 0x3c, 0x78, 0xf0,\n      0xfd, 0xe7, 0xd3, 0xbb, 0x6b, 0xd6, 0xb1, 0x7f, 0xfe, 0xe1, 0xdf, 0xa3, 0x5b, 0xb6, 0x71, 0xe2,\n      0xd9, 0xaf, 0x43, 0x86, 0x11, 0x22, 0x44, 0x88, 0x0d, 0x1a, 0x34, 0x68, 0xd0, 0xbd, 0x67, 0xce,\n      0x81, 0x1f, 0x3e, 0x7c, 0xf8, 0xed, 0xc7, 0x93, 0x3b, 0x76, 0xec, 0xc5, 0x97, 0x33, 0x66, 0xcc,\n      0x85, 0x17, 0x2e, 0x5c, 0xb8, 0x6d, 0xda, 0xa9, 0x4f, 0x9e, 0x21, 0x42, 0x84, 0x15, 0x2a, 0x54,\n      0xa8, 0x4d, 0x9a, 0x29, 0x52, 0xa4, 0x55, 0xaa, 0x49, 0x92, 0x39, 0x72, 0xe4, 0xd5, 0xb7, 0x73,\n      0xe6, 0xd1, 0xbf, 0x63, 0xc6, 0x91, 0x3f, 0x7e, 0xfc, 0xe5, 0xd7, 0xb3, 0x7b, 0xf6, 0xf1, 0xff,\n      0xe3, 0xdb, 0xab, 0x4b, 0x96, 0x31, 0x62, 0xc4, 0x95, 0x37, 0x6e, 0xdc, 0xa5, 0x57, 0xae, 0x41,\n      0x82, 0x19, 0x32, 0x64, 0xc8, 0x8d, 0x07, 0x0e, 0x1c, 0x38, 0x70, 0xe0, 0xdd, 0xa7, 0x53, 0xa6,\n      0x51, 0xa2, 0x59, 0xb2, 0x79, 0xf2, 0xf9, 0xef, 0xc3, 0x9b, 0x2b, 0x56, 0xac, 0x45, 0x8a, 0x09,\n      0x12, 0x24, 0x48, 0x90, 0x3d, 0x7a, 0xf4, 0xf5, 0xf7, 0xf3, 0xfb, 0xeb, 0xcb, 0x8b, 0x0b, 0x16,\n      0x2c, 0x58, 0xb0, 0x7d, 0xfa, 0xe9, 0xcf, 0x83, 0x1b, 0x36, 0x6c, 0xd8, 0xad, 0x47, 0x8e, 0x00\n    ],\n\n    /**\n     * The Galois field log table.\n     *\n     * @public\n     * @static\n     * @type {number[]}\n     * @memberof Galois\n     */\n    LOG: [\n      0xff, 0x00, 0x01, 0x19, 0x02, 0x32, 0x1a, 0xc6, 0x03, 0xdf, 0x33, 0xee, 0x1b, 0x68, 0xc7, 0x4b,\n      0x04, 0x64, 0xe0, 0x0e, 0x34, 0x8d, 0xef, 0x81, 0x1c, 0xc1, 0x69, 0xf8, 0xc8, 0x08, 0x4c, 0x71,\n      0x05, 0x8a, 0x65, 0x2f, 0xe1, 0x24, 0x0f, 0x21, 0x35, 0x93, 0x8e, 0xda, 0xf0, 0x12, 0x82, 0x45,\n      0x1d, 0xb5, 0xc2, 0x7d, 0x6a, 0x27, 0xf9, 0xb9, 0xc9, 0x9a, 0x09, 0x78, 0x4d, 0xe4, 0x72, 0xa6,\n      0x06, 0xbf, 0x8b, 0x62, 0x66, 0xdd, 0x30, 0xfd, 0xe2, 0x98, 0x25, 0xb3, 0x10, 0x91, 0x22, 0x88,\n      0x36, 0xd0, 0x94, 0xce, 0x8f, 0x96, 0xdb, 0xbd, 0xf1, 0xd2, 0x13, 0x5c, 0x83, 0x38, 0x46, 0x40,\n      0x1e, 0x42, 0xb6, 0xa3, 0xc3, 0x48, 0x7e, 0x6e, 0x6b, 0x3a, 0x28, 0x54, 0xfa, 0x85, 0xba, 0x3d,\n      0xca, 0x5e, 0x9b, 0x9f, 0x0a, 0x15, 0x79, 0x2b, 0x4e, 0xd4, 0xe5, 0xac, 0x73, 0xf3, 0xa7, 0x57,\n      0x07, 0x70, 0xc0, 0xf7, 0x8c, 0x80, 0x63, 0x0d, 0x67, 0x4a, 0xde, 0xed, 0x31, 0xc5, 0xfe, 0x18,\n      0xe3, 0xa5, 0x99, 0x77, 0x26, 0xb8, 0xb4, 0x7c, 0x11, 0x44, 0x92, 0xd9, 0x23, 0x20, 0x89, 0x2e,\n      0x37, 0x3f, 0xd1, 0x5b, 0x95, 0xbc, 0xcf, 0xcd, 0x90, 0x87, 0x97, 0xb2, 0xdc, 0xfc, 0xbe, 0x61,\n      0xf2, 0x56, 0xd3, 0xab, 0x14, 0x2a, 0x5d, 0x9e, 0x84, 0x3c, 0x39, 0x53, 0x47, 0x6d, 0x41, 0xa2,\n      0x1f, 0x2d, 0x43, 0xd8, 0xb7, 0x7b, 0xa4, 0x76, 0xc4, 0x17, 0x49, 0xec, 0x7f, 0x0c, 0x6f, 0xf6,\n      0x6c, 0xa1, 0x3b, 0x52, 0x29, 0x9d, 0x55, 0xaa, 0xfb, 0x60, 0x86, 0xb1, 0xbb, 0xcc, 0x3e, 0x5a,\n      0xcb, 0x59, 0x5f, 0xb0, 0x9c, 0xa9, 0xa0, 0x51, 0x0b, 0xf5, 0x16, 0xeb, 0x7a, 0x75, 0x2c, 0xd7,\n      0x4f, 0xae, 0xd5, 0xe9, 0xe6, 0xe7, 0xad, 0xe8, 0x74, 0xd6, 0xf4, 0xea, 0xa8, 0x50, 0x58, 0xaf\n    ]\n\n  });\n\n  var Galois_1 = Galois;\n\n  /**\n   * Contains version pattern information.\n   *\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var Version = lite.extend(null, {\n\n    /**\n     * The version pattern block.\n     *\n     * @public\n     * @static\n     * @type {number[]}\n     * @memberof Version\n     */\n    BLOCK: [\n      0xc94, 0x5bc, 0xa99, 0x4d3, 0xbf6, 0x762, 0x847, 0x60d, 0x928, 0xb78, 0x45d, 0xa17, 0x532,\n      0x9a6, 0x683, 0x8c9, 0x7ec, 0xec4, 0x1e1, 0xfab, 0x08e, 0xc1a, 0x33f, 0xd75, 0x250, 0x9d5,\n      0x6f0, 0x8ba, 0x79f, 0xb0b, 0x42e, 0xa64, 0x541, 0xc69\n    ]\n\n  });\n\n  var Version_1 = Version;\n\n  /**\n   * Generates information for a QR code frame based on a specific value to be encoded.\n   *\n   * @param {Frame~Options} options - the options to be used\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var Frame = lite.extend(function(options) {\n    var dataBlock, eccBlock, index, neccBlock1, neccBlock2;\n    var valueLength = options.value.length;\n\n    this._badness = [];\n    this._level = ErrorCorrection_1.LEVELS[options.level];\n    this._polynomial = [];\n    this._value = options.value;\n    this._version = 0;\n    this._stringBuffer = [];\n\n    while (this._version < 40) {\n      this._version++;\n\n      index = ((this._level - 1) * 4) + ((this._version - 1) * 16);\n\n      neccBlock1 = ErrorCorrection_1.BLOCKS[index++];\n      neccBlock2 = ErrorCorrection_1.BLOCKS[index++];\n      dataBlock = ErrorCorrection_1.BLOCKS[index++];\n      eccBlock = ErrorCorrection_1.BLOCKS[index];\n\n      index = (dataBlock * (neccBlock1 + neccBlock2)) + neccBlock2 - 3 + (this._version <= 9);\n\n      if (valueLength <= index) {\n        break;\n      }\n    }\n\n    this._dataBlock = dataBlock;\n    this._eccBlock = eccBlock;\n    this._neccBlock1 = neccBlock1;\n    this._neccBlock2 = neccBlock2;\n\n    /**\n     * The data width is based on version.\n     *\n     * @public\n     * @type {number}\n     * @memberof Frame#\n     */\n    // FIXME: Ensure that it fits instead of being truncated.\n    var width = this.width = 17 + (4 * this._version);\n\n    /**\n     * The image buffer.\n     *\n     * @public\n     * @type {number[]}\n     * @memberof Frame#\n     */\n    this.buffer = Frame._createArray(width * width);\n\n    this._ecc = Frame._createArray(dataBlock + ((dataBlock + eccBlock) * (neccBlock1 + neccBlock2)) + neccBlock2);\n    this._mask = Frame._createArray(((width * (width + 1)) + 1) / 2);\n\n    this._insertFinders();\n    this._insertAlignments();\n\n    // Insert single foreground cell.\n    this.buffer[8 + (width * (width - 8))] = 1;\n\n    this._insertTimingGap();\n    this._reverseMask();\n    this._insertTimingRowAndColumn();\n    this._insertVersion();\n    this._syncMask();\n    this._convertBitStream(valueLength);\n    this._calculatePolynomial();\n    this._appendEccToData();\n    this._interleaveBlocks();\n    this._pack();\n    this._finish();\n  }, {\n\n    _addAlignment: function(x, y) {\n      var i;\n      var buffer = this.buffer;\n      var width = this.width;\n\n      buffer[x + (width * y)] = 1;\n\n      for (i = -2; i < 2; i++) {\n        buffer[x + i + (width * (y - 2))] = 1;\n        buffer[x - 2 + (width * (y + i + 1))] = 1;\n        buffer[x + 2 + (width * (y + i))] = 1;\n        buffer[x + i + 1 + (width * (y + 2))] = 1;\n      }\n\n      for (i = 0; i < 2; i++) {\n        this._setMask(x - 1, y + i);\n        this._setMask(x + 1, y - i);\n        this._setMask(x - i, y - 1);\n        this._setMask(x + i, y + 1);\n      }\n    },\n\n    _appendData: function(data, dataLength, ecc, eccLength) {\n      var bit, i, j;\n      var polynomial = this._polynomial;\n      var stringBuffer = this._stringBuffer;\n\n      for (i = 0; i < eccLength; i++) {\n        stringBuffer[ecc + i] = 0;\n      }\n\n      for (i = 0; i < dataLength; i++) {\n        bit = Galois_1.LOG[stringBuffer[data + i] ^ stringBuffer[ecc]];\n\n        if (bit !== 255) {\n          for (j = 1; j < eccLength; j++) {\n            stringBuffer[ecc + j - 1] = stringBuffer[ecc + j] ^\n              Galois_1.EXPONENT[Frame._modN(bit + polynomial[eccLength - j])];\n          }\n        } else {\n          for (j = ecc; j < ecc + eccLength; j++) {\n            stringBuffer[j] = stringBuffer[j + 1];\n          }\n        }\n\n        stringBuffer[ecc + eccLength - 1] = bit === 255 ? 0 : Galois_1.EXPONENT[Frame._modN(bit + polynomial[0])];\n      }\n    },\n\n    _appendEccToData: function() {\n      var i;\n      var data = 0;\n      var dataBlock = this._dataBlock;\n      var ecc = this._calculateMaxLength();\n      var eccBlock = this._eccBlock;\n\n      for (i = 0; i < this._neccBlock1; i++) {\n        this._appendData(data, dataBlock, ecc, eccBlock);\n\n        data += dataBlock;\n        ecc += eccBlock;\n      }\n\n      for (i = 0; i < this._neccBlock2; i++) {\n        this._appendData(data, dataBlock + 1, ecc, eccBlock);\n\n        data += dataBlock + 1;\n        ecc += eccBlock;\n      }\n    },\n\n    _applyMask: function(mask) {\n      var r3x, r3y, x, y;\n      var buffer = this.buffer;\n      var width = this.width;\n\n      switch (mask) {\n      case 0:\n        for (y = 0; y < width; y++) {\n          for (x = 0; x < width; x++) {\n            if (!((x + y) & 1) && !this._isMasked(x, y)) {\n              buffer[x + (y * width)] ^= 1;\n            }\n          }\n        }\n\n        break;\n      case 1:\n        for (y = 0; y < width; y++) {\n          for (x = 0; x < width; x++) {\n            if (!(y & 1) && !this._isMasked(x, y)) {\n              buffer[x + (y * width)] ^= 1;\n            }\n          }\n        }\n\n        break;\n      case 2:\n        for (y = 0; y < width; y++) {\n          for (r3x = 0, x = 0; x < width; x++, r3x++) {\n            if (r3x === 3) {\n              r3x = 0;\n            }\n\n            if (!r3x && !this._isMasked(x, y)) {\n              buffer[x + (y * width)] ^= 1;\n            }\n          }\n        }\n\n        break;\n      case 3:\n        for (r3y = 0, y = 0; y < width; y++, r3y++) {\n          if (r3y === 3) {\n            r3y = 0;\n          }\n\n          for (r3x = r3y, x = 0; x < width; x++, r3x++) {\n            if (r3x === 3) {\n              r3x = 0;\n            }\n\n            if (!r3x && !this._isMasked(x, y)) {\n              buffer[x + (y * width)] ^= 1;\n            }\n          }\n        }\n\n        break;\n      case 4:\n        for (y = 0; y < width; y++) {\n          for (r3x = 0, r3y = (y >> 1) & 1, x = 0; x < width; x++, r3x++) {\n            if (r3x === 3) {\n              r3x = 0;\n              r3y = !r3y;\n            }\n\n            if (!r3y && !this._isMasked(x, y)) {\n              buffer[x + (y * width)] ^= 1;\n            }\n          }\n        }\n\n        break;\n      case 5:\n        for (r3y = 0, y = 0; y < width; y++, r3y++) {\n          if (r3y === 3) {\n            r3y = 0;\n          }\n\n          for (r3x = 0, x = 0; x < width; x++, r3x++) {\n            if (r3x === 3) {\n              r3x = 0;\n            }\n\n            if (!((x & y & 1) + !(!r3x | !r3y)) && !this._isMasked(x, y)) {\n              buffer[x + (y * width)] ^= 1;\n            }\n          }\n        }\n\n        break;\n      case 6:\n        for (r3y = 0, y = 0; y < width; y++, r3y++) {\n          if (r3y === 3) {\n            r3y = 0;\n          }\n\n          for (r3x = 0, x = 0; x < width; x++, r3x++) {\n            if (r3x === 3) {\n              r3x = 0;\n            }\n\n            if (!((x & y & 1) + (r3x && r3x === r3y) & 1) && !this._isMasked(x, y)) {\n              buffer[x + (y * width)] ^= 1;\n            }\n          }\n        }\n\n        break;\n      case 7:\n        for (r3y = 0, y = 0; y < width; y++, r3y++) {\n          if (r3y === 3) {\n            r3y = 0;\n          }\n\n          for (r3x = 0, x = 0; x < width; x++, r3x++) {\n            if (r3x === 3) {\n              r3x = 0;\n            }\n\n            if (!((r3x && r3x === r3y) + (x + y & 1) & 1) && !this._isMasked(x, y)) {\n              buffer[x + (y * width)] ^= 1;\n            }\n          }\n        }\n\n        break;\n      }\n    },\n\n    _calculateMaxLength: function() {\n      return (this._dataBlock * (this._neccBlock1 + this._neccBlock2)) + this._neccBlock2;\n    },\n\n    _calculatePolynomial: function() {\n      var i, j;\n      var eccBlock = this._eccBlock;\n      var polynomial = this._polynomial;\n\n      polynomial[0] = 1;\n\n      for (i = 0; i < eccBlock; i++) {\n        polynomial[i + 1] = 1;\n\n        for (j = i; j > 0; j--) {\n          polynomial[j] = polynomial[j] ? polynomial[j - 1] ^\n            Galois_1.EXPONENT[Frame._modN(Galois_1.LOG[polynomial[j]] + i)] : polynomial[j - 1];\n        }\n\n        polynomial[0] = Galois_1.EXPONENT[Frame._modN(Galois_1.LOG[polynomial[0]] + i)];\n      }\n\n      // Use logs for generator polynomial to save calculation step.\n      for (i = 0; i <= eccBlock; i++) {\n        polynomial[i] = Galois_1.LOG[polynomial[i]];\n      }\n    },\n\n    _checkBadness: function() {\n      var b, b1, h, x, y;\n      var bad = 0;\n      var badness = this._badness;\n      var buffer = this.buffer;\n      var width = this.width;\n\n      // Blocks of same colour.\n      for (y = 0; y < width - 1; y++) {\n        for (x = 0; x < width - 1; x++) {\n          // All foreground colour.\n          if ((buffer[x + (width * y)] &&\n            buffer[x + 1 + (width * y)] &&\n            buffer[x + (width * (y + 1))] &&\n            buffer[x + 1 + (width * (y + 1))]) ||\n            // All background colour.\n            !(buffer[x + (width * y)] ||\n            buffer[x + 1 + (width * y)] ||\n            buffer[x + (width * (y + 1))] ||\n            buffer[x + 1 + (width * (y + 1))])) {\n            bad += Frame.N2;\n          }\n        }\n      }\n\n      var bw = 0;\n\n      // X runs.\n      for (y = 0; y < width; y++) {\n        h = 0;\n\n        badness[0] = 0;\n\n        for (b = 0, x = 0; x < width; x++) {\n          b1 = buffer[x + (width * y)];\n\n          if (b === b1) {\n            badness[h]++;\n          } else {\n            badness[++h] = 1;\n          }\n\n          b = b1;\n          bw += b ? 1 : -1;\n        }\n\n        bad += this._getBadness(h);\n      }\n\n      if (bw < 0) {\n        bw = -bw;\n      }\n\n      var count = 0;\n      var big = bw;\n      big += big << 2;\n      big <<= 1;\n\n      while (big > width * width) {\n        big -= width * width;\n        count++;\n      }\n\n      bad += count * Frame.N4;\n\n      // Y runs.\n      for (x = 0; x < width; x++) {\n        h = 0;\n\n        badness[0] = 0;\n\n        for (b = 0, y = 0; y < width; y++) {\n          b1 = buffer[x + (width * y)];\n\n          if (b === b1) {\n            badness[h]++;\n          } else {\n            badness[++h] = 1;\n          }\n\n          b = b1;\n        }\n\n        bad += this._getBadness(h);\n      }\n\n      return bad;\n    },\n\n    _convertBitStream: function(length) {\n      var bit, i;\n      var ecc = this._ecc;\n      var version = this._version;\n\n      // Convert string to bit stream. 8-bit data to QR-coded 8-bit data (numeric, alphanumeric, or kanji not supported).\n      for (i = 0; i < length; i++) {\n        ecc[i] = this._value.charCodeAt(i);\n      }\n\n      var stringBuffer = this._stringBuffer = ecc.slice();\n      var maxLength = this._calculateMaxLength();\n\n      if (length >= maxLength - 2) {\n        length = maxLength - 2;\n\n        if (version > 9) {\n          length--;\n        }\n      }\n\n      // Shift and re-pack to insert length prefix.\n      var index = length;\n\n      if (version > 9) {\n        stringBuffer[index + 2] = 0;\n        stringBuffer[index + 3] = 0;\n\n        while (index--) {\n          bit = stringBuffer[index];\n\n          stringBuffer[index + 3] |= 255 & (bit << 4);\n          stringBuffer[index + 2] = bit >> 4;\n        }\n\n        stringBuffer[2] |= 255 & (length << 4);\n        stringBuffer[1] = length >> 4;\n        stringBuffer[0] = 0x40 | (length >> 12);\n      } else {\n        stringBuffer[index + 1] = 0;\n        stringBuffer[index + 2] = 0;\n\n        while (index--) {\n          bit = stringBuffer[index];\n\n          stringBuffer[index + 2] |= 255 & (bit << 4);\n          stringBuffer[index + 1] = bit >> 4;\n        }\n\n        stringBuffer[1] |= 255 & (length << 4);\n        stringBuffer[0] = 0x40 | (length >> 4);\n      }\n\n      // Fill to end with pad pattern.\n      index = length + 3 - (version < 10);\n\n      while (index < maxLength) {\n        stringBuffer[index++] = 0xec;\n        stringBuffer[index++] = 0x11;\n      }\n    },\n\n    _getBadness: function(length) {\n      var i;\n      var badRuns = 0;\n      var badness = this._badness;\n\n      for (i = 0; i <= length; i++) {\n        if (badness[i] >= 5) {\n          badRuns += Frame.N1 + badness[i] - 5;\n        }\n      }\n\n      // FBFFFBF as in finder.\n      for (i = 3; i < length - 1; i += 2) {\n        if (badness[i - 2] === badness[i + 2] &&\n          badness[i + 2] === badness[i - 1] &&\n          badness[i - 1] === badness[i + 1] &&\n          badness[i - 1] * 3 === badness[i] &&\n          // Background around the foreground pattern? Not part of the specs.\n          (badness[i - 3] === 0 || i + 3 > length ||\n          badness[i - 3] * 3 >= badness[i] * 4 ||\n          badness[i + 3] * 3 >= badness[i] * 4)) {\n          badRuns += Frame.N3;\n        }\n      }\n\n      return badRuns;\n    },\n\n    _finish: function() {\n      // Save pre-mask copy of frame.\n      this._stringBuffer = this.buffer.slice();\n\n      var currentMask, i;\n      var bit = 0;\n      var mask = 30000;\n\n      /*\n       * Using for instead of while since in original Arduino code if an early mask was \"good enough\" it wouldn't try for\n       * a better one since they get more complex and take longer.\n       */\n      for (i = 0; i < 8; i++) {\n        // Returns foreground-background imbalance.\n        this._applyMask(i);\n\n        currentMask = this._checkBadness();\n\n        // Is current mask better than previous best?\n        if (currentMask < mask) {\n          mask = currentMask;\n          bit = i;\n        }\n\n        // Don't increment \"i\" to a void redoing mask.\n        if (bit === 7) {\n          break;\n        }\n\n        // Reset for next pass.\n        this.buffer = this._stringBuffer.slice();\n      }\n\n      // Redo best mask as none were \"good enough\" (i.e. last wasn't bit).\n      if (bit !== i) {\n        this._applyMask(bit);\n      }\n\n      // Add in final mask/ECC level bytes.\n      mask = ErrorCorrection_1.FINAL_FORMAT[bit + (this._level - 1 << 3)];\n\n      var buffer = this.buffer;\n      var width = this.width;\n\n      // Low byte.\n      for (i = 0; i < 8; i++, mask >>= 1) {\n        if (mask & 1) {\n          buffer[width - 1 - i + (width * 8)] = 1;\n\n          if (i < 6) {\n            buffer[8 + (width * i)] = 1;\n          } else {\n            buffer[8 + (width * (i + 1))] = 1;\n          }\n        }\n      }\n\n      // High byte.\n      for (i = 0; i < 7; i++, mask >>= 1) {\n        if (mask & 1) {\n          buffer[8 + (width * (width - 7 + i))] = 1;\n\n          if (i) {\n            buffer[6 - i + (width * 8)] = 1;\n          } else {\n            buffer[7 + (width * 8)] = 1;\n          }\n        }\n      }\n    },\n\n    _interleaveBlocks: function() {\n      var i, j;\n      var dataBlock = this._dataBlock;\n      var ecc = this._ecc;\n      var eccBlock = this._eccBlock;\n      var k = 0;\n      var maxLength = this._calculateMaxLength();\n      var neccBlock1 = this._neccBlock1;\n      var neccBlock2 = this._neccBlock2;\n      var stringBuffer = this._stringBuffer;\n\n      for (i = 0; i < dataBlock; i++) {\n        for (j = 0; j < neccBlock1; j++) {\n          ecc[k++] = stringBuffer[i + (j * dataBlock)];\n        }\n\n        for (j = 0; j < neccBlock2; j++) {\n          ecc[k++] = stringBuffer[(neccBlock1 * dataBlock) + i + (j * (dataBlock + 1))];\n        }\n      }\n\n      for (j = 0; j < neccBlock2; j++) {\n        ecc[k++] = stringBuffer[(neccBlock1 * dataBlock) + i + (j * (dataBlock + 1))];\n      }\n\n      for (i = 0; i < eccBlock; i++) {\n        for (j = 0; j < neccBlock1 + neccBlock2; j++) {\n          ecc[k++] = stringBuffer[maxLength + i + (j * eccBlock)];\n        }\n      }\n\n      this._stringBuffer = ecc;\n    },\n\n    _insertAlignments: function() {\n      var i, x, y;\n      var version = this._version;\n      var width = this.width;\n\n      if (version > 1) {\n        i = Alignment_1.BLOCK[version];\n        y = width - 7;\n\n        for (;;) {\n          x = width - 7;\n\n          while (x > i - 3) {\n            this._addAlignment(x, y);\n\n            if (x < i) {\n              break;\n            }\n\n            x -= i;\n          }\n\n          if (y <= i + 9) {\n            break;\n          }\n\n          y -= i;\n\n          this._addAlignment(6, y);\n          this._addAlignment(y, 6);\n        }\n      }\n    },\n\n    _insertFinders: function() {\n      var i, j, x, y;\n      var buffer = this.buffer;\n      var width = this.width;\n\n      for (i = 0; i < 3; i++) {\n        j = 0;\n        y = 0;\n\n        if (i === 1) {\n          j = width - 7;\n        }\n        if (i === 2) {\n          y = width - 7;\n        }\n\n        buffer[y + 3 + (width * (j + 3))] = 1;\n\n        for (x = 0; x < 6; x++) {\n          buffer[y + x + (width * j)] = 1;\n          buffer[y + (width * (j + x + 1))] = 1;\n          buffer[y + 6 + (width * (j + x))] = 1;\n          buffer[y + x + 1 + (width * (j + 6))] = 1;\n        }\n\n        for (x = 1; x < 5; x++) {\n          this._setMask(y + x, j + 1);\n          this._setMask(y + 1, j + x + 1);\n          this._setMask(y + 5, j + x);\n          this._setMask(y + x + 1, j + 5);\n        }\n\n        for (x = 2; x < 4; x++) {\n          buffer[y + x + (width * (j + 2))] = 1;\n          buffer[y + 2 + (width * (j + x + 1))] = 1;\n          buffer[y + 4 + (width * (j + x))] = 1;\n          buffer[y + x + 1 + (width * (j + 4))] = 1;\n        }\n      }\n    },\n\n    _insertTimingGap: function() {\n      var x, y;\n      var width = this.width;\n\n      for (y = 0; y < 7; y++) {\n        this._setMask(7, y);\n        this._setMask(width - 8, y);\n        this._setMask(7, y + width - 7);\n      }\n\n      for (x = 0; x < 8; x++) {\n        this._setMask(x, 7);\n        this._setMask(x + width - 8, 7);\n        this._setMask(x, width - 8);\n      }\n    },\n\n    _insertTimingRowAndColumn: function() {\n      var x;\n      var buffer = this.buffer;\n      var width = this.width;\n\n      for (x = 0; x < width - 14; x++) {\n        if (x & 1) {\n          this._setMask(8 + x, 6);\n          this._setMask(6, 8 + x);\n        } else {\n          buffer[8 + x + (width * 6)] = 1;\n          buffer[6 + (width * (8 + x))] = 1;\n        }\n      }\n    },\n\n    _insertVersion: function() {\n      var i, j, x, y;\n      var buffer = this.buffer;\n      var version = this._version;\n      var width = this.width;\n\n      if (version > 6) {\n        i = Version_1.BLOCK[version - 7];\n        j = 17;\n\n        for (x = 0; x < 6; x++) {\n          for (y = 0; y < 3; y++, j--) {\n            if (1 & (j > 11 ? version >> j - 12 : i >> j)) {\n              buffer[5 - x + (width * (2 - y + width - 11))] = 1;\n              buffer[2 - y + width - 11 + (width * (5 - x))] = 1;\n            } else {\n              this._setMask(5 - x, 2 - y + width - 11);\n              this._setMask(2 - y + width - 11, 5 - x);\n            }\n          }\n        }\n      }\n    },\n\n    _isMasked: function(x, y) {\n      var bit = Frame._getMaskBit(x, y);\n\n      return this._mask[bit] === 1;\n    },\n\n    _pack: function() {\n      var bit, i, j;\n      var k = 1;\n      var v = 1;\n      var width = this.width;\n      var x = width - 1;\n      var y = width - 1;\n\n      // Interleaved data and ECC codes.\n      var length = ((this._dataBlock + this._eccBlock) * (this._neccBlock1 + this._neccBlock2)) + this._neccBlock2;\n\n      for (i = 0; i < length; i++) {\n        bit = this._stringBuffer[i];\n\n        for (j = 0; j < 8; j++, bit <<= 1) {\n          if (0x80 & bit) {\n            this.buffer[x + (width * y)] = 1;\n          }\n\n          // Find next fill position.\n          do {\n            if (v) {\n              x--;\n            } else {\n              x++;\n\n              if (k) {\n                if (y !== 0) {\n                  y--;\n                } else {\n                  x -= 2;\n                  k = !k;\n\n                  if (x === 6) {\n                    x--;\n                    y = 9;\n                  }\n                }\n              } else if (y !== width - 1) {\n                y++;\n              } else {\n                x -= 2;\n                k = !k;\n\n                if (x === 6) {\n                  x--;\n                  y -= 8;\n                }\n              }\n            }\n\n            v = !v;\n          } while (this._isMasked(x, y));\n        }\n      }\n    },\n\n    _reverseMask: function() {\n      var x, y;\n      var width = this.width;\n\n      for (x = 0; x < 9; x++) {\n        this._setMask(x, 8);\n      }\n\n      for (x = 0; x < 8; x++) {\n        this._setMask(x + width - 8, 8);\n        this._setMask(8, x);\n      }\n\n      for (y = 0; y < 7; y++) {\n        this._setMask(8, y + width - 7);\n      }\n    },\n\n    _setMask: function(x, y) {\n      var bit = Frame._getMaskBit(x, y);\n\n      this._mask[bit] = 1;\n    },\n\n    _syncMask: function() {\n      var x, y;\n      var width = this.width;\n\n      for (y = 0; y < width; y++) {\n        for (x = 0; x <= y; x++) {\n          if (this.buffer[x + (width * y)]) {\n            this._setMask(x, y);\n          }\n        }\n      }\n    }\n\n  }, {\n\n    _createArray: function(length) {\n      var i;\n      var array = [];\n\n      for (i = 0; i < length; i++) {\n        array[i] = 0;\n      }\n\n      return array;\n    },\n\n    _getMaskBit: function(x, y) {\n      var bit;\n\n      if (x > y) {\n        bit = x;\n        x = y;\n        y = bit;\n      }\n\n      bit = y;\n      bit += y * y;\n      bit >>= 1;\n      bit += x;\n\n      return bit;\n    },\n\n    _modN: function(x) {\n      while (x >= 255) {\n        x -= 255;\n        x = (x >> 8) + (x & 255);\n      }\n\n      return x;\n    },\n\n    // *Badness* coefficients.\n    N1: 3,\n    N2: 3,\n    N3: 40,\n    N4: 10\n\n  });\n\n  var Frame_1 = Frame;\n\n  /**\n   * The options used by {@link Frame}.\n   *\n   * @typedef {Object} Frame~Options\n   * @property {string} level - The ECC level to be used.\n   * @property {string} value - The value to be encoded.\n   */\n\n  /**\n   * An implementation of {@link Renderer} for working with <code>img</code> elements.\n   *\n   * This depends on {@link CanvasRenderer} being executed first as this implementation simply applies the data URL from\n   * the rendered <code>canvas</code> element as the <code>src</code> for the <code>img</code> element being rendered.\n   *\n   * @public\n   * @class\n   * @extends Renderer\n   */\n  var ImageRenderer = Renderer_1.extend({\n\n    /**\n     * @override\n     */\n    draw: function() {\n      this.element.src = this.qrious.toDataURL();\n    },\n\n    /**\n     * @override\n     */\n    reset: function() {\n      this.element.src = '';\n    },\n\n    /**\n     * @override\n     */\n    resize: function() {\n      var element = this.element;\n\n      element.width = element.height = this.qrious.size;\n    }\n\n  });\n\n  var ImageRenderer_1 = ImageRenderer;\n\n  /**\n   * Defines an available option while also configuring how values are applied to the target object.\n   *\n   * Optionally, a default value can be specified as well a value transformer for greater control over how the option\n   * value is applied.\n   *\n   * If no value transformer is specified, then any specified option will be applied directly. All values are maintained\n   * on the target object itself as a field using the option name prefixed with a single underscore.\n   *\n   * When an option is specified as modifiable, the {@link OptionManager} will be required to include a setter for the\n   * property that is defined on the target object that uses the option name.\n   *\n   * @param {string} name - the name to be used\n   * @param {boolean} [modifiable] - <code>true</code> if the property defined on target objects should include a setter;\n   * otherwise <code>false</code>\n   * @param {*} [defaultValue] - the default value to be used\n   * @param {Option~ValueTransformer} [valueTransformer] - the value transformer to be used\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var Option = lite.extend(function(name, modifiable, defaultValue, valueTransformer) {\n    /**\n     * The name for this {@link Option}.\n     *\n     * @public\n     * @type {string}\n     * @memberof Option#\n     */\n    this.name = name;\n\n    /**\n     * Whether a setter should be included on the property defined on target objects for this {@link Option}.\n     *\n     * @public\n     * @type {boolean}\n     * @memberof Option#\n     */\n    this.modifiable = Boolean(modifiable);\n\n    /**\n     * The default value for this {@link Option}.\n     *\n     * @public\n     * @type {*}\n     * @memberof Option#\n     */\n    this.defaultValue = defaultValue;\n\n    this._valueTransformer = valueTransformer;\n  }, {\n\n    /**\n     * Transforms the specified <code>value</code> so that it can be applied for this {@link Option}.\n     *\n     * If a value transformer has been specified for this {@link Option}, it will be called upon to transform\n     * <code>value</code>. Otherwise, <code>value</code> will be returned directly.\n     *\n     * @param {*} value - the value to be transformed\n     * @return {*} The transformed value or <code>value</code> if no value transformer is specified.\n     * @public\n     * @memberof Option#\n     */\n    transform: function(value) {\n      var transformer = this._valueTransformer;\n      if (typeof transformer === 'function') {\n        return transformer(value, this);\n      }\n\n      return value;\n    }\n\n  });\n\n  var Option_1 = Option;\n\n  /**\n   * Returns a transformed value for the specified <code>value</code> to be applied for the <code>option</code> provided.\n   *\n   * @callback Option~ValueTransformer\n   * @param {*} value - the value to be transformed\n   * @param {Option} option - the {@link Option} for which <code>value</code> is being transformed\n   * @return {*} The transform value.\n   */\n\n  /**\n   * Contains utility methods that are useful throughout the library.\n   *\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var Utilities = lite.extend(null, {\n\n    /**\n     * Returns the absolute value of a given number.\n     *\n     * This method is simply a convenient shorthand for <code>Math.abs</code> while ensuring that nulls are returned as\n     * <code>null</code> instead of zero.\n     *\n     * @param {number} value - the number whose absolute value is to be returned\n     * @return {number} The absolute value of <code>value</code> or <code>null</code> if <code>value</code> is\n     * <code>null</code>.\n     * @public\n     * @static\n     * @memberof Utilities\n     */\n    abs: function(value) {\n      return value != null ? Math.abs(value) : null;\n    },\n\n    /**\n     * Returns whether the specified <code>object</code> has a property with the specified <code>name</code> as an own\n     * (not inherited) property.\n     *\n     * @param {Object} object - the object on which the property is to be checked\n     * @param {string} name - the name of the property to be checked\n     * @return {boolean} <code>true</code> if <code>object</code> has an own property with <code>name</code>.\n     * @public\n     * @static\n     * @memberof Utilities\n     */\n    hasOwn: function(object, name) {\n      return Object.prototype.hasOwnProperty.call(object, name);\n    },\n\n    /**\n     * A non-operation method that does absolutely nothing.\n     *\n     * @return {void}\n     * @public\n     * @static\n     * @memberof Utilities\n     */\n    noop: function() {},\n\n    /**\n     * Transforms the specified <code>string</code> to upper case while remaining null-safe.\n     *\n     * @param {string} string - the string to be transformed to upper case\n     * @return {string} <code>string</code> transformed to upper case if <code>string</code> is not <code>null</code>.\n     * @public\n     * @static\n     * @memberof Utilities\n     */\n    toUpperCase: function(string) {\n      return string != null ? string.toUpperCase() : null;\n    }\n\n  });\n\n  var Utilities_1 = Utilities;\n\n  /**\n   * Manages multiple {@link Option} instances that are intended to be used by multiple implementations.\n   *\n   * Although the option definitions are shared between targets, the values are maintained on the targets themselves.\n   *\n   * @param {Option[]} options - the options to be used\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var OptionManager = lite.extend(function(options) {\n    /**\n     * The available options for this {@link OptionManager}.\n     *\n     * @public\n     * @type {Object.<string, Option>}\n     * @memberof OptionManager#\n     */\n    this.options = {};\n\n    options.forEach(function(option) {\n      this.options[option.name] = option;\n    }, this);\n  }, {\n\n    /**\n     * Returns whether an option with the specified <code>name</code> is available.\n     *\n     * @param {string} name - the name of the {@link Option} whose existence is to be checked\n     * @return {boolean} <code>true</code> if an {@link Option} exists with <code>name</code>; otherwise\n     * <code>false</code>.\n     * @public\n     * @memberof OptionManager#\n     */\n    exists: function(name) {\n      return this.options[name] != null;\n    },\n\n    /**\n     * Returns the value of the option with the specified <code>name</code> on the <code>target</code> object provided.\n     *\n     * @param {string} name - the name of the {@link Option} whose value on <code>target</code> is to be returned\n     * @param {Object} target - the object from which the value of the named {@link Option} is to be returned\n     * @return {*} The value of the {@link Option} with <code>name</code> on <code>target</code>.\n     * @public\n     * @memberof OptionManager#\n     */\n    get: function(name, target) {\n      return OptionManager._get(this.options[name], target);\n    },\n\n    /**\n     * Returns a copy of all of the available options on the <code>target</code> object provided.\n     *\n     * @param {Object} target - the object from which the option name/value pairs are to be returned\n     * @return {Object.<string, *>} A hash containing the name/value pairs of all options on <code>target</code>.\n     * @public\n     * @memberof OptionManager#\n     */\n    getAll: function(target) {\n      var name;\n      var options = this.options;\n      var result = {};\n\n      for (name in options) {\n        if (Utilities_1.hasOwn(options, name)) {\n          result[name] = OptionManager._get(options[name], target);\n        }\n      }\n\n      return result;\n    },\n\n    /**\n     * Initializes the available options for the <code>target</code> object provided and then applies the initial values\n     * within the speciifed <code>options</code>.\n     *\n     * This method will throw an error if any of the names within <code>options</code> does not match an available option.\n     *\n     * This involves setting the default values and defining properties for all of the available options on\n     * <code>target</code> before finally calling {@link OptionMananger#setAll} with <code>options</code> and\n     * <code>target</code>. Any options that are configured to be modifiable will have a setter included in their defined\n     * property that will allow its corresponding value to be modified.\n     *\n     * If a change handler is specified, it will be called whenever the value changes on <code>target</code> for a\n     * modifiable option, but only when done so via the defined property's setter.\n     *\n     * @param {Object.<string, *>} options - the name/value pairs of the initial options to be set\n     * @param {Object} target - the object on which the options are to be initialized\n     * @param {Function} [changeHandler] - the function to be called whenever the value of an modifiable option changes on\n     * <code>target</code>\n     * @return {void}\n     * @throws {Error} If <code>options</code> contains an invalid option name.\n     * @public\n     * @memberof OptionManager#\n     */\n    init: function(options, target, changeHandler) {\n      if (typeof changeHandler !== 'function') {\n        changeHandler = Utilities_1.noop;\n      }\n\n      var name, option;\n\n      for (name in this.options) {\n        if (Utilities_1.hasOwn(this.options, name)) {\n          option = this.options[name];\n\n          OptionManager._set(option, option.defaultValue, target);\n          OptionManager._createAccessor(option, target, changeHandler);\n        }\n      }\n\n      this._setAll(options, target, true);\n    },\n\n    /**\n     * Sets the value of the option with the specified <code>name</code> on the <code>target</code> object provided to\n     * <code>value</code>.\n     *\n     * This method will throw an error if <code>name</code> does not match an available option or matches an option that\n     * cannot be modified.\n     *\n     * If <code>value</code> is <code>null</code> and the {@link Option} has a default value configured, then that default\n     * value will be used instead. If the {@link Option} also has a value transformer configured, it will be used to\n     * transform whichever value was determined to be used.\n     *\n     * This method returns whether the value of the underlying field on <code>target</code> was changed as a result.\n     *\n     * @param {string} name - the name of the {@link Option} whose value is to be set\n     * @param {*} value - the value to be set for the named {@link Option} on <code>target</code>\n     * @param {Object} target - the object on which <code>value</code> is to be set for the named {@link Option}\n     * @return {boolean} <code>true</code> if the underlying field on <code>target</code> was changed; otherwise\n     * <code>false</code>.\n     * @throws {Error} If <code>name</code> is invalid or is for an option that cannot be modified.\n     * @public\n     * @memberof OptionManager#\n     */\n    set: function(name, value, target) {\n      return this._set(name, value, target);\n    },\n\n    /**\n     * Sets all of the specified <code>options</code> on the <code>target</code> object provided to their corresponding\n     * values.\n     *\n     * This method will throw an error if any of the names within <code>options</code> does not match an available option\n     * or matches an option that cannot be modified.\n     *\n     * If any value within <code>options</code> is <code>null</code> and the corresponding {@link Option} has a default\n     * value configured, then that default value will be used instead. If an {@link Option} also has a value transformer\n     * configured, it will be used to transform whichever value was determined to be used.\n     *\n     * This method returns whether the value for any of the underlying fields on <code>target</code> were changed as a\n     * result.\n     *\n     * @param {Object.<string, *>} options - the name/value pairs of options to be set\n     * @param {Object} target - the object on which the options are to be set\n     * @return {boolean} <code>true</code> if any of the underlying fields on <code>target</code> were changed; otherwise\n     * <code>false</code>.\n     * @throws {Error} If <code>options</code> contains an invalid option name or an option that cannot be modiifed.\n     * @public\n     * @memberof OptionManager#\n     */\n    setAll: function(options, target) {\n      return this._setAll(options, target);\n    },\n\n    _set: function(name, value, target, allowUnmodifiable) {\n      var option = this.options[name];\n      if (!option) {\n        throw new Error('Invalid option: ' + name);\n      }\n      if (!option.modifiable && !allowUnmodifiable) {\n        throw new Error('Option cannot be modified: ' + name);\n      }\n\n      return OptionManager._set(option, value, target);\n    },\n\n    _setAll: function(options, target, allowUnmodifiable) {\n      if (!options) {\n        return false;\n      }\n\n      var name;\n      var changed = false;\n\n      for (name in options) {\n        if (Utilities_1.hasOwn(options, name) && this._set(name, options[name], target, allowUnmodifiable)) {\n          changed = true;\n        }\n      }\n\n      return changed;\n    }\n\n  }, {\n\n    _createAccessor: function(option, target, changeHandler) {\n      var descriptor = {\n        get: function() {\n          return OptionManager._get(option, target);\n        }\n      };\n\n      if (option.modifiable) {\n        descriptor.set = function(value) {\n          if (OptionManager._set(option, value, target)) {\n            changeHandler(value, option);\n          }\n        };\n      }\n\n      Object.defineProperty(target, option.name, descriptor);\n    },\n\n    _get: function(option, target) {\n      return target['_' + option.name];\n    },\n\n    _set: function(option, value, target) {\n      var fieldName = '_' + option.name;\n      var oldValue = target[fieldName];\n      var newValue = option.transform(value != null ? value : option.defaultValue);\n\n      target[fieldName] = newValue;\n\n      return newValue !== oldValue;\n    }\n\n  });\n\n  var OptionManager_1 = OptionManager;\n\n  /**\n   * Called whenever the value of a modifiable {@link Option} is changed on a target object via the defined property's\n   * setter.\n   *\n   * @callback OptionManager~ChangeHandler\n   * @param {*} value - the new value for <code>option</code> on the target object\n   * @param {Option} option - the modifable {@link Option} whose value has changed on the target object.\n   * @return {void}\n   */\n\n  /**\n   * A basic manager for {@link Service} implementations that are mapped to simple names.\n   *\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var ServiceManager = lite.extend(function() {\n    this._services = {};\n  }, {\n\n    /**\n     * Returns the {@link Service} being managed with the specified <code>name</code>.\n     *\n     * @param {string} name - the name of the {@link Service} to be returned\n     * @return {Service} The {@link Service} is being managed with <code>name</code>.\n     * @throws {Error} If no {@link Service} is being managed with <code>name</code>.\n     * @public\n     * @memberof ServiceManager#\n     */\n    getService: function(name) {\n      var service = this._services[name];\n      if (!service) {\n        throw new Error('Service is not being managed with name: ' + name);\n      }\n\n      return service;\n    },\n\n    /**\n     * Sets the {@link Service} implementation to be managed for the specified <code>name</code> to the\n     * <code>service</code> provided.\n     *\n     * @param {string} name - the name of the {@link Service} to be managed with <code>name</code>\n     * @param {Service} service - the {@link Service} implementation to be managed\n     * @return {void}\n     * @throws {Error} If a {@link Service} is already being managed with the same <code>name</code>.\n     * @public\n     * @memberof ServiceManager#\n     */\n    setService: function(name, service) {\n      if (this._services[name]) {\n        throw new Error('Service is already managed with name: ' + name);\n      }\n\n      if (service) {\n        this._services[name] = service;\n      }\n    }\n\n  });\n\n  var ServiceManager_1 = ServiceManager;\n\n  var optionManager = new OptionManager_1([\n    new Option_1('background', true, 'white'),\n    new Option_1('backgroundAlpha', true, 1, Utilities_1.abs),\n    new Option_1('element'),\n    new Option_1('foreground', true, 'black'),\n    new Option_1('foregroundAlpha', true, 1, Utilities_1.abs),\n    new Option_1('level', true, 'L', Utilities_1.toUpperCase),\n    new Option_1('mime', true, 'image/png'),\n    new Option_1('padding', true, null, Utilities_1.abs),\n    new Option_1('size', true, 100, Utilities_1.abs),\n    new Option_1('value', true, '')\n  ]);\n  var serviceManager = new ServiceManager_1();\n\n  /**\n   * Enables configuration of a QR code generator which uses HTML5 <code>canvas</code> for rendering.\n   *\n   * @param {QRious~Options} [options] - the options to be used\n   * @throws {Error} If any <code>options</code> are invalid.\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var QRious = lite.extend(function(options) {\n    optionManager.init(options, this, this.update.bind(this));\n\n    var element = optionManager.get('element', this);\n    var elementService = serviceManager.getService('element');\n    var canvas = element && elementService.isCanvas(element) ? element : elementService.createCanvas();\n    var image = element && elementService.isImage(element) ? element : elementService.createImage();\n\n    this._canvasRenderer = new CanvasRenderer_1(this, canvas, true);\n    this._imageRenderer = new ImageRenderer_1(this, image, image === element);\n\n    this.update();\n  }, {\n\n    /**\n     * Returns all of the options configured for this {@link QRious}.\n     *\n     * Any changes made to the returned object will not be reflected in the options themselves or their corresponding\n     * underlying fields.\n     *\n     * @return {Object.<string, *>} A copy of the applied options.\n     * @public\n     * @memberof QRious#\n     */\n    get: function() {\n      return optionManager.getAll(this);\n    },\n\n    /**\n     * Sets all of the specified <code>options</code> and automatically updates this {@link QRious} if any of the\n     * underlying fields are changed as a result.\n     *\n     * This is the preferred method for updating multiple options at one time to avoid unnecessary updates between\n     * changes.\n     *\n     * @param {QRious~Options} options - the options to be set\n     * @return {void}\n     * @throws {Error} If any <code>options</code> are invalid or cannot be modified.\n     * @public\n     * @memberof QRious#\n     */\n    set: function(options) {\n      if (optionManager.setAll(options, this)) {\n        this.update();\n      }\n    },\n\n    /**\n     * Returns the image data URI for the generated QR code using the <code>mime</code> provided.\n     *\n     * @param {string} [mime] - the MIME type for the image\n     * @return {string} The image data URI for the QR code.\n     * @public\n     * @memberof QRious#\n     */\n    toDataURL: function(mime) {\n      return this.canvas.toDataURL(mime || this.mime);\n    },\n\n    /**\n     * Updates this {@link QRious} by generating a new {@link Frame} and re-rendering the QR code.\n     *\n     * @return {void}\n     * @protected\n     * @memberof QRious#\n     */\n    update: function() {\n      var frame = new Frame_1({\n        level: this.level,\n        value: this.value\n      });\n\n      this._canvasRenderer.render(frame);\n      this._imageRenderer.render(frame);\n    }\n\n  }, {\n\n    /**\n     * Configures the <code>service</code> provided to be used by all {@link QRious} instances.\n     *\n     * @param {Service} service - the {@link Service} to be configured\n     * @return {void}\n     * @throws {Error} If a {@link Service} has already been configured with the same name.\n     * @public\n     * @static\n     * @memberof QRious\n     */\n    use: function(service) {\n      serviceManager.setService(service.getName(), service);\n    }\n\n  });\n\n  Object.defineProperties(QRious.prototype, {\n\n    canvas: {\n      /**\n       * Returns the <code>canvas</code> element being used to render the QR code for this {@link QRious}.\n       *\n       * @return {*} The <code>canvas</code> element.\n       * @public\n       * @memberof QRious#\n       * @alias canvas\n       */\n      get: function() {\n        return this._canvasRenderer.getElement();\n      }\n    },\n\n    image: {\n      /**\n       * Returns the <code>img</code> element being used to render the QR code for this {@link QRious}.\n       *\n       * @return {*} The <code>img</code> element.\n       * @public\n       * @memberof QRious#\n       * @alias image\n       */\n      get: function() {\n        return this._imageRenderer.getElement();\n      }\n    }\n\n  });\n\n  var QRious_1$2 = QRious;\n\n  /**\n   * The options used by {@link QRious}.\n   *\n   * @typedef {Object} QRious~Options\n   * @property {string} [background=\"white\"] - The background color to be applied to the QR code.\n   * @property {number} [backgroundAlpha=1] - The background alpha to be applied to the QR code.\n   * @property {*} [element] - The element to be used to render the QR code which may either be an <code>canvas</code> or\n   * <code>img</code>. The element(s) will be created if needed.\n   * @property {string} [foreground=\"black\"] - The foreground color to be applied to the QR code.\n   * @property {number} [foregroundAlpha=1] - The foreground alpha to be applied to the QR code.\n   * @property {string} [level=\"L\"] - The error correction level to be applied to the QR code.\n   * @property {string} [mime=\"image/png\"] - The MIME type to be used to render the image for the QR code.\n   * @property {number} [padding] - The padding for the QR code in pixels.\n   * @property {number} [size=100] - The size of the QR code in pixels.\n   * @property {string} [value=\"\"] - The value to be encoded within the QR code.\n   */\n\n  var index = QRious_1$2;\n\n  /**\n   * Defines a service contract that must be met by all implementations.\n   *\n   * @public\n   * @class\n   * @extends Nevis\n   */\n  var Service = lite.extend({\n\n    /**\n     * Returns the name of this {@link Service}.\n     *\n     * @return {string} The service name.\n     * @public\n     * @abstract\n     * @memberof Service#\n     */\n    getName: function() {}\n\n  });\n\n  var Service_1 = Service;\n\n  /**\n   * A service for working with elements.\n   *\n   * @public\n   * @class\n   * @extends Service\n   */\n  var ElementService = Service_1.extend({\n\n    /**\n     * Creates an instance of a canvas element.\n     *\n     * Implementations of {@link ElementService} <b>must</b> override this method with their own specific logic.\n     *\n     * @return {*} The newly created canvas element.\n     * @public\n     * @abstract\n     * @memberof ElementService#\n     */\n    createCanvas: function() {},\n\n    /**\n     * Creates an instance of a image element.\n     *\n     * Implementations of {@link ElementService} <b>must</b> override this method with their own specific logic.\n     *\n     * @return {*} The newly created image element.\n     * @public\n     * @abstract\n     * @memberof ElementService#\n     */\n    createImage: function() {},\n\n    /**\n     * @override\n     */\n    getName: function() {\n      return 'element';\n    },\n\n    /**\n     * Returns whether the specified <code>element</code> is a canvas.\n     *\n     * Implementations of {@link ElementService} <b>must</b> override this method with their own specific logic.\n     *\n     * @param {*} element - the element to be checked\n     * @return {boolean} <code>true</code> if <code>element</code> is a canvas; otherwise <code>false</code>.\n     * @public\n     * @abstract\n     * @memberof ElementService#\n     */\n    isCanvas: function(element) {},\n\n    /**\n     * Returns whether the specified <code>element</code> is an image.\n     *\n     * Implementations of {@link ElementService} <b>must</b> override this method with their own specific logic.\n     *\n     * @param {*} element - the element to be checked\n     * @return {boolean} <code>true</code> if <code>element</code> is an image; otherwise <code>false</code>.\n     * @public\n     * @abstract\n     * @memberof ElementService#\n     */\n    isImage: function(element) {}\n\n  });\n\n  var ElementService_1 = ElementService;\n\n  /**\n   * An implementation of {@link ElementService} intended for use within a browser environment.\n   *\n   * @public\n   * @class\n   * @extends ElementService\n   */\n  var BrowserElementService = ElementService_1.extend({\n\n    /**\n     * @override\n     */\n    createCanvas: function() {\n      return document.createElement('canvas');\n    },\n\n    /**\n     * @override\n     */\n    createImage: function() {\n      return document.createElement('img');\n    },\n\n    /**\n     * @override\n     */\n    isCanvas: function(element) {\n      return element instanceof HTMLCanvasElement;\n    },\n\n    /**\n     * @override\n     */\n    isImage: function(element) {\n      return element instanceof HTMLImageElement;\n    }\n\n  });\n\n  var BrowserElementService_1 = BrowserElementService;\n\n  index.use(new BrowserElementService_1());\n\n  var QRious_1 = index;\n\n  return QRious_1;\n\n})));\n\n//# sourceMappingURL=qrious.js.map"]}